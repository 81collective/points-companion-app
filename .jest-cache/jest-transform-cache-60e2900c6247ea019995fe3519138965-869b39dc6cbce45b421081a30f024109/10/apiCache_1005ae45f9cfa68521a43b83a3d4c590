bb1e4c13f2b8d84859bf83bbedc9b972
"use strict";

exports.__esModule = true;
exports.warmupCache = exports.getCacheMetrics = exports.apiCache = exports.advancedApiCache = void 0;
// Advanced Redis-like in-memory cache with LRU eviction, persistence, and advanced features

class AdvancedAPICache {
  cache = new Map();
  pendingRequests = new Map();
  stats = {
    hits: 0,
    misses: 0,
    evictions: 0,
    sets: 0,
    deletes: 0,
    size: 0,
    itemCount: 0
  };
  config = {
    maxSize: 50 * 1024 * 1024,
    // 50MB default
    defaultTTL: 5 * 60 * 1000,
    // 5 minutes
    enablePersistence: true,
    persistenceKey: 'api-cache-persistence',
    enableCompression: false,
    lruEnabled: true
  };
  constructor(config) {
    if (config) {
      this.config = {
        ...this.config,
        ...config
      };
    }

    // Load persisted cache on initialization
    if (this.config.enablePersistence && typeof window !== 'undefined') {
      this.loadPersistedCache();
    }

    // Set up periodic cleanup and persistence
    if (typeof global !== 'undefined') {
      setInterval(() => {
        this.cleanup();
        if (this.config.enablePersistence) {
          this.persistCache();
        }
      }, 60000); // Every minute
    }
  }

  // Generate cache key from request parameters with advanced hashing
  generateKey(params, prefix = 'api') {
    const sortedParams = Object.keys(params).sort().reduce((result, key) => {
      result[key] = params[key];
      return result;
    }, {});
    const paramString = JSON.stringify(sortedParams);
    return `${prefix}:${this.simpleHash(paramString)}`;
  }

  // Simple hash function for cache keys
  simpleHash(str) {
    let hash = 0;
    for (let i = 0; i < str.length; i++) {
      const char = str.charCodeAt(i);
      hash = (hash << 5) - hash + char;
      hash = hash & hash; // Convert to 32-bit integer
    }
    return Math.abs(hash).toString(36);
  }

  // Estimate size of data in bytes
  estimateSize(data) {
    const str = JSON.stringify(data);
    return str ? str.length : 0; // Rough estimate: 1 byte per character
  }

  // Get cached data with LRU tracking
  get(key) {
    const entry = this.cache.get(key);
    if (!entry) {
      this.stats.misses++;
      return null;
    }
    const now = Date.now();
    if (now - entry.timestamp >= entry.ttl) {
      this.cache.delete(key);
      this.stats.size -= entry.size;
      this.stats.itemCount--;
      this.stats.misses++;
      return null;
    }

    // Update LRU tracking
    entry.accessCount++;
    entry.lastAccessed = now;
    this.stats.hits++;
    return entry.data;
  }

  // Set cache entry with advanced features
  set(key, data, options = {}) {
    const ttl = options.ttl ?? this.config.defaultTTL;
    const size = this.estimateSize(data);
    const now = Date.now();

    // Check if we need to evict entries to make room
    if (this.stats.size + size > this.config.maxSize) {
      const requiredSpace = this.stats.size + size - this.config.maxSize;
      this.evictLRU(requiredSpace);
    }
    const entry = {
      data,
      timestamp: now,
      ttl,
      accessCount: 0,
      lastAccessed: now,
      size,
      tags: options.tags
    };

    // Remove old entry if it exists
    const oldEntry = this.cache.get(key);
    if (oldEntry) {
      this.stats.size -= oldEntry.size;
      this.stats.itemCount--;
    }
    this.cache.set(key, entry);
    this.stats.size += size;
    this.stats.itemCount++;
    this.stats.sets++;
  }

  // LRU eviction
  evictLRU(requiredSpace) {
    if (!this.config.lruEnabled) return;
    const entries = Array.from(this.cache.entries()).sort(([, a], [, b]) => {
      // Sort by access count, then by last accessed time
      if (a.accessCount !== b.accessCount) {
        return a.accessCount - b.accessCount;
      }
      return a.lastAccessed - b.lastAccessed;
    });
    let freedSpace = 0;
    for (const [key, entry] of entries) {
      if (freedSpace >= requiredSpace) break;
      this.cache.delete(key);
      this.stats.size -= entry.size;
      this.stats.itemCount--;
      this.stats.evictions++;
      freedSpace += entry.size;
    }
  }

  // Delete cache entry
  delete(key) {
    const entry = this.cache.get(key);
    if (entry) {
      this.cache.delete(key);
      this.stats.size -= entry.size;
      this.stats.itemCount--;
      this.stats.deletes++;
      return true;
    }
    return false;
  }

  // Clear cache by tags
  clearByTags(tags) {
    let cleared = 0;
    for (const [key, entry] of this.cache.entries()) {
      if (entry.tags && entry.tags.some(tag => tags.includes(tag))) {
        this.cache.delete(key);
        this.stats.size -= entry.size;
        this.stats.itemCount--;
        this.stats.deletes++;
        cleared++;
      }
    }
    return cleared;
  }

  // Clear all cache
  clear() {
    this.cache.clear();
    this.stats.size = 0;
    this.stats.itemCount = 0;
    this.stats.deletes += this.stats.itemCount;
  }

  // Handle request deduplication with enhanced error handling
  async dedupe(key, requestFn, options = {}) {
    // Check cache first if enabled
    if (options.useCache !== false) {
      const cached = this.get(key);
      if (cached !== null) {
        return cached;
      }
    }

    // Check if request is already pending
    const pending = this.pendingRequests.get(key);
    if (pending) {
      return pending;
    }

    // Execute request and cache the promise
    const promise = requestFn().then(result => {
      // Cache successful results
      if (options.useCache !== false) {
        this.set(key, result, {
          ttl: options.ttl,
          tags: options.tags
        });
      }
      return result;
    }).finally(() => {
      this.pendingRequests.delete(key);
    });
    this.pendingRequests.set(key, promise);
    return promise;
  }

  // Get cache statistics
  getStats() {
    return {
      ...this.stats
    };
  }

  // Get cache hit rate
  getHitRate() {
    const total = this.stats.hits + this.stats.misses;
    return total > 0 ? this.stats.hits / total : 0;
  }

  // Cleanup expired entries
  cleanup() {
    const now = Date.now();
    for (const [key, entry] of this.cache.entries()) {
      if (now - entry.timestamp > entry.ttl) {
        this.cache.delete(key);
        this.stats.size -= entry.size;
        this.stats.itemCount--;
      }
    }
  }

  // Persist cache to localStorage
  persistCache() {
    if (typeof window === 'undefined' || !window.localStorage) return;
    try {
      const persistableData = Array.from(this.cache.entries()).filter(([, entry]) => {
        // Only persist entries that haven't expired and aren't too large
        const now = Date.now();
        return now - entry.timestamp < entry.ttl && entry.size < 1024 * 1024; // < 1MB
      }).map(([key, entry]) => [key, {
        data: entry.data,
        timestamp: entry.timestamp,
        ttl: entry.ttl,
        accessCount: entry.accessCount,
        lastAccessed: entry.lastAccessed,
        size: entry.size,
        tags: entry.tags
      }]);
      localStorage.setItem(this.config.persistenceKey, JSON.stringify({
        data: persistableData,
        timestamp: Date.now()
      }));
    } catch (error) {
      console.warn('Failed to persist cache:', error);
    }
  }

  // Load persisted cache from localStorage
  loadPersistedCache() {
    if (typeof window === 'undefined' || !window.localStorage) return;
    try {
      const persisted = localStorage.getItem(this.config.persistenceKey);
      if (!persisted) return;
      const {
        data,
        timestamp
      } = JSON.parse(persisted);
      const now = Date.now();

      // Only load if persisted within last 24 hours
      if (now - timestamp > 24 * 60 * 60 * 1000) {
        localStorage.removeItem(this.config.persistenceKey);
        return;
      }
      for (const [key, entry] of data) {
        // Check if entry is still valid
        if (now - entry.timestamp < entry.ttl) {
          this.cache.set(key, entry);
          this.stats.size += entry.size;
          this.stats.itemCount++;
        }
      }

      // Avoid noisy logs in test environment
      if (typeof process === 'undefined' || process.env && process.env.NODE_ENV !== 'test') {
        console.debug(`Loaded ${this.stats.itemCount} persisted cache entries`);
      }
    } catch (error) {
      console.warn('Failed to load persisted cache:', error);
      localStorage.removeItem(this.config.persistenceKey);
    }
  }

  // Warm up cache with frequently accessed data
  async warmup(keys) {
    const warmupPromises = keys.map(async key => {
      // This would typically fetch from a fast source or pre-computed data
      // For now, just ensure the key exists in cache
      return this.cache.has(key);
    });
    await Promise.all(warmupPromises);
  }
}

// Global advanced cache instance with optimized settings
const advancedApiCache = exports.advancedApiCache = new AdvancedAPICache({
  maxSize: 100 * 1024 * 1024,
  // 100MB for better performance
  defaultTTL: 10 * 60 * 1000,
  // 10 minutes for better cache hit rates
  enablePersistence: true,
  persistenceKey: 'points-companion-cache-v2',
  enableCompression: false,
  // Can be enabled later with compression library
  lruEnabled: true
});

// Legacy cache instance for backward compatibility
const apiCache = exports.apiCache = advancedApiCache;

// Cache warming utility
const warmupCache = async frequentlyUsedKeys => {
  await advancedApiCache.warmup(frequentlyUsedKeys);
};

// Cache monitoring utility
exports.warmupCache = warmupCache;
const getCacheMetrics = () => {
  const stats = advancedApiCache.getStats();
  const hitRate = advancedApiCache.getHitRate();
  return {
    ...stats,
    hitRate: `${(hitRate * 100).toFixed(2)}%`,
    sizeFormatted: `${(stats.size / 1024 / 1024).toFixed(2)}MB`,
    efficiency: hitRate > 0.8 ? 'Excellent' : hitRate > 0.6 ? 'Good' : 'Needs Optimization'
  };
};
exports.getCacheMetrics = getCacheMetrics;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJBZHZhbmNlZEFQSUNhY2hlIiwiY2FjaGUiLCJNYXAiLCJwZW5kaW5nUmVxdWVzdHMiLCJzdGF0cyIsImhpdHMiLCJtaXNzZXMiLCJldmljdGlvbnMiLCJzZXRzIiwiZGVsZXRlcyIsInNpemUiLCJpdGVtQ291bnQiLCJjb25maWciLCJtYXhTaXplIiwiZGVmYXVsdFRUTCIsImVuYWJsZVBlcnNpc3RlbmNlIiwicGVyc2lzdGVuY2VLZXkiLCJlbmFibGVDb21wcmVzc2lvbiIsImxydUVuYWJsZWQiLCJjb25zdHJ1Y3RvciIsIndpbmRvdyIsImxvYWRQZXJzaXN0ZWRDYWNoZSIsImdsb2JhbCIsInNldEludGVydmFsIiwiY2xlYW51cCIsInBlcnNpc3RDYWNoZSIsImdlbmVyYXRlS2V5IiwicGFyYW1zIiwicHJlZml4Iiwic29ydGVkUGFyYW1zIiwiT2JqZWN0Iiwia2V5cyIsInNvcnQiLCJyZWR1Y2UiLCJyZXN1bHQiLCJrZXkiLCJwYXJhbVN0cmluZyIsIkpTT04iLCJzdHJpbmdpZnkiLCJzaW1wbGVIYXNoIiwic3RyIiwiaGFzaCIsImkiLCJsZW5ndGgiLCJjaGFyIiwiY2hhckNvZGVBdCIsIk1hdGgiLCJhYnMiLCJ0b1N0cmluZyIsImVzdGltYXRlU2l6ZSIsImRhdGEiLCJnZXQiLCJlbnRyeSIsIm5vdyIsIkRhdGUiLCJ0aW1lc3RhbXAiLCJ0dGwiLCJkZWxldGUiLCJhY2Nlc3NDb3VudCIsImxhc3RBY2Nlc3NlZCIsInNldCIsIm9wdGlvbnMiLCJyZXF1aXJlZFNwYWNlIiwiZXZpY3RMUlUiLCJ0YWdzIiwib2xkRW50cnkiLCJlbnRyaWVzIiwiQXJyYXkiLCJmcm9tIiwiYSIsImIiLCJmcmVlZFNwYWNlIiwiY2xlYXJCeVRhZ3MiLCJjbGVhcmVkIiwic29tZSIsInRhZyIsImluY2x1ZGVzIiwiY2xlYXIiLCJkZWR1cGUiLCJyZXF1ZXN0Rm4iLCJ1c2VDYWNoZSIsImNhY2hlZCIsInBlbmRpbmciLCJwcm9taXNlIiwidGhlbiIsImZpbmFsbHkiLCJnZXRTdGF0cyIsImdldEhpdFJhdGUiLCJ0b3RhbCIsImxvY2FsU3RvcmFnZSIsInBlcnNpc3RhYmxlRGF0YSIsImZpbHRlciIsIm1hcCIsInNldEl0ZW0iLCJlcnJvciIsImNvbnNvbGUiLCJ3YXJuIiwicGVyc2lzdGVkIiwiZ2V0SXRlbSIsInBhcnNlIiwicmVtb3ZlSXRlbSIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsImRlYnVnIiwid2FybXVwIiwid2FybXVwUHJvbWlzZXMiLCJoYXMiLCJQcm9taXNlIiwiYWxsIiwiYWR2YW5jZWRBcGlDYWNoZSIsImV4cG9ydHMiLCJhcGlDYWNoZSIsIndhcm11cENhY2hlIiwiZnJlcXVlbnRseVVzZWRLZXlzIiwiZ2V0Q2FjaGVNZXRyaWNzIiwiaGl0UmF0ZSIsInRvRml4ZWQiLCJzaXplRm9ybWF0dGVkIiwiZWZmaWNpZW5jeSJdLCJzb3VyY2VzIjpbImFwaUNhY2hlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIEFkdmFuY2VkIFJlZGlzLWxpa2UgaW4tbWVtb3J5IGNhY2hlIHdpdGggTFJVIGV2aWN0aW9uLCBwZXJzaXN0ZW5jZSwgYW5kIGFkdmFuY2VkIGZlYXR1cmVzXHJcbmludGVyZmFjZSBDYWNoZUVudHJ5PFQgPSB1bmtub3duPiB7XHJcbiAgZGF0YTogVDtcclxuICB0aW1lc3RhbXA6IG51bWJlcjtcclxuICB0dGw6IG51bWJlcjtcclxuICBhY2Nlc3NDb3VudDogbnVtYmVyO1xyXG4gIGxhc3RBY2Nlc3NlZDogbnVtYmVyO1xyXG4gIHNpemU6IG51bWJlcjsgLy8gRXN0aW1hdGVkIHNpemUgaW4gYnl0ZXNcclxuICB0YWdzPzogc3RyaW5nW107IC8vIEZvciBjYWNoZSBpbnZhbGlkYXRpb24gYnkgdGFnc1xyXG59XHJcblxyXG5pbnRlcmZhY2UgQ2FjaGVTdGF0cyB7XHJcbiAgaGl0czogbnVtYmVyO1xyXG4gIG1pc3NlczogbnVtYmVyO1xyXG4gIGV2aWN0aW9uczogbnVtYmVyO1xyXG4gIHNldHM6IG51bWJlcjtcclxuICBkZWxldGVzOiBudW1iZXI7XHJcbiAgc2l6ZTogbnVtYmVyOyAvLyBUb3RhbCBjYWNoZSBzaXplIGluIGJ5dGVzXHJcbiAgaXRlbUNvdW50OiBudW1iZXI7XHJcbn1cclxuXHJcbmludGVyZmFjZSBDYWNoZUNvbmZpZyB7XHJcbiAgbWF4U2l6ZTogbnVtYmVyOyAvLyBNYXhpbXVtIGNhY2hlIHNpemUgaW4gYnl0ZXNcclxuICBkZWZhdWx0VFRMOiBudW1iZXI7IC8vIERlZmF1bHQgVFRMIGluIG1pbGxpc2Vjb25kc1xyXG4gIGVuYWJsZVBlcnNpc3RlbmNlOiBib29sZWFuO1xyXG4gIHBlcnNpc3RlbmNlS2V5OiBzdHJpbmc7XHJcbiAgZW5hYmxlQ29tcHJlc3Npb246IGJvb2xlYW47XHJcbiAgbHJ1RW5hYmxlZDogYm9vbGVhbjtcclxufVxyXG5cclxuY2xhc3MgQWR2YW5jZWRBUElDYWNoZSB7XHJcbiAgcHJpdmF0ZSBjYWNoZSA9IG5ldyBNYXA8c3RyaW5nLCBDYWNoZUVudHJ5PigpO1xyXG4gIHByaXZhdGUgcGVuZGluZ1JlcXVlc3RzID0gbmV3IE1hcDxzdHJpbmcsIFByb21pc2U8dW5rbm93bj4+KCk7XHJcbiAgcHJpdmF0ZSBzdGF0czogQ2FjaGVTdGF0cyA9IHtcclxuICAgIGhpdHM6IDAsXHJcbiAgICBtaXNzZXM6IDAsXHJcbiAgICBldmljdGlvbnM6IDAsXHJcbiAgICBzZXRzOiAwLFxyXG4gICAgZGVsZXRlczogMCxcclxuICAgIHNpemU6IDAsXHJcbiAgICBpdGVtQ291bnQ6IDBcclxuICB9O1xyXG5cclxuICBwcml2YXRlIGNvbmZpZzogQ2FjaGVDb25maWcgPSB7XHJcbiAgICBtYXhTaXplOiA1MCAqIDEwMjQgKiAxMDI0LCAvLyA1ME1CIGRlZmF1bHRcclxuICAgIGRlZmF1bHRUVEw6IDUgKiA2MCAqIDEwMDAsIC8vIDUgbWludXRlc1xyXG4gICAgZW5hYmxlUGVyc2lzdGVuY2U6IHRydWUsXHJcbiAgICBwZXJzaXN0ZW5jZUtleTogJ2FwaS1jYWNoZS1wZXJzaXN0ZW5jZScsXHJcbiAgICBlbmFibGVDb21wcmVzc2lvbjogZmFsc2UsXHJcbiAgICBscnVFbmFibGVkOiB0cnVlXHJcbiAgfTtcclxuXHJcbiAgY29uc3RydWN0b3IoY29uZmlnPzogUGFydGlhbDxDYWNoZUNvbmZpZz4pIHtcclxuICAgIGlmIChjb25maWcpIHtcclxuICAgICAgdGhpcy5jb25maWcgPSB7IC4uLnRoaXMuY29uZmlnLCAuLi5jb25maWcgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBMb2FkIHBlcnNpc3RlZCBjYWNoZSBvbiBpbml0aWFsaXphdGlvblxyXG4gICAgaWYgKHRoaXMuY29uZmlnLmVuYWJsZVBlcnNpc3RlbmNlICYmIHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgIHRoaXMubG9hZFBlcnNpc3RlZENhY2hlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gU2V0IHVwIHBlcmlvZGljIGNsZWFudXAgYW5kIHBlcnNpc3RlbmNlXHJcbiAgICBpZiAodHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuY2xlYW51cCgpO1xyXG4gICAgICAgIGlmICh0aGlzLmNvbmZpZy5lbmFibGVQZXJzaXN0ZW5jZSkge1xyXG4gICAgICAgICAgdGhpcy5wZXJzaXN0Q2FjaGUoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sIDYwMDAwKTsgLy8gRXZlcnkgbWludXRlXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBHZW5lcmF0ZSBjYWNoZSBrZXkgZnJvbSByZXF1ZXN0IHBhcmFtZXRlcnMgd2l0aCBhZHZhbmNlZCBoYXNoaW5nXHJcbiAgZ2VuZXJhdGVLZXkocGFyYW1zOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiwgcHJlZml4ID0gJ2FwaScpOiBzdHJpbmcge1xyXG4gICAgY29uc3Qgc29ydGVkUGFyYW1zID0gT2JqZWN0LmtleXMocGFyYW1zKVxyXG4gICAgICAuc29ydCgpXHJcbiAgICAgIC5yZWR1Y2UoKHJlc3VsdCwga2V5KSA9PiB7XHJcbiAgICAgICAgcmVzdWx0W2tleV0gPSBwYXJhbXNba2V5XTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICB9LCB7fSBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPik7XHJcblxyXG4gICAgY29uc3QgcGFyYW1TdHJpbmcgPSBKU09OLnN0cmluZ2lmeShzb3J0ZWRQYXJhbXMpO1xyXG4gICAgcmV0dXJuIGAke3ByZWZpeH06JHt0aGlzLnNpbXBsZUhhc2gocGFyYW1TdHJpbmcpfWA7XHJcbiAgfVxyXG5cclxuICAvLyBTaW1wbGUgaGFzaCBmdW5jdGlvbiBmb3IgY2FjaGUga2V5c1xyXG4gIHByaXZhdGUgc2ltcGxlSGFzaChzdHI6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICBsZXQgaGFzaCA9IDA7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xyXG4gICAgICBjb25zdCBjaGFyID0gc3RyLmNoYXJDb2RlQXQoaSk7XHJcbiAgICAgIGhhc2ggPSAoKGhhc2ggPDwgNSkgLSBoYXNoKSArIGNoYXI7XHJcbiAgICAgIGhhc2ggPSBoYXNoICYgaGFzaDsgLy8gQ29udmVydCB0byAzMi1iaXQgaW50ZWdlclxyXG4gICAgfVxyXG4gICAgcmV0dXJuIE1hdGguYWJzKGhhc2gpLnRvU3RyaW5nKDM2KTtcclxuICB9XHJcblxyXG4gIC8vIEVzdGltYXRlIHNpemUgb2YgZGF0YSBpbiBieXRlc1xyXG4gIHByaXZhdGUgZXN0aW1hdGVTaXplKGRhdGE6IHVua25vd24pOiBudW1iZXIge1xyXG4gICAgY29uc3Qgc3RyID0gSlNPTi5zdHJpbmdpZnkoZGF0YSk7XHJcbiAgICByZXR1cm4gc3RyID8gc3RyLmxlbmd0aCA6IDA7IC8vIFJvdWdoIGVzdGltYXRlOiAxIGJ5dGUgcGVyIGNoYXJhY3RlclxyXG4gIH1cclxuXHJcbiAgLy8gR2V0IGNhY2hlZCBkYXRhIHdpdGggTFJVIHRyYWNraW5nXHJcbiAgZ2V0PFQgPSB1bmtub3duPihrZXk6IHN0cmluZyk6IFQgfCBudWxsIHtcclxuICAgIGNvbnN0IGVudHJ5ID0gdGhpcy5jYWNoZS5nZXQoa2V5KTtcclxuICAgIGlmICghZW50cnkpIHtcclxuICAgICAgdGhpcy5zdGF0cy5taXNzZXMrKztcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcclxuICAgIGlmIChub3cgLSBlbnRyeS50aW1lc3RhbXAgPj0gZW50cnkudHRsKSB7XHJcbiAgICAgIHRoaXMuY2FjaGUuZGVsZXRlKGtleSk7XHJcbiAgICAgIHRoaXMuc3RhdHMuc2l6ZSAtPSBlbnRyeS5zaXplO1xyXG4gICAgICB0aGlzLnN0YXRzLml0ZW1Db3VudC0tO1xyXG4gICAgICB0aGlzLnN0YXRzLm1pc3NlcysrO1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICAvLyBVcGRhdGUgTFJVIHRyYWNraW5nXHJcbiAgICBlbnRyeS5hY2Nlc3NDb3VudCsrO1xyXG4gICAgZW50cnkubGFzdEFjY2Vzc2VkID0gbm93O1xyXG4gICAgdGhpcy5zdGF0cy5oaXRzKys7XHJcblxyXG4gICAgcmV0dXJuIGVudHJ5LmRhdGEgYXMgVDtcclxuICB9XHJcblxyXG4gIC8vIFNldCBjYWNoZSBlbnRyeSB3aXRoIGFkdmFuY2VkIGZlYXR1cmVzXHJcbiAgc2V0PFQgPSB1bmtub3duPihcclxuICAgIGtleTogc3RyaW5nLFxyXG4gICAgZGF0YTogVCxcclxuICAgIG9wdGlvbnM6IHtcclxuICAgICAgdHRsPzogbnVtYmVyO1xyXG4gICAgICB0YWdzPzogc3RyaW5nW107XHJcbiAgICAgIGNvbXByZXNzPzogYm9vbGVhbjtcclxuICAgIH0gPSB7fVxyXG4gICk6IHZvaWQge1xyXG4gICAgY29uc3QgdHRsID0gb3B0aW9ucy50dGwgPz8gdGhpcy5jb25maWcuZGVmYXVsdFRUTDtcclxuICAgIGNvbnN0IHNpemUgPSB0aGlzLmVzdGltYXRlU2l6ZShkYXRhKTtcclxuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcblxyXG4gICAgLy8gQ2hlY2sgaWYgd2UgbmVlZCB0byBldmljdCBlbnRyaWVzIHRvIG1ha2Ugcm9vbVxyXG4gICAgaWYgKHRoaXMuc3RhdHMuc2l6ZSArIHNpemUgPiB0aGlzLmNvbmZpZy5tYXhTaXplKSB7XHJcbiAgICAgIGNvbnN0IHJlcXVpcmVkU3BhY2UgPSB0aGlzLnN0YXRzLnNpemUgKyBzaXplIC0gdGhpcy5jb25maWcubWF4U2l6ZTtcclxuICAgICAgdGhpcy5ldmljdExSVShyZXF1aXJlZFNwYWNlKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBlbnRyeTogQ2FjaGVFbnRyeTxUPiA9IHtcclxuICAgICAgZGF0YSxcclxuICAgICAgdGltZXN0YW1wOiBub3csXHJcbiAgICAgIHR0bCxcclxuICAgICAgYWNjZXNzQ291bnQ6IDAsXHJcbiAgICAgIGxhc3RBY2Nlc3NlZDogbm93LFxyXG4gICAgICBzaXplLFxyXG4gICAgICB0YWdzOiBvcHRpb25zLnRhZ3NcclxuICAgIH07XHJcblxyXG4gICAgLy8gUmVtb3ZlIG9sZCBlbnRyeSBpZiBpdCBleGlzdHNcclxuICAgIGNvbnN0IG9sZEVudHJ5ID0gdGhpcy5jYWNoZS5nZXQoa2V5KTtcclxuICAgIGlmIChvbGRFbnRyeSkge1xyXG4gICAgICB0aGlzLnN0YXRzLnNpemUgLT0gb2xkRW50cnkuc2l6ZTtcclxuICAgICAgdGhpcy5zdGF0cy5pdGVtQ291bnQtLTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmNhY2hlLnNldChrZXksIGVudHJ5KTtcclxuICAgIHRoaXMuc3RhdHMuc2l6ZSArPSBzaXplO1xyXG4gICAgdGhpcy5zdGF0cy5pdGVtQ291bnQrKztcclxuICAgIHRoaXMuc3RhdHMuc2V0cysrO1xyXG4gIH1cclxuXHJcbiAgLy8gTFJVIGV2aWN0aW9uXHJcbiAgcHJpdmF0ZSBldmljdExSVShyZXF1aXJlZFNwYWNlOiBudW1iZXIpOiB2b2lkIHtcclxuICAgIGlmICghdGhpcy5jb25maWcubHJ1RW5hYmxlZCkgcmV0dXJuO1xyXG5cclxuICAgIGNvbnN0IGVudHJpZXMgPSBBcnJheS5mcm9tKHRoaXMuY2FjaGUuZW50cmllcygpKVxyXG4gICAgICAuc29ydCgoWywgYV0sIFssIGJdKSA9PiB7XHJcbiAgICAgICAgLy8gU29ydCBieSBhY2Nlc3MgY291bnQsIHRoZW4gYnkgbGFzdCBhY2Nlc3NlZCB0aW1lXHJcbiAgICAgICAgaWYgKGEuYWNjZXNzQ291bnQgIT09IGIuYWNjZXNzQ291bnQpIHtcclxuICAgICAgICAgIHJldHVybiBhLmFjY2Vzc0NvdW50IC0gYi5hY2Nlc3NDb3VudDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGEubGFzdEFjY2Vzc2VkIC0gYi5sYXN0QWNjZXNzZWQ7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIGxldCBmcmVlZFNwYWNlID0gMDtcclxuICAgIGZvciAoY29uc3QgW2tleSwgZW50cnldIG9mIGVudHJpZXMpIHtcclxuICAgICAgaWYgKGZyZWVkU3BhY2UgPj0gcmVxdWlyZWRTcGFjZSkgYnJlYWs7XHJcblxyXG4gICAgICB0aGlzLmNhY2hlLmRlbGV0ZShrZXkpO1xyXG4gICAgICB0aGlzLnN0YXRzLnNpemUgLT0gZW50cnkuc2l6ZTtcclxuICAgICAgdGhpcy5zdGF0cy5pdGVtQ291bnQtLTtcclxuICAgICAgdGhpcy5zdGF0cy5ldmljdGlvbnMrKztcclxuICAgICAgZnJlZWRTcGFjZSArPSBlbnRyeS5zaXplO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gRGVsZXRlIGNhY2hlIGVudHJ5XHJcbiAgZGVsZXRlKGtleTogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICBjb25zdCBlbnRyeSA9IHRoaXMuY2FjaGUuZ2V0KGtleSk7XHJcbiAgICBpZiAoZW50cnkpIHtcclxuICAgICAgdGhpcy5jYWNoZS5kZWxldGUoa2V5KTtcclxuICAgICAgdGhpcy5zdGF0cy5zaXplIC09IGVudHJ5LnNpemU7XHJcbiAgICAgIHRoaXMuc3RhdHMuaXRlbUNvdW50LS07XHJcbiAgICAgIHRoaXMuc3RhdHMuZGVsZXRlcysrO1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcblxyXG4gIC8vIENsZWFyIGNhY2hlIGJ5IHRhZ3NcclxuICBjbGVhckJ5VGFncyh0YWdzOiBzdHJpbmdbXSk6IG51bWJlciB7XHJcbiAgICBsZXQgY2xlYXJlZCA9IDA7XHJcbiAgICBmb3IgKGNvbnN0IFtrZXksIGVudHJ5XSBvZiB0aGlzLmNhY2hlLmVudHJpZXMoKSkge1xyXG4gICAgICBpZiAoZW50cnkudGFncyAmJiBlbnRyeS50YWdzLnNvbWUodGFnID0+IHRhZ3MuaW5jbHVkZXModGFnKSkpIHtcclxuICAgICAgICB0aGlzLmNhY2hlLmRlbGV0ZShrZXkpO1xyXG4gICAgICAgIHRoaXMuc3RhdHMuc2l6ZSAtPSBlbnRyeS5zaXplO1xyXG4gICAgICAgIHRoaXMuc3RhdHMuaXRlbUNvdW50LS07XHJcbiAgICAgICAgdGhpcy5zdGF0cy5kZWxldGVzKys7XHJcbiAgICAgICAgY2xlYXJlZCsrO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gY2xlYXJlZDtcclxuICB9XHJcblxyXG4gIC8vIENsZWFyIGFsbCBjYWNoZVxyXG4gIGNsZWFyKCk6IHZvaWQge1xyXG4gICAgdGhpcy5jYWNoZS5jbGVhcigpO1xyXG4gICAgdGhpcy5zdGF0cy5zaXplID0gMDtcclxuICAgIHRoaXMuc3RhdHMuaXRlbUNvdW50ID0gMDtcclxuICAgIHRoaXMuc3RhdHMuZGVsZXRlcyArPSB0aGlzLnN0YXRzLml0ZW1Db3VudDtcclxuICB9XHJcblxyXG4gIC8vIEhhbmRsZSByZXF1ZXN0IGRlZHVwbGljYXRpb24gd2l0aCBlbmhhbmNlZCBlcnJvciBoYW5kbGluZ1xyXG4gIGFzeW5jIGRlZHVwZTxUPihcclxuICAgIGtleTogc3RyaW5nLFxyXG4gICAgcmVxdWVzdEZuOiAoKSA9PiBQcm9taXNlPFQ+LFxyXG4gICAgb3B0aW9uczoge1xyXG4gICAgICB0dGw/OiBudW1iZXI7XHJcbiAgICAgIHRhZ3M/OiBzdHJpbmdbXTtcclxuICAgICAgdXNlQ2FjaGU/OiBib29sZWFuO1xyXG4gICAgfSA9IHt9XHJcbiAgKTogUHJvbWlzZTxUPiB7XHJcbiAgICAvLyBDaGVjayBjYWNoZSBmaXJzdCBpZiBlbmFibGVkXHJcbiAgICBpZiAob3B0aW9ucy51c2VDYWNoZSAhPT0gZmFsc2UpIHtcclxuICAgICAgY29uc3QgY2FjaGVkID0gdGhpcy5nZXQ8VD4oa2V5KTtcclxuICAgICAgaWYgKGNhY2hlZCAhPT0gbnVsbCkge1xyXG4gICAgICAgIHJldHVybiBjYWNoZWQ7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBDaGVjayBpZiByZXF1ZXN0IGlzIGFscmVhZHkgcGVuZGluZ1xyXG4gICAgY29uc3QgcGVuZGluZyA9IHRoaXMucGVuZGluZ1JlcXVlc3RzLmdldChrZXkpO1xyXG4gICAgaWYgKHBlbmRpbmcpIHtcclxuICAgICAgcmV0dXJuIHBlbmRpbmcgYXMgUHJvbWlzZTxUPjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBFeGVjdXRlIHJlcXVlc3QgYW5kIGNhY2hlIHRoZSBwcm9taXNlXHJcbiAgICBjb25zdCBwcm9taXNlID0gcmVxdWVzdEZuKClcclxuICAgICAgLnRoZW4ocmVzdWx0ID0+IHtcclxuICAgICAgICAvLyBDYWNoZSBzdWNjZXNzZnVsIHJlc3VsdHNcclxuICAgICAgICBpZiAob3B0aW9ucy51c2VDYWNoZSAhPT0gZmFsc2UpIHtcclxuICAgICAgICAgIHRoaXMuc2V0KGtleSwgcmVzdWx0LCB7XHJcbiAgICAgICAgICAgIHR0bDogb3B0aW9ucy50dGwsXHJcbiAgICAgICAgICAgIHRhZ3M6IG9wdGlvbnMudGFnc1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICB0aGlzLnBlbmRpbmdSZXF1ZXN0cy5kZWxldGUoa2V5KTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgdGhpcy5wZW5kaW5nUmVxdWVzdHMuc2V0KGtleSwgcHJvbWlzZSk7XHJcbiAgICByZXR1cm4gcHJvbWlzZTtcclxuICB9XHJcblxyXG4gIC8vIEdldCBjYWNoZSBzdGF0aXN0aWNzXHJcbiAgZ2V0U3RhdHMoKTogQ2FjaGVTdGF0cyB7XHJcbiAgICByZXR1cm4geyAuLi50aGlzLnN0YXRzIH07XHJcbiAgfVxyXG5cclxuICAvLyBHZXQgY2FjaGUgaGl0IHJhdGVcclxuICBnZXRIaXRSYXRlKCk6IG51bWJlciB7XHJcbiAgICBjb25zdCB0b3RhbCA9IHRoaXMuc3RhdHMuaGl0cyArIHRoaXMuc3RhdHMubWlzc2VzO1xyXG4gICAgcmV0dXJuIHRvdGFsID4gMCA/IHRoaXMuc3RhdHMuaGl0cyAvIHRvdGFsIDogMDtcclxuICB9XHJcblxyXG4gIC8vIENsZWFudXAgZXhwaXJlZCBlbnRyaWVzXHJcbiAgY2xlYW51cCgpOiB2b2lkIHtcclxuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcbiAgICBmb3IgKGNvbnN0IFtrZXksIGVudHJ5XSBvZiB0aGlzLmNhY2hlLmVudHJpZXMoKSkge1xyXG4gICAgICBpZiAobm93IC0gZW50cnkudGltZXN0YW1wID4gZW50cnkudHRsKSB7XHJcbiAgICAgICAgdGhpcy5jYWNoZS5kZWxldGUoa2V5KTtcclxuICAgICAgICB0aGlzLnN0YXRzLnNpemUgLT0gZW50cnkuc2l6ZTtcclxuICAgICAgICB0aGlzLnN0YXRzLml0ZW1Db3VudC0tO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBQZXJzaXN0IGNhY2hlIHRvIGxvY2FsU3RvcmFnZVxyXG4gIHByaXZhdGUgcGVyc2lzdENhY2hlKCk6IHZvaWQge1xyXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnIHx8ICF3aW5kb3cubG9jYWxTdG9yYWdlKSByZXR1cm47XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcGVyc2lzdGFibGVEYXRhID0gQXJyYXkuZnJvbSh0aGlzLmNhY2hlLmVudHJpZXMoKSlcclxuICAgICAgICAuZmlsdGVyKChbLCBlbnRyeV0pID0+IHtcclxuICAgICAgICAgIC8vIE9ubHkgcGVyc2lzdCBlbnRyaWVzIHRoYXQgaGF2ZW4ndCBleHBpcmVkIGFuZCBhcmVuJ3QgdG9vIGxhcmdlXHJcbiAgICAgICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgICAgcmV0dXJuIChub3cgLSBlbnRyeS50aW1lc3RhbXAgPCBlbnRyeS50dGwpICYmIGVudHJ5LnNpemUgPCAxMDI0ICogMTAyNDsgLy8gPCAxTUJcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5tYXAoKFtrZXksIGVudHJ5XSkgPT4gW2tleSwge1xyXG4gICAgICAgICAgZGF0YTogZW50cnkuZGF0YSxcclxuICAgICAgICAgIHRpbWVzdGFtcDogZW50cnkudGltZXN0YW1wLFxyXG4gICAgICAgICAgdHRsOiBlbnRyeS50dGwsXHJcbiAgICAgICAgICBhY2Nlc3NDb3VudDogZW50cnkuYWNjZXNzQ291bnQsXHJcbiAgICAgICAgICBsYXN0QWNjZXNzZWQ6IGVudHJ5Lmxhc3RBY2Nlc3NlZCxcclxuICAgICAgICAgIHNpemU6IGVudHJ5LnNpemUsXHJcbiAgICAgICAgICB0YWdzOiBlbnRyeS50YWdzXHJcbiAgICAgICAgfV0pO1xyXG5cclxuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0odGhpcy5jb25maWcucGVyc2lzdGVuY2VLZXksIEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBkYXRhOiBwZXJzaXN0YWJsZURhdGEsXHJcbiAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpXHJcbiAgICAgIH0pKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIHBlcnNpc3QgY2FjaGU6JywgZXJyb3IpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gTG9hZCBwZXJzaXN0ZWQgY2FjaGUgZnJvbSBsb2NhbFN0b3JhZ2VcclxuICBwcml2YXRlIGxvYWRQZXJzaXN0ZWRDYWNoZSgpOiB2b2lkIHtcclxuICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJyB8fCAhd2luZG93LmxvY2FsU3RvcmFnZSkgcmV0dXJuO1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHBlcnNpc3RlZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKHRoaXMuY29uZmlnLnBlcnNpc3RlbmNlS2V5KTtcclxuICAgICAgaWYgKCFwZXJzaXN0ZWQpIHJldHVybjtcclxuXHJcbiAgICAgIGNvbnN0IHsgZGF0YSwgdGltZXN0YW1wIH0gPSBKU09OLnBhcnNlKHBlcnNpc3RlZCk7XHJcbiAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcblxyXG4gICAgICAvLyBPbmx5IGxvYWQgaWYgcGVyc2lzdGVkIHdpdGhpbiBsYXN0IDI0IGhvdXJzXHJcbiAgICAgIGlmIChub3cgLSB0aW1lc3RhbXAgPiAyNCAqIDYwICogNjAgKiAxMDAwKSB7XHJcbiAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0odGhpcy5jb25maWcucGVyc2lzdGVuY2VLZXkpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgZm9yIChjb25zdCBba2V5LCBlbnRyeV0gb2YgZGF0YSkge1xyXG4gICAgICAgIC8vIENoZWNrIGlmIGVudHJ5IGlzIHN0aWxsIHZhbGlkXHJcbiAgICAgICAgaWYgKG5vdyAtIGVudHJ5LnRpbWVzdGFtcCA8IGVudHJ5LnR0bCkge1xyXG4gICAgICAgICAgdGhpcy5jYWNoZS5zZXQoa2V5LCBlbnRyeSk7XHJcbiAgICAgICAgICB0aGlzLnN0YXRzLnNpemUgKz0gZW50cnkuc2l6ZTtcclxuICAgICAgICAgIHRoaXMuc3RhdHMuaXRlbUNvdW50Kys7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBBdm9pZCBub2lzeSBsb2dzIGluIHRlc3QgZW52aXJvbm1lbnRcclxuICAgICAgaWYgKHR5cGVvZiBwcm9jZXNzID09PSAndW5kZWZpbmVkJyB8fCAocHJvY2Vzcy5lbnYgJiYgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICd0ZXN0JykpIHtcclxuICAgICAgICBjb25zb2xlLmRlYnVnKGBMb2FkZWQgJHt0aGlzLnN0YXRzLml0ZW1Db3VudH0gcGVyc2lzdGVkIGNhY2hlIGVudHJpZXNgKTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gbG9hZCBwZXJzaXN0ZWQgY2FjaGU6JywgZXJyb3IpO1xyXG4gICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSh0aGlzLmNvbmZpZy5wZXJzaXN0ZW5jZUtleSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBXYXJtIHVwIGNhY2hlIHdpdGggZnJlcXVlbnRseSBhY2Nlc3NlZCBkYXRhXHJcbiAgYXN5bmMgd2FybXVwKGtleXM6IHN0cmluZ1tdKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICBjb25zdCB3YXJtdXBQcm9taXNlcyA9IGtleXMubWFwKGFzeW5jIChrZXkpID0+IHtcclxuICAgICAgLy8gVGhpcyB3b3VsZCB0eXBpY2FsbHkgZmV0Y2ggZnJvbSBhIGZhc3Qgc291cmNlIG9yIHByZS1jb21wdXRlZCBkYXRhXHJcbiAgICAgIC8vIEZvciBub3csIGp1c3QgZW5zdXJlIHRoZSBrZXkgZXhpc3RzIGluIGNhY2hlXHJcbiAgICAgIHJldHVybiB0aGlzLmNhY2hlLmhhcyhrZXkpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgYXdhaXQgUHJvbWlzZS5hbGwod2FybXVwUHJvbWlzZXMpO1xyXG4gIH1cclxufVxyXG5cclxuLy8gR2xvYmFsIGFkdmFuY2VkIGNhY2hlIGluc3RhbmNlIHdpdGggb3B0aW1pemVkIHNldHRpbmdzXHJcbmV4cG9ydCBjb25zdCBhZHZhbmNlZEFwaUNhY2hlID0gbmV3IEFkdmFuY2VkQVBJQ2FjaGUoe1xyXG4gIG1heFNpemU6IDEwMCAqIDEwMjQgKiAxMDI0LCAvLyAxMDBNQiBmb3IgYmV0dGVyIHBlcmZvcm1hbmNlXHJcbiAgZGVmYXVsdFRUTDogMTAgKiA2MCAqIDEwMDAsIC8vIDEwIG1pbnV0ZXMgZm9yIGJldHRlciBjYWNoZSBoaXQgcmF0ZXNcclxuICBlbmFibGVQZXJzaXN0ZW5jZTogdHJ1ZSxcclxuICBwZXJzaXN0ZW5jZUtleTogJ3BvaW50cy1jb21wYW5pb24tY2FjaGUtdjInLFxyXG4gIGVuYWJsZUNvbXByZXNzaW9uOiBmYWxzZSwgLy8gQ2FuIGJlIGVuYWJsZWQgbGF0ZXIgd2l0aCBjb21wcmVzc2lvbiBsaWJyYXJ5XHJcbiAgbHJ1RW5hYmxlZDogdHJ1ZVxyXG59KTtcclxuXHJcbi8vIExlZ2FjeSBjYWNoZSBpbnN0YW5jZSBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eVxyXG5leHBvcnQgY29uc3QgYXBpQ2FjaGUgPSBhZHZhbmNlZEFwaUNhY2hlO1xyXG5cclxuLy8gQ2FjaGUgd2FybWluZyB1dGlsaXR5XHJcbmV4cG9ydCBjb25zdCB3YXJtdXBDYWNoZSA9IGFzeW5jIChmcmVxdWVudGx5VXNlZEtleXM6IHN0cmluZ1tdKSA9PiB7XHJcbiAgYXdhaXQgYWR2YW5jZWRBcGlDYWNoZS53YXJtdXAoZnJlcXVlbnRseVVzZWRLZXlzKTtcclxufTtcclxuXHJcbi8vIENhY2hlIG1vbml0b3JpbmcgdXRpbGl0eVxyXG5leHBvcnQgY29uc3QgZ2V0Q2FjaGVNZXRyaWNzID0gKCkgPT4ge1xyXG4gIGNvbnN0IHN0YXRzID0gYWR2YW5jZWRBcGlDYWNoZS5nZXRTdGF0cygpO1xyXG4gIGNvbnN0IGhpdFJhdGUgPSBhZHZhbmNlZEFwaUNhY2hlLmdldEhpdFJhdGUoKTtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIC4uLnN0YXRzLFxyXG4gICAgaGl0UmF0ZTogYCR7KGhpdFJhdGUgKiAxMDApLnRvRml4ZWQoMil9JWAsXHJcbiAgICBzaXplRm9ybWF0dGVkOiBgJHsoc3RhdHMuc2l6ZSAvIDEwMjQgLyAxMDI0KS50b0ZpeGVkKDIpfU1CYCxcclxuICAgIGVmZmljaWVuY3k6IGhpdFJhdGUgPiAwLjggPyAnRXhjZWxsZW50JyA6IGhpdFJhdGUgPiAwLjYgPyAnR29vZCcgOiAnTmVlZHMgT3B0aW1pemF0aW9uJ1xyXG4gIH07XHJcbn07XHJcbiJdLCJtYXBwaW5ncyI6Ijs7OztBQUFBOztBQThCQSxNQUFNQSxnQkFBZ0IsQ0FBQztFQUNiQyxLQUFLLEdBQUcsSUFBSUMsR0FBRyxDQUFxQixDQUFDO0VBQ3JDQyxlQUFlLEdBQUcsSUFBSUQsR0FBRyxDQUEyQixDQUFDO0VBQ3JERSxLQUFLLEdBQWU7SUFDMUJDLElBQUksRUFBRSxDQUFDO0lBQ1BDLE1BQU0sRUFBRSxDQUFDO0lBQ1RDLFNBQVMsRUFBRSxDQUFDO0lBQ1pDLElBQUksRUFBRSxDQUFDO0lBQ1BDLE9BQU8sRUFBRSxDQUFDO0lBQ1ZDLElBQUksRUFBRSxDQUFDO0lBQ1BDLFNBQVMsRUFBRTtFQUNiLENBQUM7RUFFT0MsTUFBTSxHQUFnQjtJQUM1QkMsT0FBTyxFQUFFLEVBQUUsR0FBRyxJQUFJLEdBQUcsSUFBSTtJQUFFO0lBQzNCQyxVQUFVLEVBQUUsQ0FBQyxHQUFHLEVBQUUsR0FBRyxJQUFJO0lBQUU7SUFDM0JDLGlCQUFpQixFQUFFLElBQUk7SUFDdkJDLGNBQWMsRUFBRSx1QkFBdUI7SUFDdkNDLGlCQUFpQixFQUFFLEtBQUs7SUFDeEJDLFVBQVUsRUFBRTtFQUNkLENBQUM7RUFFREMsV0FBV0EsQ0FBQ1AsTUFBNkIsRUFBRTtJQUN6QyxJQUFJQSxNQUFNLEVBQUU7TUFDVixJQUFJLENBQUNBLE1BQU0sR0FBRztRQUFFLEdBQUcsSUFBSSxDQUFDQSxNQUFNO1FBQUUsR0FBR0E7TUFBTyxDQUFDO0lBQzdDOztJQUVBO0lBQ0EsSUFBSSxJQUFJLENBQUNBLE1BQU0sQ0FBQ0csaUJBQWlCLElBQUksT0FBT0ss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