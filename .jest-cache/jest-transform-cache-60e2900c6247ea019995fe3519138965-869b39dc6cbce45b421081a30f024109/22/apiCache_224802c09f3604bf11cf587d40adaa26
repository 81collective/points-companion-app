3e8314746aff4c14cfb4c2bb82502b0b
"use strict";

exports.__esModule = true;
exports.warmupCache = exports.getCacheMetrics = exports.apiCache = exports.advancedApiCache = void 0;
// Advanced Redis-like in-memory cache with LRU eviction, persistence, and advanced features

class AdvancedAPICache {
  cache = new Map();
  pendingRequests = new Map();
  stats = {
    hits: 0,
    misses: 0,
    evictions: 0,
    sets: 0,
    deletes: 0,
    size: 0,
    itemCount: 0
  };
  config = {
    maxSize: 50 * 1024 * 1024,
    // 50MB default
    defaultTTL: 5 * 60 * 1000,
    // 5 minutes
    enablePersistence: true,
    persistenceKey: 'api-cache-persistence',
    enableCompression: false,
    lruEnabled: true
  };
  constructor(config) {
    if (config) {
      this.config = {
        ...this.config,
        ...config
      };
    }

    // Load persisted cache on initialization
    if (this.config.enablePersistence && typeof window !== 'undefined') {
      this.loadPersistedCache();
    }

    // Set up periodic cleanup and persistence
    if (typeof global !== 'undefined') {
      setInterval(() => {
        this.cleanup();
        if (this.config.enablePersistence) {
          this.persistCache();
        }
      }, 60000); // Every minute
    }
  }

  // Generate cache key from request parameters with advanced hashing
  generateKey(params, prefix = 'api') {
    const sortedParams = Object.keys(params).sort().reduce((result, key) => {
      result[key] = params[key];
      return result;
    }, {});
    const paramString = JSON.stringify(sortedParams);
    return `${prefix}:${this.simpleHash(paramString)}`;
  }

  // Simple hash function for cache keys
  simpleHash(str) {
    let hash = 0;
    for (let i = 0; i < str.length; i++) {
      const char = str.charCodeAt(i);
      hash = (hash << 5) - hash + char;
      hash = hash & hash; // Convert to 32-bit integer
    }
    return Math.abs(hash).toString(36);
  }

  // Estimate size of data in bytes
  estimateSize(data) {
    const str = JSON.stringify(data);
    return str ? str.length : 0; // Rough estimate: 1 byte per character
  }

  // Get cached data with LRU tracking
  get(key) {
    const entry = this.cache.get(key);
    if (!entry) {
      this.stats.misses++;
      return null;
    }
    const now = Date.now();
    if (now - entry.timestamp > entry.ttl) {
      this.cache.delete(key);
      this.stats.size -= entry.size;
      this.stats.itemCount--;
      this.stats.misses++;
      return null;
    }

    // Update LRU tracking
    entry.accessCount++;
    entry.lastAccessed = now;
    this.stats.hits++;
    return entry.data;
  }

  // Set cache entry with advanced features
  set(key, data, options = {}) {
    const ttl = options.ttl || this.config.defaultTTL;
    const size = this.estimateSize(data);
    const now = Date.now();

    // Check if we need to evict entries to make room
    if (this.stats.size + size > this.config.maxSize) {
      const requiredSpace = this.stats.size + size - this.config.maxSize;
      this.evictLRU(requiredSpace);
    }
    const entry = {
      data,
      timestamp: now,
      ttl,
      accessCount: 0,
      lastAccessed: now,
      size,
      tags: options.tags
    };

    // Remove old entry if it exists
    const oldEntry = this.cache.get(key);
    if (oldEntry) {
      this.stats.size -= oldEntry.size;
      this.stats.itemCount--;
    }
    this.cache.set(key, entry);
    this.stats.size += size;
    this.stats.itemCount++;
    this.stats.sets++;
  }

  // LRU eviction
  evictLRU(requiredSpace) {
    if (!this.config.lruEnabled) return;
    const entries = Array.from(this.cache.entries()).sort(([, a], [, b]) => {
      // Sort by access count, then by last accessed time
      if (a.accessCount !== b.accessCount) {
        return a.accessCount - b.accessCount;
      }
      return a.lastAccessed - b.lastAccessed;
    });
    let freedSpace = 0;
    for (const [key, entry] of entries) {
      if (freedSpace >= requiredSpace) break;
      this.cache.delete(key);
      this.stats.size -= entry.size;
      this.stats.itemCount--;
      this.stats.evictions++;
      freedSpace += entry.size;
    }
  }

  // Delete cache entry
  delete(key) {
    const entry = this.cache.get(key);
    if (entry) {
      this.cache.delete(key);
      this.stats.size -= entry.size;
      this.stats.itemCount--;
      this.stats.deletes++;
      return true;
    }
    return false;
  }

  // Clear cache by tags
  clearByTags(tags) {
    let cleared = 0;
    for (const [key, entry] of this.cache.entries()) {
      if (entry.tags && entry.tags.some(tag => tags.includes(tag))) {
        this.cache.delete(key);
        this.stats.size -= entry.size;
        this.stats.itemCount--;
        this.stats.deletes++;
        cleared++;
      }
    }
    return cleared;
  }

  // Clear all cache
  clear() {
    this.cache.clear();
    this.stats.size = 0;
    this.stats.itemCount = 0;
    this.stats.deletes += this.stats.itemCount;
  }

  // Handle request deduplication with enhanced error handling
  async dedupe(key, requestFn, options = {}) {
    // Check cache first if enabled
    if (options.useCache !== false) {
      const cached = this.get(key);
      if (cached !== null) {
        return cached;
      }
    }

    // Check if request is already pending
    const pending = this.pendingRequests.get(key);
    if (pending) {
      return pending;
    }

    // Execute request and cache the promise
    const promise = requestFn().then(result => {
      // Cache successful results
      if (options.useCache !== false) {
        this.set(key, result, {
          ttl: options.ttl,
          tags: options.tags
        });
      }
      return result;
    }).finally(() => {
      this.pendingRequests.delete(key);
    });
    this.pendingRequests.set(key, promise);
    return promise;
  }

  // Get cache statistics
  getStats() {
    return {
      ...this.stats
    };
  }

  // Get cache hit rate
  getHitRate() {
    const total = this.stats.hits + this.stats.misses;
    return total > 0 ? this.stats.hits / total : 0;
  }

  // Cleanup expired entries
  cleanup() {
    const now = Date.now();
    for (const [key, entry] of this.cache.entries()) {
      if (now - entry.timestamp > entry.ttl) {
        this.cache.delete(key);
        this.stats.size -= entry.size;
        this.stats.itemCount--;
      }
    }
  }

  // Persist cache to localStorage
  persistCache() {
    if (typeof window === 'undefined' || !window.localStorage) return;
    try {
      const persistableData = Array.from(this.cache.entries()).filter(([, entry]) => {
        // Only persist entries that haven't expired and aren't too large
        const now = Date.now();
        return now - entry.timestamp < entry.ttl && entry.size < 1024 * 1024; // < 1MB
      }).map(([key, entry]) => [key, {
        data: entry.data,
        timestamp: entry.timestamp,
        ttl: entry.ttl,
        accessCount: entry.accessCount,
        lastAccessed: entry.lastAccessed,
        size: entry.size,
        tags: entry.tags
      }]);
      localStorage.setItem(this.config.persistenceKey, JSON.stringify({
        data: persistableData,
        timestamp: Date.now()
      }));
    } catch (error) {
      console.warn('Failed to persist cache:', error);
    }
  }

  // Load persisted cache from localStorage
  loadPersistedCache() {
    if (typeof window === 'undefined' || !window.localStorage) return;
    try {
      const persisted = localStorage.getItem(this.config.persistenceKey);
      if (!persisted) return;
      const {
        data,
        timestamp
      } = JSON.parse(persisted);
      const now = Date.now();

      // Only load if persisted within last 24 hours
      if (now - timestamp > 24 * 60 * 60 * 1000) {
        localStorage.removeItem(this.config.persistenceKey);
        return;
      }
      for (const [key, entry] of data) {
        // Check if entry is still valid
        if (now - entry.timestamp < entry.ttl) {
          this.cache.set(key, entry);
          this.stats.size += entry.size;
          this.stats.itemCount++;
        }
      }
      console.log(`Loaded ${this.stats.itemCount} persisted cache entries`);
    } catch (error) {
      console.warn('Failed to load persisted cache:', error);
      localStorage.removeItem(this.config.persistenceKey);
    }
  }

  // Warm up cache with frequently accessed data
  async warmup(keys) {
    const warmupPromises = keys.map(async key => {
      // This would typically fetch from a fast source or pre-computed data
      // For now, just ensure the key exists in cache
      return this.cache.has(key);
    });
    await Promise.all(warmupPromises);
  }
}

// Global advanced cache instance with optimized settings
const advancedApiCache = exports.advancedApiCache = new AdvancedAPICache({
  maxSize: 100 * 1024 * 1024,
  // 100MB for better performance
  defaultTTL: 10 * 60 * 1000,
  // 10 minutes for better cache hit rates
  enablePersistence: true,
  persistenceKey: 'points-companion-cache-v2',
  enableCompression: false,
  // Can be enabled later with compression library
  lruEnabled: true
});

// Legacy cache instance for backward compatibility
const apiCache = exports.apiCache = advancedApiCache;

// Cache warming utility
const warmupCache = async frequentlyUsedKeys => {
  await advancedApiCache.warmup(frequentlyUsedKeys);
};

// Cache monitoring utility
exports.warmupCache = warmupCache;
const getCacheMetrics = () => {
  const stats = advancedApiCache.getStats();
  const hitRate = advancedApiCache.getHitRate();
  return {
    ...stats,
    hitRate: `${(hitRate * 100).toFixed(2)}%`,
    sizeFormatted: `${(stats.size / 1024 / 1024).toFixed(2)}MB`,
    efficiency: hitRate > 0.8 ? 'Excellent' : hitRate > 0.6 ? 'Good' : 'Needs Optimization'
  };
};
exports.getCacheMetrics = getCacheMetrics;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJBZHZhbmNlZEFQSUNhY2hlIiwiY2FjaGUiLCJNYXAiLCJwZW5kaW5nUmVxdWVzdHMiLCJzdGF0cyIsImhpdHMiLCJtaXNzZXMiLCJldmljdGlvbnMiLCJzZXRzIiwiZGVsZXRlcyIsInNpemUiLCJpdGVtQ291bnQiLCJjb25maWciLCJtYXhTaXplIiwiZGVmYXVsdFRUTCIsImVuYWJsZVBlcnNpc3RlbmNlIiwicGVyc2lzdGVuY2VLZXkiLCJlbmFibGVDb21wcmVzc2lvbiIsImxydUVuYWJsZWQiLCJjb25zdHJ1Y3RvciIsIndpbmRvdyIsImxvYWRQZXJzaXN0ZWRDYWNoZSIsImdsb2JhbCIsInNldEludGVydmFsIiwiY2xlYW51cCIsInBlcnNpc3RDYWNoZSIsImdlbmVyYXRlS2V5IiwicGFyYW1zIiwicHJlZml4Iiwic29ydGVkUGFyYW1zIiwiT2JqZWN0Iiwia2V5cyIsInNvcnQiLCJyZWR1Y2UiLCJyZXN1bHQiLCJrZXkiLCJwYXJhbVN0cmluZyIsIkpTT04iLCJzdHJpbmdpZnkiLCJzaW1wbGVIYXNoIiwic3RyIiwiaGFzaCIsImkiLCJsZW5ndGgiLCJjaGFyIiwiY2hhckNvZGVBdCIsIk1hdGgiLCJhYnMiLCJ0b1N0cmluZyIsImVzdGltYXRlU2l6ZSIsImRhdGEiLCJnZXQiLCJlbnRyeSIsIm5vdyIsIkRhdGUiLCJ0aW1lc3RhbXAiLCJ0dGwiLCJkZWxldGUiLCJhY2Nlc3NDb3VudCIsImxhc3RBY2Nlc3NlZCIsInNldCIsIm9wdGlvbnMiLCJyZXF1aXJlZFNwYWNlIiwiZXZpY3RMUlUiLCJ0YWdzIiwib2xkRW50cnkiLCJlbnRyaWVzIiwiQXJyYXkiLCJmcm9tIiwiYSIsImIiLCJmcmVlZFNwYWNlIiwiY2xlYXJCeVRhZ3MiLCJjbGVhcmVkIiwic29tZSIsInRhZyIsImluY2x1ZGVzIiwiY2xlYXIiLCJkZWR1cGUiLCJyZXF1ZXN0Rm4iLCJ1c2VDYWNoZSIsImNhY2hlZCIsInBlbmRpbmciLCJwcm9taXNlIiwidGhlbiIsImZpbmFsbHkiLCJnZXRTdGF0cyIsImdldEhpdFJhdGUiLCJ0b3RhbCIsImxvY2FsU3RvcmFnZSIsInBlcnNpc3RhYmxlRGF0YSIsImZpbHRlciIsIm1hcCIsInNldEl0ZW0iLCJlcnJvciIsImNvbnNvbGUiLCJ3YXJuIiwicGVyc2lzdGVkIiwiZ2V0SXRlbSIsInBhcnNlIiwicmVtb3ZlSXRlbSIsImxvZyIsIndhcm11cCIsIndhcm11cFByb21pc2VzIiwiaGFzIiwiUHJvbWlzZSIsImFsbCIsImFkdmFuY2VkQXBpQ2FjaGUiLCJleHBvcnRzIiwiYXBpQ2FjaGUiLCJ3YXJtdXBDYWNoZSIsImZyZXF1ZW50bHlVc2VkS2V5cyIsImdldENhY2hlTWV0cmljcyIsImhpdFJhdGUiLCJ0b0ZpeGVkIiwic2l6ZUZvcm1hdHRlZCIsImVmZmljaWVuY3kiXSwic291cmNlcyI6WyJhcGlDYWNoZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBBZHZhbmNlZCBSZWRpcy1saWtlIGluLW1lbW9yeSBjYWNoZSB3aXRoIExSVSBldmljdGlvbiwgcGVyc2lzdGVuY2UsIGFuZCBhZHZhbmNlZCBmZWF0dXJlc1xyXG5pbnRlcmZhY2UgQ2FjaGVFbnRyeTxUID0gdW5rbm93bj4ge1xyXG4gIGRhdGE6IFQ7XHJcbiAgdGltZXN0YW1wOiBudW1iZXI7XHJcbiAgdHRsOiBudW1iZXI7XHJcbiAgYWNjZXNzQ291bnQ6IG51bWJlcjtcclxuICBsYXN0QWNjZXNzZWQ6IG51bWJlcjtcclxuICBzaXplOiBudW1iZXI7IC8vIEVzdGltYXRlZCBzaXplIGluIGJ5dGVzXHJcbiAgdGFncz86IHN0cmluZ1tdOyAvLyBGb3IgY2FjaGUgaW52YWxpZGF0aW9uIGJ5IHRhZ3NcclxufVxyXG5cclxuaW50ZXJmYWNlIENhY2hlU3RhdHMge1xyXG4gIGhpdHM6IG51bWJlcjtcclxuICBtaXNzZXM6IG51bWJlcjtcclxuICBldmljdGlvbnM6IG51bWJlcjtcclxuICBzZXRzOiBudW1iZXI7XHJcbiAgZGVsZXRlczogbnVtYmVyO1xyXG4gIHNpemU6IG51bWJlcjsgLy8gVG90YWwgY2FjaGUgc2l6ZSBpbiBieXRlc1xyXG4gIGl0ZW1Db3VudDogbnVtYmVyO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgQ2FjaGVDb25maWcge1xyXG4gIG1heFNpemU6IG51bWJlcjsgLy8gTWF4aW11bSBjYWNoZSBzaXplIGluIGJ5dGVzXHJcbiAgZGVmYXVsdFRUTDogbnVtYmVyOyAvLyBEZWZhdWx0IFRUTCBpbiBtaWxsaXNlY29uZHNcclxuICBlbmFibGVQZXJzaXN0ZW5jZTogYm9vbGVhbjtcclxuICBwZXJzaXN0ZW5jZUtleTogc3RyaW5nO1xyXG4gIGVuYWJsZUNvbXByZXNzaW9uOiBib29sZWFuO1xyXG4gIGxydUVuYWJsZWQ6IGJvb2xlYW47XHJcbn1cclxuXHJcbmNsYXNzIEFkdmFuY2VkQVBJQ2FjaGUge1xyXG4gIHByaXZhdGUgY2FjaGUgPSBuZXcgTWFwPHN0cmluZywgQ2FjaGVFbnRyeT4oKTtcclxuICBwcml2YXRlIHBlbmRpbmdSZXF1ZXN0cyA9IG5ldyBNYXA8c3RyaW5nLCBQcm9taXNlPHVua25vd24+PigpO1xyXG4gIHByaXZhdGUgc3RhdHM6IENhY2hlU3RhdHMgPSB7XHJcbiAgICBoaXRzOiAwLFxyXG4gICAgbWlzc2VzOiAwLFxyXG4gICAgZXZpY3Rpb25zOiAwLFxyXG4gICAgc2V0czogMCxcclxuICAgIGRlbGV0ZXM6IDAsXHJcbiAgICBzaXplOiAwLFxyXG4gICAgaXRlbUNvdW50OiAwXHJcbiAgfTtcclxuXHJcbiAgcHJpdmF0ZSBjb25maWc6IENhY2hlQ29uZmlnID0ge1xyXG4gICAgbWF4U2l6ZTogNTAgKiAxMDI0ICogMTAyNCwgLy8gNTBNQiBkZWZhdWx0XHJcbiAgICBkZWZhdWx0VFRMOiA1ICogNjAgKiAxMDAwLCAvLyA1IG1pbnV0ZXNcclxuICAgIGVuYWJsZVBlcnNpc3RlbmNlOiB0cnVlLFxyXG4gICAgcGVyc2lzdGVuY2VLZXk6ICdhcGktY2FjaGUtcGVyc2lzdGVuY2UnLFxyXG4gICAgZW5hYmxlQ29tcHJlc3Npb246IGZhbHNlLFxyXG4gICAgbHJ1RW5hYmxlZDogdHJ1ZVxyXG4gIH07XHJcblxyXG4gIGNvbnN0cnVjdG9yKGNvbmZpZz86IFBhcnRpYWw8Q2FjaGVDb25maWc+KSB7XHJcbiAgICBpZiAoY29uZmlnKSB7XHJcbiAgICAgIHRoaXMuY29uZmlnID0geyAuLi50aGlzLmNvbmZpZywgLi4uY29uZmlnIH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gTG9hZCBwZXJzaXN0ZWQgY2FjaGUgb24gaW5pdGlhbGl6YXRpb25cclxuICAgIGlmICh0aGlzLmNvbmZpZy5lbmFibGVQZXJzaXN0ZW5jZSAmJiB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICB0aGlzLmxvYWRQZXJzaXN0ZWRDYWNoZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFNldCB1cCBwZXJpb2RpYyBjbGVhbnVwIGFuZCBwZXJzaXN0ZW5jZVxyXG4gICAgaWYgKHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgIHNldEludGVydmFsKCgpID0+IHtcclxuICAgICAgICB0aGlzLmNsZWFudXAoKTtcclxuICAgICAgICBpZiAodGhpcy5jb25maWcuZW5hYmxlUGVyc2lzdGVuY2UpIHtcclxuICAgICAgICAgIHRoaXMucGVyc2lzdENhY2hlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LCA2MDAwMCk7IC8vIEV2ZXJ5IG1pbnV0ZVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gR2VuZXJhdGUgY2FjaGUga2V5IGZyb20gcmVxdWVzdCBwYXJhbWV0ZXJzIHdpdGggYWR2YW5jZWQgaGFzaGluZ1xyXG4gIGdlbmVyYXRlS2V5KHBhcmFtczogUmVjb3JkPHN0cmluZywgdW5rbm93bj4sIHByZWZpeCA9ICdhcGknKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IHNvcnRlZFBhcmFtcyA9IE9iamVjdC5rZXlzKHBhcmFtcylcclxuICAgICAgLnNvcnQoKVxyXG4gICAgICAucmVkdWNlKChyZXN1bHQsIGtleSkgPT4ge1xyXG4gICAgICAgIHJlc3VsdFtrZXldID0gcGFyYW1zW2tleV07XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgfSwge30gYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4pO1xyXG5cclxuICAgIGNvbnN0IHBhcmFtU3RyaW5nID0gSlNPTi5zdHJpbmdpZnkoc29ydGVkUGFyYW1zKTtcclxuICAgIHJldHVybiBgJHtwcmVmaXh9OiR7dGhpcy5zaW1wbGVIYXNoKHBhcmFtU3RyaW5nKX1gO1xyXG4gIH1cclxuXHJcbiAgLy8gU2ltcGxlIGhhc2ggZnVuY3Rpb24gZm9yIGNhY2hlIGtleXNcclxuICBwcml2YXRlIHNpbXBsZUhhc2goc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgbGV0IGhhc2ggPSAwO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgY29uc3QgY2hhciA9IHN0ci5jaGFyQ29kZUF0KGkpO1xyXG4gICAgICBoYXNoID0gKChoYXNoIDw8IDUpIC0gaGFzaCkgKyBjaGFyO1xyXG4gICAgICBoYXNoID0gaGFzaCAmIGhhc2g7IC8vIENvbnZlcnQgdG8gMzItYml0IGludGVnZXJcclxuICAgIH1cclxuICAgIHJldHVybiBNYXRoLmFicyhoYXNoKS50b1N0cmluZygzNik7XHJcbiAgfVxyXG5cclxuICAvLyBFc3RpbWF0ZSBzaXplIG9mIGRhdGEgaW4gYnl0ZXNcclxuICBwcml2YXRlIGVzdGltYXRlU2l6ZShkYXRhOiB1bmtub3duKTogbnVtYmVyIHtcclxuICAgIGNvbnN0IHN0ciA9IEpTT04uc3RyaW5naWZ5KGRhdGEpO1xyXG4gICAgcmV0dXJuIHN0ciA/IHN0ci5sZW5ndGggOiAwOyAvLyBSb3VnaCBlc3RpbWF0ZTogMSBieXRlIHBlciBjaGFyYWN0ZXJcclxuICB9XHJcblxyXG4gIC8vIEdldCBjYWNoZWQgZGF0YSB3aXRoIExSVSB0cmFja2luZ1xyXG4gIGdldDxUID0gdW5rbm93bj4oa2V5OiBzdHJpbmcpOiBUIHwgbnVsbCB7XHJcbiAgICBjb25zdCBlbnRyeSA9IHRoaXMuY2FjaGUuZ2V0KGtleSk7XHJcbiAgICBpZiAoIWVudHJ5KSB7XHJcbiAgICAgIHRoaXMuc3RhdHMubWlzc2VzKys7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcbiAgICBpZiAobm93IC0gZW50cnkudGltZXN0YW1wID4gZW50cnkudHRsKSB7XHJcbiAgICAgIHRoaXMuY2FjaGUuZGVsZXRlKGtleSk7XHJcbiAgICAgIHRoaXMuc3RhdHMuc2l6ZSAtPSBlbnRyeS5zaXplO1xyXG4gICAgICB0aGlzLnN0YXRzLml0ZW1Db3VudC0tO1xyXG4gICAgICB0aGlzLnN0YXRzLm1pc3NlcysrO1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICAvLyBVcGRhdGUgTFJVIHRyYWNraW5nXHJcbiAgICBlbnRyeS5hY2Nlc3NDb3VudCsrO1xyXG4gICAgZW50cnkubGFzdEFjY2Vzc2VkID0gbm93O1xyXG4gICAgdGhpcy5zdGF0cy5oaXRzKys7XHJcblxyXG4gICAgcmV0dXJuIGVudHJ5LmRhdGEgYXMgVDtcclxuICB9XHJcblxyXG4gIC8vIFNldCBjYWNoZSBlbnRyeSB3aXRoIGFkdmFuY2VkIGZlYXR1cmVzXHJcbiAgc2V0PFQgPSB1bmtub3duPihcclxuICAgIGtleTogc3RyaW5nLFxyXG4gICAgZGF0YTogVCxcclxuICAgIG9wdGlvbnM6IHtcclxuICAgICAgdHRsPzogbnVtYmVyO1xyXG4gICAgICB0YWdzPzogc3RyaW5nW107XHJcbiAgICAgIGNvbXByZXNzPzogYm9vbGVhbjtcclxuICAgIH0gPSB7fVxyXG4gICk6IHZvaWQge1xyXG4gICAgY29uc3QgdHRsID0gb3B0aW9ucy50dGwgfHwgdGhpcy5jb25maWcuZGVmYXVsdFRUTDtcclxuICAgIGNvbnN0IHNpemUgPSB0aGlzLmVzdGltYXRlU2l6ZShkYXRhKTtcclxuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcblxyXG4gICAgLy8gQ2hlY2sgaWYgd2UgbmVlZCB0byBldmljdCBlbnRyaWVzIHRvIG1ha2Ugcm9vbVxyXG4gICAgaWYgKHRoaXMuc3RhdHMuc2l6ZSArIHNpemUgPiB0aGlzLmNvbmZpZy5tYXhTaXplKSB7XHJcbiAgICAgIGNvbnN0IHJlcXVpcmVkU3BhY2UgPSB0aGlzLnN0YXRzLnNpemUgKyBzaXplIC0gdGhpcy5jb25maWcubWF4U2l6ZTtcclxuICAgICAgdGhpcy5ldmljdExSVShyZXF1aXJlZFNwYWNlKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBlbnRyeTogQ2FjaGVFbnRyeTxUPiA9IHtcclxuICAgICAgZGF0YSxcclxuICAgICAgdGltZXN0YW1wOiBub3csXHJcbiAgICAgIHR0bCxcclxuICAgICAgYWNjZXNzQ291bnQ6IDAsXHJcbiAgICAgIGxhc3RBY2Nlc3NlZDogbm93LFxyXG4gICAgICBzaXplLFxyXG4gICAgICB0YWdzOiBvcHRpb25zLnRhZ3NcclxuICAgIH07XHJcblxyXG4gICAgLy8gUmVtb3ZlIG9sZCBlbnRyeSBpZiBpdCBleGlzdHNcclxuICAgIGNvbnN0IG9sZEVudHJ5ID0gdGhpcy5jYWNoZS5nZXQoa2V5KTtcclxuICAgIGlmIChvbGRFbnRyeSkge1xyXG4gICAgICB0aGlzLnN0YXRzLnNpemUgLT0gb2xkRW50cnkuc2l6ZTtcclxuICAgICAgdGhpcy5zdGF0cy5pdGVtQ291bnQtLTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmNhY2hlLnNldChrZXksIGVudHJ5KTtcclxuICAgIHRoaXMuc3RhdHMuc2l6ZSArPSBzaXplO1xyXG4gICAgdGhpcy5zdGF0cy5pdGVtQ291bnQrKztcclxuICAgIHRoaXMuc3RhdHMuc2V0cysrO1xyXG4gIH1cclxuXHJcbiAgLy8gTFJVIGV2aWN0aW9uXHJcbiAgcHJpdmF0ZSBldmljdExSVShyZXF1aXJlZFNwYWNlOiBudW1iZXIpOiB2b2lkIHtcclxuICAgIGlmICghdGhpcy5jb25maWcubHJ1RW5hYmxlZCkgcmV0dXJuO1xyXG5cclxuICAgIGNvbnN0IGVudHJpZXMgPSBBcnJheS5mcm9tKHRoaXMuY2FjaGUuZW50cmllcygpKVxyXG4gICAgICAuc29ydCgoWywgYV0sIFssIGJdKSA9PiB7XHJcbiAgICAgICAgLy8gU29ydCBieSBhY2Nlc3MgY291bnQsIHRoZW4gYnkgbGFzdCBhY2Nlc3NlZCB0aW1lXHJcbiAgICAgICAgaWYgKGEuYWNjZXNzQ291bnQgIT09IGIuYWNjZXNzQ291bnQpIHtcclxuICAgICAgICAgIHJldHVybiBhLmFjY2Vzc0NvdW50IC0gYi5hY2Nlc3NDb3VudDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGEubGFzdEFjY2Vzc2VkIC0gYi5sYXN0QWNjZXNzZWQ7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIGxldCBmcmVlZFNwYWNlID0gMDtcclxuICAgIGZvciAoY29uc3QgW2tleSwgZW50cnldIG9mIGVudHJpZXMpIHtcclxuICAgICAgaWYgKGZyZWVkU3BhY2UgPj0gcmVxdWlyZWRTcGFjZSkgYnJlYWs7XHJcblxyXG4gICAgICB0aGlzLmNhY2hlLmRlbGV0ZShrZXkpO1xyXG4gICAgICB0aGlzLnN0YXRzLnNpemUgLT0gZW50cnkuc2l6ZTtcclxuICAgICAgdGhpcy5zdGF0cy5pdGVtQ291bnQtLTtcclxuICAgICAgdGhpcy5zdGF0cy5ldmljdGlvbnMrKztcclxuICAgICAgZnJlZWRTcGFjZSArPSBlbnRyeS5zaXplO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gRGVsZXRlIGNhY2hlIGVudHJ5XHJcbiAgZGVsZXRlKGtleTogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICBjb25zdCBlbnRyeSA9IHRoaXMuY2FjaGUuZ2V0KGtleSk7XHJcbiAgICBpZiAoZW50cnkpIHtcclxuICAgICAgdGhpcy5jYWNoZS5kZWxldGUoa2V5KTtcclxuICAgICAgdGhpcy5zdGF0cy5zaXplIC09IGVudHJ5LnNpemU7XHJcbiAgICAgIHRoaXMuc3RhdHMuaXRlbUNvdW50LS07XHJcbiAgICAgIHRoaXMuc3RhdHMuZGVsZXRlcysrO1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcblxyXG4gIC8vIENsZWFyIGNhY2hlIGJ5IHRhZ3NcclxuICBjbGVhckJ5VGFncyh0YWdzOiBzdHJpbmdbXSk6IG51bWJlciB7XHJcbiAgICBsZXQgY2xlYXJlZCA9IDA7XHJcbiAgICBmb3IgKGNvbnN0IFtrZXksIGVudHJ5XSBvZiB0aGlzLmNhY2hlLmVudHJpZXMoKSkge1xyXG4gICAgICBpZiAoZW50cnkudGFncyAmJiBlbnRyeS50YWdzLnNvbWUodGFnID0+IHRhZ3MuaW5jbHVkZXModGFnKSkpIHtcclxuICAgICAgICB0aGlzLmNhY2hlLmRlbGV0ZShrZXkpO1xyXG4gICAgICAgIHRoaXMuc3RhdHMuc2l6ZSAtPSBlbnRyeS5zaXplO1xyXG4gICAgICAgIHRoaXMuc3RhdHMuaXRlbUNvdW50LS07XHJcbiAgICAgICAgdGhpcy5zdGF0cy5kZWxldGVzKys7XHJcbiAgICAgICAgY2xlYXJlZCsrO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gY2xlYXJlZDtcclxuICB9XHJcblxyXG4gIC8vIENsZWFyIGFsbCBjYWNoZVxyXG4gIGNsZWFyKCk6IHZvaWQge1xyXG4gICAgdGhpcy5jYWNoZS5jbGVhcigpO1xyXG4gICAgdGhpcy5zdGF0cy5zaXplID0gMDtcclxuICAgIHRoaXMuc3RhdHMuaXRlbUNvdW50ID0gMDtcclxuICAgIHRoaXMuc3RhdHMuZGVsZXRlcyArPSB0aGlzLnN0YXRzLml0ZW1Db3VudDtcclxuICB9XHJcblxyXG4gIC8vIEhhbmRsZSByZXF1ZXN0IGRlZHVwbGljYXRpb24gd2l0aCBlbmhhbmNlZCBlcnJvciBoYW5kbGluZ1xyXG4gIGFzeW5jIGRlZHVwZTxUPihcclxuICAgIGtleTogc3RyaW5nLFxyXG4gICAgcmVxdWVzdEZuOiAoKSA9PiBQcm9taXNlPFQ+LFxyXG4gICAgb3B0aW9uczoge1xyXG4gICAgICB0dGw/OiBudW1iZXI7XHJcbiAgICAgIHRhZ3M/OiBzdHJpbmdbXTtcclxuICAgICAgdXNlQ2FjaGU/OiBib29sZWFuO1xyXG4gICAgfSA9IHt9XHJcbiAgKTogUHJvbWlzZTxUPiB7XHJcbiAgICAvLyBDaGVjayBjYWNoZSBmaXJzdCBpZiBlbmFibGVkXHJcbiAgICBpZiAob3B0aW9ucy51c2VDYWNoZSAhPT0gZmFsc2UpIHtcclxuICAgICAgY29uc3QgY2FjaGVkID0gdGhpcy5nZXQ8VD4oa2V5KTtcclxuICAgICAgaWYgKGNhY2hlZCAhPT0gbnVsbCkge1xyXG4gICAgICAgIHJldHVybiBjYWNoZWQ7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBDaGVjayBpZiByZXF1ZXN0IGlzIGFscmVhZHkgcGVuZGluZ1xyXG4gICAgY29uc3QgcGVuZGluZyA9IHRoaXMucGVuZGluZ1JlcXVlc3RzLmdldChrZXkpO1xyXG4gICAgaWYgKHBlbmRpbmcpIHtcclxuICAgICAgcmV0dXJuIHBlbmRpbmcgYXMgUHJvbWlzZTxUPjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBFeGVjdXRlIHJlcXVlc3QgYW5kIGNhY2hlIHRoZSBwcm9taXNlXHJcbiAgICBjb25zdCBwcm9taXNlID0gcmVxdWVzdEZuKClcclxuICAgICAgLnRoZW4ocmVzdWx0ID0+IHtcclxuICAgICAgICAvLyBDYWNoZSBzdWNjZXNzZnVsIHJlc3VsdHNcclxuICAgICAgICBpZiAob3B0aW9ucy51c2VDYWNoZSAhPT0gZmFsc2UpIHtcclxuICAgICAgICAgIHRoaXMuc2V0KGtleSwgcmVzdWx0LCB7XHJcbiAgICAgICAgICAgIHR0bDogb3B0aW9ucy50dGwsXHJcbiAgICAgICAgICAgIHRhZ3M6IG9wdGlvbnMudGFnc1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICB0aGlzLnBlbmRpbmdSZXF1ZXN0cy5kZWxldGUoa2V5KTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgdGhpcy5wZW5kaW5nUmVxdWVzdHMuc2V0KGtleSwgcHJvbWlzZSk7XHJcbiAgICByZXR1cm4gcHJvbWlzZTtcclxuICB9XHJcblxyXG4gIC8vIEdldCBjYWNoZSBzdGF0aXN0aWNzXHJcbiAgZ2V0U3RhdHMoKTogQ2FjaGVTdGF0cyB7XHJcbiAgICByZXR1cm4geyAuLi50aGlzLnN0YXRzIH07XHJcbiAgfVxyXG5cclxuICAvLyBHZXQgY2FjaGUgaGl0IHJhdGVcclxuICBnZXRIaXRSYXRlKCk6IG51bWJlciB7XHJcbiAgICBjb25zdCB0b3RhbCA9IHRoaXMuc3RhdHMuaGl0cyArIHRoaXMuc3RhdHMubWlzc2VzO1xyXG4gICAgcmV0dXJuIHRvdGFsID4gMCA/IHRoaXMuc3RhdHMuaGl0cyAvIHRvdGFsIDogMDtcclxuICB9XHJcblxyXG4gIC8vIENsZWFudXAgZXhwaXJlZCBlbnRyaWVzXHJcbiAgY2xlYW51cCgpOiB2b2lkIHtcclxuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcbiAgICBmb3IgKGNvbnN0IFtrZXksIGVudHJ5XSBvZiB0aGlzLmNhY2hlLmVudHJpZXMoKSkge1xyXG4gICAgICBpZiAobm93IC0gZW50cnkudGltZXN0YW1wID4gZW50cnkudHRsKSB7XHJcbiAgICAgICAgdGhpcy5jYWNoZS5kZWxldGUoa2V5KTtcclxuICAgICAgICB0aGlzLnN0YXRzLnNpemUgLT0gZW50cnkuc2l6ZTtcclxuICAgICAgICB0aGlzLnN0YXRzLml0ZW1Db3VudC0tO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBQZXJzaXN0IGNhY2hlIHRvIGxvY2FsU3RvcmFnZVxyXG4gIHByaXZhdGUgcGVyc2lzdENhY2hlKCk6IHZvaWQge1xyXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnIHx8ICF3aW5kb3cubG9jYWxTdG9yYWdlKSByZXR1cm47XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcGVyc2lzdGFibGVEYXRhID0gQXJyYXkuZnJvbSh0aGlzLmNhY2hlLmVudHJpZXMoKSlcclxuICAgICAgICAuZmlsdGVyKChbLCBlbnRyeV0pID0+IHtcclxuICAgICAgICAgIC8vIE9ubHkgcGVyc2lzdCBlbnRyaWVzIHRoYXQgaGF2ZW4ndCBleHBpcmVkIGFuZCBhcmVuJ3QgdG9vIGxhcmdlXHJcbiAgICAgICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgICAgcmV0dXJuIChub3cgLSBlbnRyeS50aW1lc3RhbXAgPCBlbnRyeS50dGwpICYmIGVudHJ5LnNpemUgPCAxMDI0ICogMTAyNDsgLy8gPCAxTUJcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5tYXAoKFtrZXksIGVudHJ5XSkgPT4gW2tleSwge1xyXG4gICAgICAgICAgZGF0YTogZW50cnkuZGF0YSxcclxuICAgICAgICAgIHRpbWVzdGFtcDogZW50cnkudGltZXN0YW1wLFxyXG4gICAgICAgICAgdHRsOiBlbnRyeS50dGwsXHJcbiAgICAgICAgICBhY2Nlc3NDb3VudDogZW50cnkuYWNjZXNzQ291bnQsXHJcbiAgICAgICAgICBsYXN0QWNjZXNzZWQ6IGVudHJ5Lmxhc3RBY2Nlc3NlZCxcclxuICAgICAgICAgIHNpemU6IGVudHJ5LnNpemUsXHJcbiAgICAgICAgICB0YWdzOiBlbnRyeS50YWdzXHJcbiAgICAgICAgfV0pO1xyXG5cclxuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0odGhpcy5jb25maWcucGVyc2lzdGVuY2VLZXksIEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBkYXRhOiBwZXJzaXN0YWJsZURhdGEsXHJcbiAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpXHJcbiAgICAgIH0pKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIHBlcnNpc3QgY2FjaGU6JywgZXJyb3IpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gTG9hZCBwZXJzaXN0ZWQgY2FjaGUgZnJvbSBsb2NhbFN0b3JhZ2VcclxuICBwcml2YXRlIGxvYWRQZXJzaXN0ZWRDYWNoZSgpOiB2b2lkIHtcclxuICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJyB8fCAhd2luZG93LmxvY2FsU3RvcmFnZSkgcmV0dXJuO1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHBlcnNpc3RlZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKHRoaXMuY29uZmlnLnBlcnNpc3RlbmNlS2V5KTtcclxuICAgICAgaWYgKCFwZXJzaXN0ZWQpIHJldHVybjtcclxuXHJcbiAgICAgIGNvbnN0IHsgZGF0YSwgdGltZXN0YW1wIH0gPSBKU09OLnBhcnNlKHBlcnNpc3RlZCk7XHJcbiAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcblxyXG4gICAgICAvLyBPbmx5IGxvYWQgaWYgcGVyc2lzdGVkIHdpdGhpbiBsYXN0IDI0IGhvdXJzXHJcbiAgICAgIGlmIChub3cgLSB0aW1lc3RhbXAgPiAyNCAqIDYwICogNjAgKiAxMDAwKSB7XHJcbiAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0odGhpcy5jb25maWcucGVyc2lzdGVuY2VLZXkpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgZm9yIChjb25zdCBba2V5LCBlbnRyeV0gb2YgZGF0YSkge1xyXG4gICAgICAgIC8vIENoZWNrIGlmIGVudHJ5IGlzIHN0aWxsIHZhbGlkXHJcbiAgICAgICAgaWYgKG5vdyAtIGVudHJ5LnRpbWVzdGFtcCA8IGVudHJ5LnR0bCkge1xyXG4gICAgICAgICAgdGhpcy5jYWNoZS5zZXQoa2V5LCBlbnRyeSk7XHJcbiAgICAgICAgICB0aGlzLnN0YXRzLnNpemUgKz0gZW50cnkuc2l6ZTtcclxuICAgICAgICAgIHRoaXMuc3RhdHMuaXRlbUNvdW50Kys7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zb2xlLmxvZyhgTG9hZGVkICR7dGhpcy5zdGF0cy5pdGVtQ291bnR9IHBlcnNpc3RlZCBjYWNoZSBlbnRyaWVzYCk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBsb2FkIHBlcnNpc3RlZCBjYWNoZTonLCBlcnJvcik7XHJcbiAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKHRoaXMuY29uZmlnLnBlcnNpc3RlbmNlS2V5KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIFdhcm0gdXAgY2FjaGUgd2l0aCBmcmVxdWVudGx5IGFjY2Vzc2VkIGRhdGFcclxuICBhc3luYyB3YXJtdXAoa2V5czogc3RyaW5nW10pOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGNvbnN0IHdhcm11cFByb21pc2VzID0ga2V5cy5tYXAoYXN5bmMgKGtleSkgPT4ge1xyXG4gICAgICAvLyBUaGlzIHdvdWxkIHR5cGljYWxseSBmZXRjaCBmcm9tIGEgZmFzdCBzb3VyY2Ugb3IgcHJlLWNvbXB1dGVkIGRhdGFcclxuICAgICAgLy8gRm9yIG5vdywganVzdCBlbnN1cmUgdGhlIGtleSBleGlzdHMgaW4gY2FjaGVcclxuICAgICAgcmV0dXJuIHRoaXMuY2FjaGUuaGFzKGtleSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBhd2FpdCBQcm9taXNlLmFsbCh3YXJtdXBQcm9taXNlcyk7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBHbG9iYWwgYWR2YW5jZWQgY2FjaGUgaW5zdGFuY2Ugd2l0aCBvcHRpbWl6ZWQgc2V0dGluZ3NcclxuZXhwb3J0IGNvbnN0IGFkdmFuY2VkQXBpQ2FjaGUgPSBuZXcgQWR2YW5jZWRBUElDYWNoZSh7XHJcbiAgbWF4U2l6ZTogMTAwICogMTAyNCAqIDEwMjQsIC8vIDEwME1CIGZvciBiZXR0ZXIgcGVyZm9ybWFuY2VcclxuICBkZWZhdWx0VFRMOiAxMCAqIDYwICogMTAwMCwgLy8gMTAgbWludXRlcyBmb3IgYmV0dGVyIGNhY2hlIGhpdCByYXRlc1xyXG4gIGVuYWJsZVBlcnNpc3RlbmNlOiB0cnVlLFxyXG4gIHBlcnNpc3RlbmNlS2V5OiAncG9pbnRzLWNvbXBhbmlvbi1jYWNoZS12MicsXHJcbiAgZW5hYmxlQ29tcHJlc3Npb246IGZhbHNlLCAvLyBDYW4gYmUgZW5hYmxlZCBsYXRlciB3aXRoIGNvbXByZXNzaW9uIGxpYnJhcnlcclxuICBscnVFbmFibGVkOiB0cnVlXHJcbn0pO1xyXG5cclxuLy8gTGVnYWN5IGNhY2hlIGluc3RhbmNlIGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5XHJcbmV4cG9ydCBjb25zdCBhcGlDYWNoZSA9IGFkdmFuY2VkQXBpQ2FjaGU7XHJcblxyXG4vLyBDYWNoZSB3YXJtaW5nIHV0aWxpdHlcclxuZXhwb3J0IGNvbnN0IHdhcm11cENhY2hlID0gYXN5bmMgKGZyZXF1ZW50bHlVc2VkS2V5czogc3RyaW5nW10pID0+IHtcclxuICBhd2FpdCBhZHZhbmNlZEFwaUNhY2hlLndhcm11cChmcmVxdWVudGx5VXNlZEtleXMpO1xyXG59O1xyXG5cclxuLy8gQ2FjaGUgbW9uaXRvcmluZyB1dGlsaXR5XHJcbmV4cG9ydCBjb25zdCBnZXRDYWNoZU1ldHJpY3MgPSAoKSA9PiB7XHJcbiAgY29uc3Qgc3RhdHMgPSBhZHZhbmNlZEFwaUNhY2hlLmdldFN0YXRzKCk7XHJcbiAgY29uc3QgaGl0UmF0ZSA9IGFkdmFuY2VkQXBpQ2FjaGUuZ2V0SGl0UmF0ZSgpO1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgLi4uc3RhdHMsXHJcbiAgICBoaXRSYXRlOiBgJHsoaGl0UmF0ZSAqIDEwMCkudG9GaXhlZCgyKX0lYCxcclxuICAgIHNpemVGb3JtYXR0ZWQ6IGAkeyhzdGF0cy5zaXplIC8gMTAyNCAvIDEwMjQpLnRvRml4ZWQoMil9TUJgLFxyXG4gICAgZWZmaWNpZW5jeTogaGl0UmF0ZSA+IDAuOCA/ICdFeGNlbGxlbnQnIDogaGl0UmF0ZSA+IDAuNiA/ICdHb29kJyA6ICdOZWVkcyBPcHRpbWl6YXRpb24nXHJc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