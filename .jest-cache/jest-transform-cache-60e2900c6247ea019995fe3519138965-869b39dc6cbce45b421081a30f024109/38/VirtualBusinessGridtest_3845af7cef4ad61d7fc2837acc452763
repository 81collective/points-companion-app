e38e98ffda02f4fca9963fe695dd5ee4
"use strict";

var _react = _interopRequireDefault(require("react"));
var _testUtils = require("../testUtils");
var _VirtualBusinessGrid = _interopRequireDefault(require("../../components/common/VirtualBusinessGrid"));
function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
function _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }
// Setup mocks before tests
beforeAll(() => {
  (0, _testUtils.setupTests)();
});
describe('VirtualBusinessGrid', () => {
  const mockBusinesses = Array.from({
    length: 100
  }, (_, i) => (0, _testUtils.createMockBusiness)({
    id: `business-${i}`,
    name: `Test Business ${i}`,
    distance: i * 100
  }));
  const defaultProps = {
    businesses: mockBusinesses,
    selectedBusiness: null,
    onBusinessSelect: jest.fn()
  };
  beforeEach(() => {
    jest.clearAllMocks();
  });
  it('renders business grid with correct number of visible items', async () => {
    (0, _testUtils.customRender)(/*#__PURE__*/_react.default.createElement(_VirtualBusinessGrid.default, defaultProps));
    await (0, _testUtils.waitFor)(() => {
      // Should render a subset of businesses (not all 100)
      const businessCards = _testUtils.screen.getAllByTestId(/^business-card-/);
      expect(businessCards.length).toBeGreaterThan(0);
      expect(businessCards.length).toBeLessThan(100);
    });
  });
  it('calls onBusinessSelect when business is clicked', async () => {
    (0, _testUtils.customRender)(/*#__PURE__*/_react.default.createElement(_VirtualBusinessGrid.default, defaultProps));
    await (0, _testUtils.waitFor)(() => {
      const firstBusinessCard = _testUtils.screen.getByTestId('business-card-business-0');
      firstBusinessCard.click();
    });
    expect(defaultProps.onBusinessSelect).toHaveBeenCalledWith(mockBusinesses[0]);
  });
  it('renders business information correctly', async () => {
    (0, _testUtils.customRender)(/*#__PURE__*/_react.default.createElement(_VirtualBusinessGrid.default, defaultProps));
    await (0, _testUtils.waitFor)(() => {
      expect(_testUtils.screen.getByText('Test Business 0')).toBeInTheDocument();
      const addressElements = _testUtils.screen.getAllByText('123 Test St');
      expect(addressElements.length).toBeGreaterThan(0);
    });
  });
  it('displays distance information', async () => {
    (0, _testUtils.customRender)(/*#__PURE__*/_react.default.createElement(_VirtualBusinessGrid.default, defaultProps));
    await (0, _testUtils.waitFor)(() => {
      // First business has distance 0, so it should show "0"
      expect(_testUtils.screen.getByText('0')).toBeInTheDocument();
    });
  });
  it('shows rating with stars', async () => {
    (0, _testUtils.customRender)(/*#__PURE__*/_react.default.createElement(_VirtualBusinessGrid.default, defaultProps));
    await (0, _testUtils.waitFor)(() => {
      const ratingElements = _testUtils.screen.getAllByText('4.5');
      expect(ratingElements.length).toBeGreaterThan(0);
    });
  });
  it('displays price level indicators', async () => {
    (0, _testUtils.customRender)(/*#__PURE__*/_react.default.createElement(_VirtualBusinessGrid.default, defaultProps));
    await (0, _testUtils.waitFor)(() => {
      // Price level is available in the business data but not visually displayed
      expect(_testUtils.screen.getByText('Test Business 0')).toBeInTheDocument();
    });
  });
  it('handles empty businesses array', () => {
    (0, _testUtils.customRender)(/*#__PURE__*/_react.default.createElement(_VirtualBusinessGrid.default, _extends({}, defaultProps, {
      businesses: []
    })));
    expect(_testUtils.screen.getByText('No businesses found in this area')).toBeInTheDocument();
  });
  it('calls onLoadMore when scrolling to bottom', async () => {
    (0, _testUtils.customRender)(/*#__PURE__*/_react.default.createElement(_VirtualBusinessGrid.default, defaultProps));

    // Simulate scroll to bottom
    const scrollContainer = _testUtils.screen.getByTestId('virtual-grid-container');
    _testUtils.fireEvent.scroll(scrollContainer, {
      target: {
        scrollTop: 1000
      }
    });

    // The component handles scrolling internally, no external onLoadMore callback
    await (0, _testUtils.waitFor)(() => {
      expect(scrollContainer).toBeInTheDocument();
    });
  });
  it('is accessible with proper ARIA labels', async () => {
    (0, _testUtils.customRender)(/*#__PURE__*/_react.default.createElement(_VirtualBusinessGrid.default, defaultProps));
    await (0, _testUtils.waitFor)(() => {
      const businessCards = _testUtils.screen.getAllByTestId(/^business-card-/);
      businessCards.forEach(card => {
        expect(card).toHaveAttribute('aria-label');
        expect(card).toHaveAttribute('role', 'button');
      });
    });
  });
  it('handles keyboard navigation', async () => {
    (0, _testUtils.customRender)(/*#__PURE__*/_react.default.createElement(_VirtualBusinessGrid.default, defaultProps));
    await (0, _testUtils.waitFor)(() => {
      const firstBusinessCard = _testUtils.screen.getByTestId('business-card-business-0');
      firstBusinessCard.focus();
      _testUtils.fireEvent.keyDown(firstBusinessCard, {
        key: 'Enter'
      });
    });
    expect(defaultProps.onBusinessSelect).toHaveBeenCalledWith(mockBusinesses[0]);
  });
  it('renders with responsive columns', () => {
    // Mock different screen sizes
    Object.defineProperty(window, 'innerWidth', {
      value: 768,
      writable: true
    });
    (0, _testUtils.customRender)(/*#__PURE__*/_react.default.createElement(_VirtualBusinessGrid.default, defaultProps));

    // The component calculates columns based on screen size
    // For mobile (width < 768), it should use 1 column
    const grid = _testUtils.screen.getByTestId('virtual-grid-container');
    expect(grid).toBeInTheDocument();
  });
  it('memoizes business cards for performance', () => {
    const {
      rerender
    } = (0, _testUtils.customRender)(/*#__PURE__*/_react.default.createElement(_VirtualBusinessGrid.default, defaultProps));

    // Re-render with same props
    rerender(/*#__PURE__*/_react.default.createElement(_VirtualBusinessGrid.default, defaultProps));

    // Business cards should be memoized and not re-render unnecessarily
    expect(_testUtils.screen.getByTestId('business-card-business-0')).toBeInTheDocument();
  });
  it('handles business selection with proper focus management', async () => {
    (0, _testUtils.customRender)(/*#__PURE__*/_react.default.createElement(_VirtualBusinessGrid.default, defaultProps));
    await (0, _testUtils.waitFor)(() => {
      const firstBusinessCard = _testUtils.screen.getByTestId('business-card-business-0');
      firstBusinessCard.click();
    });
    expect(defaultProps.onBusinessSelect).toHaveBeenCalledWith(mockBusinesses[0]);
    // Focus should be managed properly
    expect(document.activeElement).toBeInTheDocument();
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl90ZXN0VXRpbHMiLCJfVmlydHVhbEJ1c2luZXNzR3JpZCIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIl9leHRlbmRzIiwiT2JqZWN0IiwiYXNzaWduIiwiYmluZCIsIm4iLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ0IiwiciIsImhhc093blByb3BlcnR5IiwiY2FsbCIsImFwcGx5IiwiYmVmb3JlQWxsIiwic2V0dXBUZXN0cyIsImRlc2NyaWJlIiwibW9ja0J1c2luZXNzZXMiLCJBcnJheSIsImZyb20iLCJfIiwiaSIsImNyZWF0ZU1vY2tCdXNpbmVzcyIsImlkIiwibmFtZSIsImRpc3RhbmNlIiwiZGVmYXVsdFByb3BzIiwiYnVzaW5lc3NlcyIsInNlbGVjdGVkQnVzaW5lc3MiLCJvbkJ1c2luZXNzU2VsZWN0IiwiamVzdCIsImZuIiwiYmVmb3JlRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJpdCIsImN1c3RvbVJlbmRlciIsImNyZWF0ZUVsZW1lbnQiLCJ3YWl0Rm9yIiwiYnVzaW5lc3NDYXJkcyIsInNjcmVlbiIsImdldEFsbEJ5VGVzdElkIiwiZXhwZWN0IiwidG9CZUdyZWF0ZXJUaGFuIiwidG9CZUxlc3NUaGFuIiwiZmlyc3RCdXNpbmVzc0NhcmQiLCJnZXRCeVRlc3RJZCIsImNsaWNrIiwidG9IYXZlQmVlbkNhbGxlZFdpdGgiLCJnZXRCeVRleHQiLCJ0b0JlSW5UaGVEb2N1bWVudCIsImFkZHJlc3NFbGVtZW50cyIsImdldEFsbEJ5VGV4dCIsInJhdGluZ0VsZW1lbnRzIiwic2Nyb2xsQ29udGFpbmVyIiwiZmlyZUV2ZW50Iiwic2Nyb2xsIiwidGFyZ2V0Iiwic2Nyb2xsVG9wIiwiZm9yRWFjaCIsImNhcmQiLCJ0b0hhdmVBdHRyaWJ1dGUiLCJmb2N1cyIsImtleURvd24iLCJrZXkiLCJkZWZpbmVQcm9wZXJ0eSIsIndpbmRvdyIsInZhbHVlIiwid3JpdGFibGUiLCJncmlkIiwicmVyZW5kZXIiLCJkb2N1bWVudCIsImFjdGl2ZUVsZW1lbnQiXSwic291cmNlcyI6WyJWaXJ0dWFsQnVzaW5lc3NHcmlkLnRlc3QudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IGN1c3RvbVJlbmRlciwgc2NyZWVuLCB3YWl0Rm9yLCBmaXJlRXZlbnQsIGNyZWF0ZU1vY2tCdXNpbmVzcywgc2V0dXBUZXN0cyB9IGZyb20gJy4uL3Rlc3RVdGlscyc7XHJcbmltcG9ydCBWaXJ0dWFsQnVzaW5lc3NHcmlkIGZyb20gJy4uLy4uL2NvbXBvbmVudHMvY29tbW9uL1ZpcnR1YWxCdXNpbmVzc0dyaWQnO1xyXG5cclxuLy8gU2V0dXAgbW9ja3MgYmVmb3JlIHRlc3RzXHJcbmJlZm9yZUFsbCgoKSA9PiB7XHJcbiAgc2V0dXBUZXN0cygpO1xyXG59KTtcclxuXHJcbmRlc2NyaWJlKCdWaXJ0dWFsQnVzaW5lc3NHcmlkJywgKCkgPT4ge1xyXG4gIGNvbnN0IG1vY2tCdXNpbmVzc2VzID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogMTAwIH0sIChfLCBpKSA9PlxyXG4gICAgY3JlYXRlTW9ja0J1c2luZXNzKHtcclxuICAgICAgaWQ6IGBidXNpbmVzcy0ke2l9YCxcclxuICAgICAgbmFtZTogYFRlc3QgQnVzaW5lc3MgJHtpfWAsXHJcbiAgICAgIGRpc3RhbmNlOiBpICogMTAwLFxyXG4gICAgfSlcclxuICApO1xyXG5cclxuICBjb25zdCBkZWZhdWx0UHJvcHMgPSB7XHJcbiAgICBidXNpbmVzc2VzOiBtb2NrQnVzaW5lc3NlcyxcclxuICAgIHNlbGVjdGVkQnVzaW5lc3M6IG51bGwsXHJcbiAgICBvbkJ1c2luZXNzU2VsZWN0OiBqZXN0LmZuKCksXHJcbiAgfTtcclxuXHJcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcclxuICB9KTtcclxuXHJcbiAgaXQoJ3JlbmRlcnMgYnVzaW5lc3MgZ3JpZCB3aXRoIGNvcnJlY3QgbnVtYmVyIG9mIHZpc2libGUgaXRlbXMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICBjdXN0b21SZW5kZXIoPFZpcnR1YWxCdXNpbmVzc0dyaWQgey4uLmRlZmF1bHRQcm9wc30gLz4pO1xyXG5cclxuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xyXG4gICAgICAvLyBTaG91bGQgcmVuZGVyIGEgc3Vic2V0IG9mIGJ1c2luZXNzZXMgKG5vdCBhbGwgMTAwKVxyXG4gICAgICBjb25zdCBidXNpbmVzc0NhcmRzID0gc2NyZWVuLmdldEFsbEJ5VGVzdElkKC9eYnVzaW5lc3MtY2FyZC0vKTtcclxuICAgICAgZXhwZWN0KGJ1c2luZXNzQ2FyZHMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XHJcbiAgICAgIGV4cGVjdChidXNpbmVzc0NhcmRzLmxlbmd0aCkudG9CZUxlc3NUaGFuKDEwMCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgaXQoJ2NhbGxzIG9uQnVzaW5lc3NTZWxlY3Qgd2hlbiBidXNpbmVzcyBpcyBjbGlja2VkJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgY3VzdG9tUmVuZGVyKDxWaXJ0dWFsQnVzaW5lc3NHcmlkIHsuLi5kZWZhdWx0UHJvcHN9IC8+KTtcclxuXHJcbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcclxuICAgICAgY29uc3QgZmlyc3RCdXNpbmVzc0NhcmQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2J1c2luZXNzLWNhcmQtYnVzaW5lc3MtMCcpO1xyXG4gICAgICBmaXJzdEJ1c2luZXNzQ2FyZC5jbGljaygpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZXhwZWN0KGRlZmF1bHRQcm9wcy5vbkJ1c2luZXNzU2VsZWN0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChtb2NrQnVzaW5lc3Nlc1swXSk7XHJcbiAgfSk7XHJcblxyXG4gIGl0KCdyZW5kZXJzIGJ1c2luZXNzIGluZm9ybWF0aW9uIGNvcnJlY3RseScsIGFzeW5jICgpID0+IHtcclxuICAgIGN1c3RvbVJlbmRlcig8VmlydHVhbEJ1c2luZXNzR3JpZCB7Li4uZGVmYXVsdFByb3BzfSAvPik7XHJcblxyXG4gICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XHJcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdUZXN0IEJ1c2luZXNzIDAnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgICAgY29uc3QgYWRkcmVzc0VsZW1lbnRzID0gc2NyZWVuLmdldEFsbEJ5VGV4dCgnMTIzIFRlc3QgU3QnKTtcclxuICAgICAgZXhwZWN0KGFkZHJlc3NFbGVtZW50cy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBpdCgnZGlzcGxheXMgZGlzdGFuY2UgaW5mb3JtYXRpb24nLCBhc3luYyAoKSA9PiB7XHJcbiAgICBjdXN0b21SZW5kZXIoPFZpcnR1YWxCdXNpbmVzc0dyaWQgey4uLmRlZmF1bHRQcm9wc30gLz4pO1xyXG5cclxuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xyXG4gICAgICAvLyBGaXJzdCBidXNpbmVzcyBoYXMgZGlzdGFuY2UgMCwgc28gaXQgc2hvdWxkIHNob3cgXCIwXCJcclxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJzAnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBpdCgnc2hvd3MgcmF0aW5nIHdpdGggc3RhcnMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICBjdXN0b21SZW5kZXIoPFZpcnR1YWxCdXNpbmVzc0dyaWQgey4uLmRlZmF1bHRQcm9wc30gLz4pO1xyXG5cclxuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xyXG4gICAgICBjb25zdCByYXRpbmdFbGVtZW50cyA9IHNjcmVlbi5nZXRBbGxCeVRleHQoJzQuNScpO1xyXG4gICAgICBleHBlY3QocmF0aW5nRWxlbWVudHMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgaXQoJ2Rpc3BsYXlzIHByaWNlIGxldmVsIGluZGljYXRvcnMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICBjdXN0b21SZW5kZXIoPFZpcnR1YWxCdXNpbmVzc0dyaWQgey4uLmRlZmF1bHRQcm9wc30gLz4pO1xyXG5cclxuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xyXG4gICAgICAvLyBQcmljZSBsZXZlbCBpcyBhdmFpbGFibGUgaW4gdGhlIGJ1c2luZXNzIGRhdGEgYnV0IG5vdCB2aXN1YWxseSBkaXNwbGF5ZWRcclxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1Rlc3QgQnVzaW5lc3MgMCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGl0KCdoYW5kbGVzIGVtcHR5IGJ1c2luZXNzZXMgYXJyYXknLCAoKSA9PiB7XHJcbiAgICBjdXN0b21SZW5kZXIoPFZpcnR1YWxCdXNpbmVzc0dyaWQgey4uLmRlZmF1bHRQcm9wc30gYnVzaW5lc3Nlcz17W119IC8+KTtcclxuXHJcbiAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnTm8gYnVzaW5lc3NlcyBmb3VuZCBpbiB0aGlzIGFyZWEnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICB9KTtcclxuXHJcbiAgaXQoJ2NhbGxzIG9uTG9hZE1vcmUgd2hlbiBzY3JvbGxpbmcgdG8gYm90dG9tJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgY3VzdG9tUmVuZGVyKDxWaXJ0dWFsQnVzaW5lc3NHcmlkIHsuLi5kZWZhdWx0UHJvcHN9IC8+KTtcclxuXHJcbiAgICAvLyBTaW11bGF0ZSBzY3JvbGwgdG8gYm90dG9tXHJcbiAgICBjb25zdCBzY3JvbGxDb250YWluZXIgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ3ZpcnR1YWwtZ3JpZC1jb250YWluZXInKTtcclxuICAgIGZpcmVFdmVudC5zY3JvbGwoc2Nyb2xsQ29udGFpbmVyLCB7IHRhcmdldDogeyBzY3JvbGxUb3A6IDEwMDAgfSB9KTtcclxuXHJcbiAgICAvLyBUaGUgY29tcG9uZW50IGhhbmRsZXMgc2Nyb2xsaW5nIGludGVybmFsbHksIG5vIGV4dGVybmFsIG9uTG9hZE1vcmUgY2FsbGJhY2tcclxuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xyXG4gICAgICBleHBlY3Qoc2Nyb2xsQ29udGFpbmVyKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGl0KCdpcyBhY2Nlc3NpYmxlIHdpdGggcHJvcGVyIEFSSUEgbGFiZWxzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgY3VzdG9tUmVuZGVyKDxWaXJ0dWFsQnVzaW5lc3NHcmlkIHsuLi5kZWZhdWx0UHJvcHN9IC8+KTtcclxuXHJcbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcclxuICAgICAgY29uc3QgYnVzaW5lc3NDYXJkcyA9IHNjcmVlbi5nZXRBbGxCeVRlc3RJZCgvXmJ1c2luZXNzLWNhcmQtLyk7XHJcbiAgICAgIGJ1c2luZXNzQ2FyZHMuZm9yRWFjaChjYXJkID0+IHtcclxuICAgICAgICBleHBlY3QoY2FyZCkudG9IYXZlQXR0cmlidXRlKCdhcmlhLWxhYmVsJyk7XHJcbiAgICAgICAgZXhwZWN0KGNhcmQpLnRvSGF2ZUF0dHJpYnV0ZSgncm9sZScsICdidXR0b24nKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgaXQoJ2hhbmRsZXMga2V5Ym9hcmQgbmF2aWdhdGlvbicsIGFzeW5jICgpID0+IHtcclxuICAgIGN1c3RvbVJlbmRlcig8VmlydHVhbEJ1c2luZXNzR3JpZCB7Li4uZGVmYXVsdFByb3BzfSAvPik7XHJcblxyXG4gICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGZpcnN0QnVzaW5lc3NDYXJkID0gc2NyZWVuLmdldEJ5VGVzdElkKCdidXNpbmVzcy1jYXJkLWJ1c2luZXNzLTAnKTtcclxuICAgICAgZmlyc3RCdXNpbmVzc0NhcmQuZm9jdXMoKTtcclxuICAgICAgZmlyZUV2ZW50LmtleURvd24oZmlyc3RCdXNpbmVzc0NhcmQsIHsga2V5OiAnRW50ZXInIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZXhwZWN0KGRlZmF1bHRQcm9wcy5vbkJ1c2luZXNzU2VsZWN0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChtb2NrQnVzaW5lc3Nlc1swXSk7XHJcbiAgfSk7XHJcblxyXG4gIGl0KCdyZW5kZXJzIHdpdGggcmVzcG9uc2l2ZSBjb2x1bW5zJywgKCkgPT4ge1xyXG4gICAgLy8gTW9jayBkaWZmZXJlbnQgc2NyZWVuIHNpemVzXHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LCAnaW5uZXJXaWR0aCcsIHsgdmFsdWU6IDc2OCwgd3JpdGFibGU6IHRydWUgfSk7XHJcblxyXG4gICAgY3VzdG9tUmVuZGVyKDxWaXJ0dWFsQnVzaW5lc3NHcmlkIHsuLi5kZWZhdWx0UHJvcHN9IC8+KTtcclxuXHJcbiAgICAvLyBUaGUgY29tcG9uZW50IGNhbGN1bGF0ZXMgY29sdW1ucyBiYXNlZCBvbiBzY3JlZW4gc2l6ZVxyXG4gICAgLy8gRm9yIG1vYmlsZSAod2lkdGggPCA3NjgpLCBpdCBzaG91bGQgdXNlIDEgY29sdW1uXHJcbiAgICBjb25zdCBncmlkID0gc2NyZWVuLmdldEJ5VGVzdElkKCd2aXJ0dWFsLWdyaWQtY29udGFpbmVyJyk7XHJcbiAgICBleHBlY3QoZ3JpZCkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICB9KTtcclxuXHJcbiAgaXQoJ21lbW9pemVzIGJ1c2luZXNzIGNhcmRzIGZvciBwZXJmb3JtYW5jZScsICgpID0+IHtcclxuICAgIGNvbnN0IHsgcmVyZW5kZXIgfSA9IGN1c3RvbVJlbmRlcig8VmlydHVhbEJ1c2luZXNzR3JpZCB7Li4uZGVmYXVsdFByb3BzfSAvPik7XHJcblxyXG4gICAgLy8gUmUtcmVuZGVyIHdpdGggc2FtZSBwcm9wc1xyXG4gICAgcmVyZW5kZXIoPFZpcnR1YWxCdXNpbmVzc0dyaWQgey4uLmRlZmF1bHRQcm9wc30gLz4pO1xyXG5cclxuICAgIC8vIEJ1c2luZXNzIGNhcmRzIHNob3VsZCBiZSBtZW1vaXplZCBhbmQgbm90IHJlLXJlbmRlciB1bm5lY2Vzc2FyaWx5XHJcbiAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCdidXNpbmVzcy1jYXJkLWJ1c2luZXNzLTAnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICB9KTtcclxuXHJcbiAgaXQoJ2hhbmRsZXMgYnVzaW5lc3Mgc2VsZWN0aW9uIHdpdGggcHJvcGVyIGZvY3VzIG1hbmFnZW1lbnQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICBjdXN0b21SZW5kZXIoPFZpcnR1YWxCdXNpbmVzc0dyaWQgey4uLmRlZmF1bHRQcm9wc30gLz4pO1xyXG5cclxuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xyXG4gICAgICBjb25zdCBmaXJzdEJ1c2luZXNzQ2FyZCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnYnVzaW5lc3MtY2FyZC1idXNpbmVzcy0wJyk7XHJcbiAgICAgIGZpcnN0QnVzaW5lc3NDYXJkLmNsaWNrKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBleHBlY3QoZGVmYXVsdFByb3BzLm9uQnVzaW5lc3NTZWxlY3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKG1vY2tCdXNpbmVzc2VzWzBdKTtcclxuICAgIC8vIEZvY3VzIHNob3VsZCBiZSBtYW5hZ2VkIHByb3Blcmx5XHJcbiAgICBleHBlY3QoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICB9KTtcclxufSk7XHJcbiJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFBQSxNQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxVQUFBLEdBQUFELE9BQUE7QUFDQSxJQUFBRSxvQkFBQSxHQUFBSCxzQkFBQSxDQUFBQyxPQUFBO0FBQThFLFNBQUFELHVCQUFBSSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUs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