ebafbf0ad360fc69111d31c42714b766
"use strict";

var _react = _interopRequireDefault(require("react"));
var _testUtils = require("../testUtils");
var _VirtualBusinessGrid = _interopRequireDefault(require("../../components/common/VirtualBusinessGrid"));
function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
function _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }
// Setup mocks before tests
beforeAll(() => {
  (0, _testUtils.setupTests)();
});
describe('VirtualBusinessGrid', () => {
  const mockBusinesses = Array.from({
    length: 100
  }, (_, i) => (0, _testUtils.createMockBusiness)({
    id: `business-${i}`,
    name: `Test Business ${i}`,
    distance: i * 100
  }));
  const defaultProps = {
    businesses: mockBusinesses,
    selectedBusiness: null,
    onBusinessSelect: jest.fn()
  };
  beforeEach(() => {
    jest.clearAllMocks();
  });
  it('renders business grid with correct number of visible items', async () => {
    (0, _testUtils.customRender)(/*#__PURE__*/_react.default.createElement(_VirtualBusinessGrid.default, defaultProps));
    await (0, _testUtils.waitFor)(() => {
      // Should render a subset of businesses (not all 100)
      const businessCards = _testUtils.screen.getAllByTestId(/^business-card-/);
      expect(businessCards.length).toBeGreaterThan(0);
      expect(businessCards.length).toBeLessThan(100);
    });
  });
  it('calls onBusinessSelect when business is clicked', async () => {
    (0, _testUtils.customRender)(/*#__PURE__*/_react.default.createElement(_VirtualBusinessGrid.default, defaultProps));
    await (0, _testUtils.waitFor)(() => {
      const firstBusinessCard = _testUtils.screen.getByTestId('business-card-0');
      firstBusinessCard.click();
    });
    expect(defaultProps.onBusinessSelect).toHaveBeenCalledWith(mockBusinesses[0]);
  });
  it('renders business information correctly', async () => {
    (0, _testUtils.customRender)(/*#__PURE__*/_react.default.createElement(_VirtualBusinessGrid.default, defaultProps));
    await (0, _testUtils.waitFor)(() => {
      expect(_testUtils.screen.getByText('Test Business 0')).toBeInTheDocument();
      expect(_testUtils.screen.getByText('Test Restaurant')).toBeInTheDocument();
      expect(_testUtils.screen.getByText('123 Test St')).toBeInTheDocument();
    });
  });
  it('displays distance information', async () => {
    (0, _testUtils.customRender)(/*#__PURE__*/_react.default.createElement(_VirtualBusinessGrid.default, defaultProps));
    await (0, _testUtils.waitFor)(() => {
      expect(_testUtils.screen.getByText('1.0 km')).toBeInTheDocument();
    });
  });
  it('shows rating with stars', async () => {
    (0, _testUtils.customRender)(/*#__PURE__*/_react.default.createElement(_VirtualBusinessGrid.default, defaultProps));
    await (0, _testUtils.waitFor)(() => {
      const ratingElement = _testUtils.screen.getByTestId('rating-4.5');
      expect(ratingElement).toBeInTheDocument();
    });
  });
  it('displays price level indicators', async () => {
    (0, _testUtils.customRender)(/*#__PURE__*/_react.default.createElement(_VirtualBusinessGrid.default, defaultProps));
    await (0, _testUtils.waitFor)(() => {
      const priceIndicators = _testUtils.screen.getAllByTestId('price-indicator');
      expect(priceIndicators.length).toBe(2); // $$ for price_level 2
    });
  });
  it('handles empty businesses array', () => {
    (0, _testUtils.customRender)(/*#__PURE__*/_react.default.createElement(_VirtualBusinessGrid.default, _extends({}, defaultProps, {
      businesses: []
    })));
    expect(_testUtils.screen.getByText('No businesses found')).toBeInTheDocument();
  });
  it('calls onLoadMore when scrolling to bottom', async () => {
    (0, _testUtils.customRender)(/*#__PURE__*/_react.default.createElement(_VirtualBusinessGrid.default, defaultProps));

    // Simulate scroll to bottom
    const scrollContainer = _testUtils.screen.getByTestId('virtual-grid-container');
    _testUtils.fireEvent.scroll(scrollContainer, {
      target: {
        scrollTop: 1000
      }
    });

    // The component handles scrolling internally, no external onLoadMore callback
    await (0, _testUtils.waitFor)(() => {
      expect(scrollContainer).toBeInTheDocument();
    });
  });
  it('is accessible with proper ARIA labels', async () => {
    (0, _testUtils.customRender)(/*#__PURE__*/_react.default.createElement(_VirtualBusinessGrid.default, defaultProps));
    await (0, _testUtils.waitFor)(() => {
      const businessCards = _testUtils.screen.getAllByTestId(/^business-card-/);
      businessCards.forEach(card => {
        expect(card).toHaveAttribute('aria-label');
        expect(card).toHaveAttribute('role', 'button');
      });
    });
  });
  it('handles keyboard navigation', async () => {
    (0, _testUtils.customRender)(/*#__PURE__*/_react.default.createElement(_VirtualBusinessGrid.default, defaultProps));
    await (0, _testUtils.waitFor)(() => {
      const firstBusinessCard = _testUtils.screen.getByTestId('business-card-0');
      firstBusinessCard.focus();
      _testUtils.fireEvent.keyDown(firstBusinessCard, {
        key: 'Enter'
      });
    });
    expect(defaultProps.onBusinessSelect).toHaveBeenCalledWith(mockBusinesses[0]);
  });
  it('renders with responsive columns', () => {
    // Mock different screen sizes
    Object.defineProperty(window, 'innerWidth', {
      value: 768,
      writable: true
    });
    (0, _testUtils.customRender)(/*#__PURE__*/_react.default.createElement(_VirtualBusinessGrid.default, defaultProps));

    // Should adjust columns based on screen size
    const grid = _testUtils.screen.getByTestId('virtual-grid-container');
    expect(grid).toHaveClass('grid-cols-2'); // md:grid-cols-2
  });
  it('memoizes business cards for performance', () => {
    const {
      rerender
    } = (0, _testUtils.customRender)(/*#__PURE__*/_react.default.createElement(_VirtualBusinessGrid.default, defaultProps));

    // Re-render with same props
    rerender(/*#__PURE__*/_react.default.createElement(_VirtualBusinessGrid.default, defaultProps));

    // Business cards should be memoized and not re-render unnecessarily
    expect(_testUtils.screen.getByTestId('business-card-0')).toBeInTheDocument();
  });
  it('handles business selection with proper focus management', async () => {
    (0, _testUtils.customRender)(/*#__PURE__*/_react.default.createElement(_VirtualBusinessGrid.default, defaultProps));
    await (0, _testUtils.waitFor)(() => {
      const firstBusinessCard = _testUtils.screen.getByTestId('business-card-0');
      firstBusinessCard.click();
    });
    expect(defaultProps.onBusinessSelect).toHaveBeenCalledWith(mockBusinesses[0]);
    // Focus should be managed properly
    expect(document.activeElement).toBeInTheDocument();
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl90ZXN0VXRpbHMiLCJfVmlydHVhbEJ1c2luZXNzR3JpZCIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIl9leHRlbmRzIiwiT2JqZWN0IiwiYXNzaWduIiwiYmluZCIsIm4iLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ0IiwiciIsImhhc093blByb3BlcnR5IiwiY2FsbCIsImFwcGx5IiwiYmVmb3JlQWxsIiwic2V0dXBUZXN0cyIsImRlc2NyaWJlIiwibW9ja0J1c2luZXNzZXMiLCJBcnJheSIsImZyb20iLCJfIiwiaSIsImNyZWF0ZU1vY2tCdXNpbmVzcyIsImlkIiwibmFtZSIsImRpc3RhbmNlIiwiZGVmYXVsdFByb3BzIiwiYnVzaW5lc3NlcyIsInNlbGVjdGVkQnVzaW5lc3MiLCJvbkJ1c2luZXNzU2VsZWN0IiwiamVzdCIsImZuIiwiYmVmb3JlRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJpdCIsImN1c3RvbVJlbmRlciIsImNyZWF0ZUVsZW1lbnQiLCJ3YWl0Rm9yIiwiYnVzaW5lc3NDYXJkcyIsInNjcmVlbiIsImdldEFsbEJ5VGVzdElkIiwiZXhwZWN0IiwidG9CZUdyZWF0ZXJUaGFuIiwidG9CZUxlc3NUaGFuIiwiZmlyc3RCdXNpbmVzc0NhcmQiLCJnZXRCeVRlc3RJZCIsImNsaWNrIiwidG9IYXZlQmVlbkNhbGxlZFdpdGgiLCJnZXRCeVRleHQiLCJ0b0JlSW5UaGVEb2N1bWVudCIsInJhdGluZ0VsZW1lbnQiLCJwcmljZUluZGljYXRvcnMiLCJ0b0JlIiwic2Nyb2xsQ29udGFpbmVyIiwiZmlyZUV2ZW50Iiwic2Nyb2xsIiwidGFyZ2V0Iiwic2Nyb2xsVG9wIiwiZm9yRWFjaCIsImNhcmQiLCJ0b0hhdmVBdHRyaWJ1dGUiLCJmb2N1cyIsImtleURvd24iLCJrZXkiLCJkZWZpbmVQcm9wZXJ0eSIsIndpbmRvdyIsInZhbHVlIiwid3JpdGFibGUiLCJncmlkIiwidG9IYXZlQ2xhc3MiLCJyZXJlbmRlciIsImRvY3VtZW50IiwiYWN0aXZlRWxlbWVudCJdLCJzb3VyY2VzIjpbIlZpcnR1YWxCdXNpbmVzc0dyaWQudGVzdC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHsgY3VzdG9tUmVuZGVyLCBzY3JlZW4sIHdhaXRGb3IsIGZpcmVFdmVudCwgY3JlYXRlTW9ja0J1c2luZXNzLCBzZXR1cFRlc3RzIH0gZnJvbSAnLi4vdGVzdFV0aWxzJztcclxuaW1wb3J0IFZpcnR1YWxCdXNpbmVzc0dyaWQgZnJvbSAnLi4vLi4vY29tcG9uZW50cy9jb21tb24vVmlydHVhbEJ1c2luZXNzR3JpZCc7XHJcblxyXG4vLyBTZXR1cCBtb2NrcyBiZWZvcmUgdGVzdHNcclxuYmVmb3JlQWxsKCgpID0+IHtcclxuICBzZXR1cFRlc3RzKCk7XHJcbn0pO1xyXG5cclxuZGVzY3JpYmUoJ1ZpcnR1YWxCdXNpbmVzc0dyaWQnLCAoKSA9PiB7XHJcbiAgY29uc3QgbW9ja0J1c2luZXNzZXMgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiAxMDAgfSwgKF8sIGkpID0+XHJcbiAgICBjcmVhdGVNb2NrQnVzaW5lc3Moe1xyXG4gICAgICBpZDogYGJ1c2luZXNzLSR7aX1gLFxyXG4gICAgICBuYW1lOiBgVGVzdCBCdXNpbmVzcyAke2l9YCxcclxuICAgICAgZGlzdGFuY2U6IGkgKiAxMDAsXHJcbiAgICB9KVxyXG4gICk7XHJcblxyXG4gIGNvbnN0IGRlZmF1bHRQcm9wcyA9IHtcclxuICAgIGJ1c2luZXNzZXM6IG1vY2tCdXNpbmVzc2VzLFxyXG4gICAgc2VsZWN0ZWRCdXNpbmVzczogbnVsbCxcclxuICAgIG9uQnVzaW5lc3NTZWxlY3Q6IGplc3QuZm4oKSxcclxuICB9O1xyXG5cclxuICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xyXG4gIH0pO1xyXG5cclxuICBpdCgncmVuZGVycyBidXNpbmVzcyBncmlkIHdpdGggY29ycmVjdCBudW1iZXIgb2YgdmlzaWJsZSBpdGVtcycsIGFzeW5jICgpID0+IHtcclxuICAgIGN1c3RvbVJlbmRlcig8VmlydHVhbEJ1c2luZXNzR3JpZCB7Li4uZGVmYXVsdFByb3BzfSAvPik7XHJcblxyXG4gICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XHJcbiAgICAgIC8vIFNob3VsZCByZW5kZXIgYSBzdWJzZXQgb2YgYnVzaW5lc3NlcyAobm90IGFsbCAxMDApXHJcbiAgICAgIGNvbnN0IGJ1c2luZXNzQ2FyZHMgPSBzY3JlZW4uZ2V0QWxsQnlUZXN0SWQoL15idXNpbmVzcy1jYXJkLS8pO1xyXG4gICAgICBleHBlY3QoYnVzaW5lc3NDYXJkcy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcclxuICAgICAgZXhwZWN0KGJ1c2luZXNzQ2FyZHMubGVuZ3RoKS50b0JlTGVzc1RoYW4oMTAwKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBpdCgnY2FsbHMgb25CdXNpbmVzc1NlbGVjdCB3aGVuIGJ1c2luZXNzIGlzIGNsaWNrZWQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICBjdXN0b21SZW5kZXIoPFZpcnR1YWxCdXNpbmVzc0dyaWQgey4uLmRlZmF1bHRQcm9wc30gLz4pO1xyXG5cclxuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xyXG4gICAgICBjb25zdCBmaXJzdEJ1c2luZXNzQ2FyZCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnYnVzaW5lc3MtY2FyZC0wJyk7XHJcbiAgICAgIGZpcnN0QnVzaW5lc3NDYXJkLmNsaWNrKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBleHBlY3QoZGVmYXVsdFByb3BzLm9uQnVzaW5lc3NTZWxlY3QpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKG1vY2tCdXNpbmVzc2VzWzBdKTtcclxuICB9KTtcclxuXHJcbiAgaXQoJ3JlbmRlcnMgYnVzaW5lc3MgaW5mb3JtYXRpb24gY29ycmVjdGx5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgY3VzdG9tUmVuZGVyKDxWaXJ0dWFsQnVzaW5lc3NHcmlkIHsuLi5kZWZhdWx0UHJvcHN9IC8+KTtcclxuXHJcbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcclxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoJ1Rlc3QgQnVzaW5lc3MgMCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnVGVzdCBSZXN0YXVyYW50JykpLnRvQmVJblRoZURvY3VtZW50KCk7XHJcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCcxMjMgVGVzdCBTdCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGl0KCdkaXNwbGF5cyBkaXN0YW5jZSBpbmZvcm1hdGlvbicsIGFzeW5jICgpID0+IHtcclxuICAgIGN1c3RvbVJlbmRlcig8VmlydHVhbEJ1c2luZXNzR3JpZCB7Li4uZGVmYXVsdFByb3BzfSAvPik7XHJcblxyXG4gICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XHJcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCcxLjAga20nKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBpdCgnc2hvd3MgcmF0aW5nIHdpdGggc3RhcnMnLCBhc3luYyAoKSA9PiB7XHJcbiAgICBjdXN0b21SZW5kZXIoPFZpcnR1YWxCdXNpbmVzc0dyaWQgey4uLmRlZmF1bHRQcm9wc30gLz4pO1xyXG5cclxuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xyXG4gICAgICBjb25zdCByYXRpbmdFbGVtZW50ID0gc2NyZWVuLmdldEJ5VGVzdElkKCdyYXRpbmctNC41Jyk7XHJcbiAgICAgIGV4cGVjdChyYXRpbmdFbGVtZW50KS50b0JlSW5UaGVEb2N1bWVudCgpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGl0KCdkaXNwbGF5cyBwcmljZSBsZXZlbCBpbmRpY2F0b3JzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgY3VzdG9tUmVuZGVyKDxWaXJ0dWFsQnVzaW5lc3NHcmlkIHsuLi5kZWZhdWx0UHJvcHN9IC8+KTtcclxuXHJcbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcclxuICAgICAgY29uc3QgcHJpY2VJbmRpY2F0b3JzID0gc2NyZWVuLmdldEFsbEJ5VGVzdElkKCdwcmljZS1pbmRpY2F0b3InKTtcclxuICAgICAgZXhwZWN0KHByaWNlSW5kaWNhdG9ycy5sZW5ndGgpLnRvQmUoMik7IC8vICQkIGZvciBwcmljZV9sZXZlbCAyXHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgaXQoJ2hhbmRsZXMgZW1wdHkgYnVzaW5lc3NlcyBhcnJheScsICgpID0+IHtcclxuICAgIGN1c3RvbVJlbmRlcig8VmlydHVhbEJ1c2luZXNzR3JpZCB7Li4uZGVmYXVsdFByb3BzfSBidXNpbmVzc2VzPXtbXX0gLz4pO1xyXG5cclxuICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KCdObyBidXNpbmVzc2VzIGZvdW5kJykpLnRvQmVJblRoZURvY3VtZW50KCk7XHJcbiAgfSk7XHJcblxyXG4gIGl0KCdjYWxscyBvbkxvYWRNb3JlIHdoZW4gc2Nyb2xsaW5nIHRvIGJvdHRvbScsIGFzeW5jICgpID0+IHtcclxuICAgIGN1c3RvbVJlbmRlcig8VmlydHVhbEJ1c2luZXNzR3JpZCB7Li4uZGVmYXVsdFByb3BzfSAvPik7XHJcblxyXG4gICAgLy8gU2ltdWxhdGUgc2Nyb2xsIHRvIGJvdHRvbVxyXG4gICAgY29uc3Qgc2Nyb2xsQ29udGFpbmVyID0gc2NyZWVuLmdldEJ5VGVzdElkKCd2aXJ0dWFsLWdyaWQtY29udGFpbmVyJyk7XHJcbiAgICBmaXJlRXZlbnQuc2Nyb2xsKHNjcm9sbENvbnRhaW5lciwgeyB0YXJnZXQ6IHsgc2Nyb2xsVG9wOiAxMDAwIH0gfSk7XHJcblxyXG4gICAgLy8gVGhlIGNvbXBvbmVudCBoYW5kbGVzIHNjcm9sbGluZyBpbnRlcm5hbGx5LCBubyBleHRlcm5hbCBvbkxvYWRNb3JlIGNhbGxiYWNrXHJcbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcclxuICAgICAgZXhwZWN0KHNjcm9sbENvbnRhaW5lcikudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBpdCgnaXMgYWNjZXNzaWJsZSB3aXRoIHByb3BlciBBUklBIGxhYmVscycsIGFzeW5jICgpID0+IHtcclxuICAgIGN1c3RvbVJlbmRlcig8VmlydHVhbEJ1c2luZXNzR3JpZCB7Li4uZGVmYXVsdFByb3BzfSAvPik7XHJcblxyXG4gICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGJ1c2luZXNzQ2FyZHMgPSBzY3JlZW4uZ2V0QWxsQnlUZXN0SWQoL15idXNpbmVzcy1jYXJkLS8pO1xyXG4gICAgICBidXNpbmVzc0NhcmRzLmZvckVhY2goY2FyZCA9PiB7XHJcbiAgICAgICAgZXhwZWN0KGNhcmQpLnRvSGF2ZUF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcpO1xyXG4gICAgICAgIGV4cGVjdChjYXJkKS50b0hhdmVBdHRyaWJ1dGUoJ3JvbGUnLCAnYnV0dG9uJyk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGl0KCdoYW5kbGVzIGtleWJvYXJkIG5hdmlnYXRpb24nLCBhc3luYyAoKSA9PiB7XHJcbiAgICBjdXN0b21SZW5kZXIoPFZpcnR1YWxCdXNpbmVzc0dyaWQgey4uLmRlZmF1bHRQcm9wc30gLz4pO1xyXG5cclxuICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xyXG4gICAgICBjb25zdCBmaXJzdEJ1c2luZXNzQ2FyZCA9IHNjcmVlbi5nZXRCeVRlc3RJZCgnYnVzaW5lc3MtY2FyZC0wJyk7XHJcbiAgICAgIGZpcnN0QnVzaW5lc3NDYXJkLmZvY3VzKCk7XHJcbiAgICAgIGZpcmVFdmVudC5rZXlEb3duKGZpcnN0QnVzaW5lc3NDYXJkLCB7IGtleTogJ0VudGVyJyB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGV4cGVjdChkZWZhdWx0UHJvcHMub25CdXNpbmVzc1NlbGVjdCkudG9IYXZlQmVlbkNhbGxlZFdpdGgobW9ja0J1c2luZXNzZXNbMF0pO1xyXG4gIH0pO1xyXG5cclxuICBpdCgncmVuZGVycyB3aXRoIHJlc3BvbnNpdmUgY29sdW1ucycsICgpID0+IHtcclxuICAgIC8vIE1vY2sgZGlmZmVyZW50IHNjcmVlbiBzaXplc1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdywgJ2lubmVyV2lkdGgnLCB7IHZhbHVlOiA3NjgsIHdyaXRhYmxlOiB0cnVlIH0pO1xyXG5cclxuICAgIGN1c3RvbVJlbmRlcig8VmlydHVhbEJ1c2luZXNzR3JpZCB7Li4uZGVmYXVsdFByb3BzfSAvPik7XHJcblxyXG4gICAgLy8gU2hvdWxkIGFkanVzdCBjb2x1bW5zIGJhc2VkIG9uIHNjcmVlbiBzaXplXHJcbiAgICBjb25zdCBncmlkID0gc2NyZWVuLmdldEJ5VGVzdElkKCd2aXJ0dWFsLWdyaWQtY29udGFpbmVyJyk7XHJcbiAgICBleHBlY3QoZ3JpZCkudG9IYXZlQ2xhc3MoJ2dyaWQtY29scy0yJyk7IC8vIG1kOmdyaWQtY29scy0yXHJcbiAgfSk7XHJcblxyXG4gIGl0KCdtZW1vaXplcyBidXNpbmVzcyBjYXJkcyBmb3IgcGVyZm9ybWFuY2UnLCAoKSA9PiB7XHJcbiAgICBjb25zdCB7IHJlcmVuZGVyIH0gPSBjdXN0b21SZW5kZXIoPFZpcnR1YWxCdXNpbmVzc0dyaWQgey4uLmRlZmF1bHRQcm9wc30gLz4pO1xyXG5cclxuICAgIC8vIFJlLXJlbmRlciB3aXRoIHNhbWUgcHJvcHNcclxuICAgIHJlcmVuZGVyKDxWaXJ0dWFsQnVzaW5lc3NHcmlkIHsuLi5kZWZhdWx0UHJvcHN9IC8+KTtcclxuXHJcbiAgICAvLyBCdXNpbmVzcyBjYXJkcyBzaG91bGQgYmUgbWVtb2l6ZWQgYW5kIG5vdCByZS1yZW5kZXIgdW5uZWNlc3NhcmlseVxyXG4gICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZCgnYnVzaW5lc3MtY2FyZC0wJykpLnRvQmVJblRoZURvY3VtZW50KCk7XHJcbiAgfSk7XHJcblxyXG4gIGl0KCdoYW5kbGVzIGJ1c2luZXNzIHNlbGVjdGlvbiB3aXRoIHByb3BlciBmb2N1cyBtYW5hZ2VtZW50JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgY3VzdG9tUmVuZGVyKDxWaXJ0dWFsQnVzaW5lc3NHcmlkIHsuLi5kZWZhdWx0UHJvcHN9IC8+KTtcclxuXHJcbiAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcclxuICAgICAgY29uc3QgZmlyc3RCdXNpbmVzc0NhcmQgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ2J1c2luZXNzLWNhcmQtMCcpO1xyXG4gICAgICBmaXJzdEJ1c2luZXNzQ2FyZC5jbGljaygpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZXhwZWN0KGRlZmF1bHRQcm9wcy5vbkJ1c2luZXNzU2VsZWN0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChtb2NrQnVzaW5lc3Nlc1swXSk7XHJcbiAgICAvLyBGb2N1cyBzaG91bGQgYmUgbWFuYWdlZCBwcm9wZXJseVxyXG4gICAgZXhwZWN0KGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpLnRvQmVJblRoZURvY3VtZW50KCk7XHJcbiAgfSk7XHJcbn0pO1xyXG4iXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBQUEsTUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsVUFBQSxHQUFBRCxPQUFBO0FBQ0EsSUFBQUUsb0JBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUE4RSxTQUFBRCx1QkFBQUksQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUFBLFNBQUFHLFNBQUEsV0FBQUEsUUFBQSxHQUFBQyxNQUFBLENBQUFDLE1BQUEsR0FBQUQsTUFBQSxDQUFBQyxNQUFBLENBQUFDLElBQUEsZUFBQUMsQ0FBQSxhQUFBUCxDQUFBLE1BQUFBLENBQUEsR0FBQVEsU0FBQSxDQUFBQyxN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RTtNQUFFQyxLQUFLLEVBQUUsR0FBRztNQUFFQyxRQUFRLEVBQUU7SUFBSyxDQUFDLENBQUM7SUFFM0UsSUFBQWhDLHVCQUFZLGVBQUN6QyxNQUFBLENBQUFPLE9BQUEsQ0FBQW1DLGFBQUEsQ0FBQ3RDLG9CQUFBLENBQUFHLE9BQW1CLEVBQUt5QixZQUFlLENBQUMsQ0FBQzs7SUFFdkQ7SUFDQSxNQUFNMEMsSUFBSSxHQUFHN0IsaUJBQU0sQ0FBQ00sV0FBVyxDQUFDLHdCQUF3QixDQUFDO0lBQ3pESixNQUFNLENBQUMyQixJQUFJLENBQUMsQ0FBQ0MsV0FBVyxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUM7RUFDM0MsQ0FBQyxDQUFDO0VBRUZuQyxFQUFFLENBQUMseUNBQXlDLEVBQUUsTUFBTTtJQUNsRCxNQUFNO01BQUVvQztJQUFTLENBQUMsR0FBRyxJQUFBbkMsdUJBQVksZUFBQ3pDLE1BQUEsQ0FBQU8sT0FBQSxDQUFBbUMsYUFBQSxDQUFDdEMsb0JBQUEsQ0FBQUcsT0FBbUIsRUFBS3lCLFlBQWUsQ0FBQyxDQUFDOztJQUU1RTtJQUNBNEMsUUFBUSxjQUFDNUUsTUFBQSxDQUFBTyxPQUFBLENBQUFtQyxhQUFBLENBQUN0QyxvQkFBQSxDQUFBRyxPQUFtQixFQUFLeUIsWUFBZSxDQUFDLENBQUM7O0lBRW5EO0lBQ0FlLE1BQU0sQ0FBQ0YsaUJBQU0sQ0FBQ00sV0FBVyxDQUFDLGlCQUFpQixDQUFDLENBQUMsQ0FBQ0ksaUJBQWlCLENBQUMsQ0FBQztFQUNuRSxDQUFDLENBQUM7RUFFRmYsRUFBRSxDQUFDLHlEQUF5RCxFQUFFLFlBQVk7SUFDeEUsSUFBQUMsdUJBQVksZUFBQ3pDLE1BQUEsQ0FBQU8sT0FBQSxDQUFBbUMsYUFBQSxDQUFDdEMsb0JBQUEsQ0FBQUcsT0FBbUIsRUFBS3lCLFlBQWUsQ0FBQyxDQUFDO0lBRXZELE1BQU0sSUFBQVcsa0JBQU8sRUFBQyxNQUFNO01BQ2xCLE1BQU1PLGlCQUFpQixHQUFHTCxpQkFBTSxDQUFDTSxXQUFXLENBQUMsaUJBQWlCLENBQUM7TUFDL0RELGlCQUFpQixDQUFDRSxLQUFLLENBQUMsQ0FBQztJQUMzQixDQUFDLENBQUM7SUFFRkwsTUFBTSxDQUFDZixZQUFZLENBQUNHLGdCQUFnQixDQUFDLENBQUNrQixvQkFBb0IsQ0FBQzlCLGNBQWMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUM3RTtJQUNBd0IsTUFBTSxDQUFDOEIsUUFBUSxDQUFDQyxhQUFhLENBQUMsQ0FBQ3ZCLGlCQUFpQixDQUFDLENBQUM7RUFDcEQsQ0FBQyxDQUFDO0FBQ0osQ0FBQyxDQUFDIiwiaWdub3JlTGlzdCI6W119