c04cedd4230957f84164ae095f48a9b5
"use strict";

exports.__esModule = true;
exports.warmupCache = exports.getCacheMetrics = exports.apiCache = exports.advancedApiCache = void 0;
// Advanced Redis-like in-memory cache with LRU eviction, persistence, and advanced features

class AdvancedAPICache {
  cache = new Map();
  pendingRequests = new Map();
  stats = {
    hits: 0,
    misses: 0,
    evictions: 0,
    sets: 0,
    deletes: 0,
    size: 0,
    itemCount: 0
  };
  config = {
    maxSize: 50 * 1024 * 1024,
    // 50MB default
    defaultTTL: 5 * 60 * 1000,
    // 5 minutes
    enablePersistence: true,
    persistenceKey: 'api-cache-persistence',
    enableCompression: false,
    lruEnabled: true
  };
  constructor(config) {
    if (config) {
      this.config = {
        ...this.config,
        ...config
      };
    }

    // Load persisted cache on initialization
    if (this.config.enablePersistence && typeof window !== 'undefined') {
      this.loadPersistedCache();
    }

    // Set up periodic cleanup and persistence
    if (typeof global !== 'undefined') {
      setInterval(() => {
        this.cleanup();
        if (this.config.enablePersistence) {
          this.persistCache();
        }
      }, 60000); // Every minute
    }
  }

  // Generate cache key from request parameters with advanced hashing
  generateKey(params, prefix = 'api') {
    const sortedParams = Object.keys(params).sort().reduce((result, key) => {
      result[key] = params[key];
      return result;
    }, {});
    const paramString = JSON.stringify(sortedParams);
    return `${prefix}:${this.simpleHash(paramString)}`;
  }

  // Simple hash function for cache keys
  simpleHash(str) {
    let hash = 0;
    for (let i = 0; i < str.length; i++) {
      const char = str.charCodeAt(i);
      hash = (hash << 5) - hash + char;
      hash = hash & hash; // Convert to 32-bit integer
    }
    return Math.abs(hash).toString(36);
  }

  // Estimate size of data in bytes
  estimateSize(data) {
    const str = JSON.stringify(data);
    return str ? str.length : 0; // Rough estimate: 1 byte per character
  }

  // Get cached data with LRU tracking
  get(key) {
    const entry = this.cache.get(key);
    if (!entry) {
      this.stats.misses++;
      return null;
    }
    const now = Date.now();
    if (now - entry.timestamp >= entry.ttl) {
      this.cache.delete(key);
      this.stats.size -= entry.size;
      this.stats.itemCount--;
      this.stats.misses++;
      return null;
    }

    // Update LRU tracking
    entry.accessCount++;
    entry.lastAccessed = now;
    this.stats.hits++;
    return entry.data;
  }

  // Set cache entry with advanced features
  set(key, data, options = {}) {
    const ttl = options.ttl || this.config.defaultTTL;
    const size = this.estimateSize(data);
    const now = Date.now();

    // Check if we need to evict entries to make room
    if (this.stats.size + size > this.config.maxSize) {
      const requiredSpace = this.stats.size + size - this.config.maxSize;
      this.evictLRU(requiredSpace);
    }
    const entry = {
      data,
      timestamp: now,
      ttl,
      accessCount: 0,
      lastAccessed: now,
      size,
      tags: options.tags
    };

    // Remove old entry if it exists
    const oldEntry = this.cache.get(key);
    if (oldEntry) {
      this.stats.size -= oldEntry.size;
      this.stats.itemCount--;
    }
    this.cache.set(key, entry);
    this.stats.size += size;
    this.stats.itemCount++;
    this.stats.sets++;
  }

  // LRU eviction
  evictLRU(requiredSpace) {
    if (!this.config.lruEnabled) return;
    const entries = Array.from(this.cache.entries()).sort(([, a], [, b]) => {
      // Sort by access count, then by last accessed time
      if (a.accessCount !== b.accessCount) {
        return a.accessCount - b.accessCount;
      }
      return a.lastAccessed - b.lastAccessed;
    });
    let freedSpace = 0;
    for (const [key, entry] of entries) {
      if (freedSpace >= requiredSpace) break;
      this.cache.delete(key);
      this.stats.size -= entry.size;
      this.stats.itemCount--;
      this.stats.evictions++;
      freedSpace += entry.size;
    }
  }

  // Delete cache entry
  delete(key) {
    const entry = this.cache.get(key);
    if (entry) {
      this.cache.delete(key);
      this.stats.size -= entry.size;
      this.stats.itemCount--;
      this.stats.deletes++;
      return true;
    }
    return false;
  }

  // Clear cache by tags
  clearByTags(tags) {
    let cleared = 0;
    for (const [key, entry] of this.cache.entries()) {
      if (entry.tags && entry.tags.some(tag => tags.includes(tag))) {
        this.cache.delete(key);
        this.stats.size -= entry.size;
        this.stats.itemCount--;
        this.stats.deletes++;
        cleared++;
      }
    }
    return cleared;
  }

  // Clear all cache
  clear() {
    this.cache.clear();
    this.stats.size = 0;
    this.stats.itemCount = 0;
    this.stats.deletes += this.stats.itemCount;
  }

  // Handle request deduplication with enhanced error handling
  async dedupe(key, requestFn, options = {}) {
    // Check cache first if enabled
    if (options.useCache !== false) {
      const cached = this.get(key);
      if (cached !== null) {
        return cached;
      }
    }

    // Check if request is already pending
    const pending = this.pendingRequests.get(key);
    if (pending) {
      return pending;
    }

    // Execute request and cache the promise
    const promise = requestFn().then(result => {
      // Cache successful results
      if (options.useCache !== false) {
        this.set(key, result, {
          ttl: options.ttl,
          tags: options.tags
        });
      }
      return result;
    }).finally(() => {
      this.pendingRequests.delete(key);
    });
    this.pendingRequests.set(key, promise);
    return promise;
  }

  // Get cache statistics
  getStats() {
    return {
      ...this.stats
    };
  }

  // Get cache hit rate
  getHitRate() {
    const total = this.stats.hits + this.stats.misses;
    return total > 0 ? this.stats.hits / total : 0;
  }

  // Cleanup expired entries
  cleanup() {
    const now = Date.now();
    for (const [key, entry] of this.cache.entries()) {
      if (now - entry.timestamp > entry.ttl) {
        this.cache.delete(key);
        this.stats.size -= entry.size;
        this.stats.itemCount--;
      }
    }
  }

  // Persist cache to localStorage
  persistCache() {
    if (typeof window === 'undefined' || !window.localStorage) return;
    try {
      const persistableData = Array.from(this.cache.entries()).filter(([, entry]) => {
        // Only persist entries that haven't expired and aren't too large
        const now = Date.now();
        return now - entry.timestamp < entry.ttl && entry.size < 1024 * 1024; // < 1MB
      }).map(([key, entry]) => [key, {
        data: entry.data,
        timestamp: entry.timestamp,
        ttl: entry.ttl,
        accessCount: entry.accessCount,
        lastAccessed: entry.lastAccessed,
        size: entry.size,
        tags: entry.tags
      }]);
      localStorage.setItem(this.config.persistenceKey, JSON.stringify({
        data: persistableData,
        timestamp: Date.now()
      }));
    } catch (error) {
      console.warn('Failed to persist cache:', error);
    }
  }

  // Load persisted cache from localStorage
  loadPersistedCache() {
    if (typeof window === 'undefined' || !window.localStorage) return;
    try {
      const persisted = localStorage.getItem(this.config.persistenceKey);
      if (!persisted) return;
      const {
        data,
        timestamp
      } = JSON.parse(persisted);
      const now = Date.now();

      // Only load if persisted within last 24 hours
      if (now - timestamp > 24 * 60 * 60 * 1000) {
        localStorage.removeItem(this.config.persistenceKey);
        return;
      }
      for (const [key, entry] of data) {
        // Check if entry is still valid
        if (now - entry.timestamp < entry.ttl) {
          this.cache.set(key, entry);
          this.stats.size += entry.size;
          this.stats.itemCount++;
        }
      }
      console.log(`Loaded ${this.stats.itemCount} persisted cache entries`);
    } catch (error) {
      console.warn('Failed to load persisted cache:', error);
      localStorage.removeItem(this.config.persistenceKey);
    }
  }

  // Warm up cache with frequently accessed data
  async warmup(keys) {
    const warmupPromises = keys.map(async key => {
      // This would typically fetch from a fast source or pre-computed data
      // For now, just ensure the key exists in cache
      return this.cache.has(key);
    });
    await Promise.all(warmupPromises);
  }
}

// Global advanced cache instance with optimized settings
const advancedApiCache = exports.advancedApiCache = new AdvancedAPICache({
  maxSize: 100 * 1024 * 1024,
  // 100MB for better performance
  defaultTTL: 10 * 60 * 1000,
  // 10 minutes for better cache hit rates
  enablePersistence: true,
  persistenceKey: 'points-companion-cache-v2',
  enableCompression: false,
  // Can be enabled later with compression library
  lruEnabled: true
});

// Legacy cache instance for backward compatibility
const apiCache = exports.apiCache = advancedApiCache;

// Cache warming utility
const warmupCache = async frequentlyUsedKeys => {
  await advancedApiCache.warmup(frequentlyUsedKeys);
};

// Cache monitoring utility
exports.warmupCache = warmupCache;
const getCacheMetrics = () => {
  const stats = advancedApiCache.getStats();
  const hitRate = advancedApiCache.getHitRate();
  return {
    ...stats,
    hitRate: `${(hitRate * 100).toFixed(2)}%`,
    sizeFormatted: `${(stats.size / 1024 / 1024).toFixed(2)}MB`,
    efficiency: hitRate > 0.8 ? 'Excellent' : hitRate > 0.6 ? 'Good' : 'Needs Optimization'
  };
};
exports.getCacheMetrics = getCacheMetrics;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJBZHZhbmNlZEFQSUNhY2hlIiwiY2FjaGUiLCJNYXAiLCJwZW5kaW5nUmVxdWVzdHMiLCJzdGF0cyIsImhpdHMiLCJtaXNzZXMiLCJldmljdGlvbnMiLCJzZXRzIiwiZGVsZXRlcyIsInNpemUiLCJpdGVtQ291bnQiLCJjb25maWciLCJtYXhTaXplIiwiZGVmYXVsdFRUTCIsImVuYWJsZVBlcnNpc3RlbmNlIiwicGVyc2lzdGVuY2VLZXkiLCJlbmFibGVDb21wcmVzc2lvbiIsImxydUVuYWJsZWQiLCJjb25zdHJ1Y3RvciIsIndpbmRvdyIsImxvYWRQZXJzaXN0ZWRDYWNoZSIsImdsb2JhbCIsInNldEludGVydmFsIiwiY2xlYW51cCIsInBlcnNpc3RDYWNoZSIsImdlbmVyYXRlS2V5IiwicGFyYW1zIiwicHJlZml4Iiwic29ydGVkUGFyYW1zIiwiT2JqZWN0Iiwia2V5cyIsInNvcnQiLCJyZWR1Y2UiLCJyZXN1bHQiLCJrZXkiLCJwYXJhbVN0cmluZyIsIkpTT04iLCJzdHJpbmdpZnkiLCJzaW1wbGVIYXNoIiwic3RyIiwiaGFzaCIsImkiLCJsZW5ndGgiLCJjaGFyIiwiY2hhckNvZGVBdCIsIk1hdGgiLCJhYnMiLCJ0b1N0cmluZyIsImVzdGltYXRlU2l6ZSIsImRhdGEiLCJnZXQiLCJlbnRyeSIsIm5vdyIsIkRhdGUiLCJ0aW1lc3RhbXAiLCJ0dGwiLCJkZWxldGUiLCJhY2Nlc3NDb3VudCIsImxhc3RBY2Nlc3NlZCIsInNldCIsIm9wdGlvbnMiLCJyZXF1aXJlZFNwYWNlIiwiZXZpY3RMUlUiLCJ0YWdzIiwib2xkRW50cnkiLCJlbnRyaWVzIiwiQXJyYXkiLCJmcm9tIiwiYSIsImIiLCJmcmVlZFNwYWNlIiwiY2xlYXJCeVRhZ3MiLCJjbGVhcmVkIiwic29tZSIsInRhZyIsImluY2x1ZGVzIiwiY2xlYXIiLCJkZWR1cGUiLCJyZXF1ZXN0Rm4iLCJ1c2VDYWNoZSIsImNhY2hlZCIsInBlbmRpbmciLCJwcm9taXNlIiwidGhlbiIsImZpbmFsbHkiLCJnZXRTdGF0cyIsImdldEhpdFJhdGUiLCJ0b3RhbCIsImxvY2FsU3RvcmFnZSIsInBlcnNpc3RhYmxlRGF0YSIsImZpbHRlciIsIm1hcCIsInNldEl0ZW0iLCJlcnJvciIsImNvbnNvbGUiLCJ3YXJuIiwicGVyc2lzdGVkIiwiZ2V0SXRlbSIsInBhcnNlIiwicmVtb3ZlSXRlbSIsImxvZyIsIndhcm11cCIsIndhcm11cFByb21pc2VzIiwiaGFzIiwiUHJvbWlzZSIsImFsbCIsImFkdmFuY2VkQXBpQ2FjaGUiLCJleHBvcnRzIiwiYXBpQ2FjaGUiLCJ3YXJtdXBDYWNoZSIsImZyZXF1ZW50bHlVc2VkS2V5cyIsImdldENhY2hlTWV0cmljcyIsImhpdFJhdGUiLCJ0b0ZpeGVkIiwic2l6ZUZvcm1hdHRlZCIsImVmZmljaWVuY3kiXSwic291cmNlcyI6WyJhcGlDYWNoZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBBZHZhbmNlZCBSZWRpcy1saWtlIGluLW1lbW9yeSBjYWNoZSB3aXRoIExSVSBldmljdGlvbiwgcGVyc2lzdGVuY2UsIGFuZCBhZHZhbmNlZCBmZWF0dXJlc1xyXG5pbnRlcmZhY2UgQ2FjaGVFbnRyeTxUID0gdW5rbm93bj4ge1xyXG4gIGRhdGE6IFQ7XHJcbiAgdGltZXN0YW1wOiBudW1iZXI7XHJcbiAgdHRsOiBudW1iZXI7XHJcbiAgYWNjZXNzQ291bnQ6IG51bWJlcjtcclxuICBsYXN0QWNjZXNzZWQ6IG51bWJlcjtcclxuICBzaXplOiBudW1iZXI7IC8vIEVzdGltYXRlZCBzaXplIGluIGJ5dGVzXHJcbiAgdGFncz86IHN0cmluZ1tdOyAvLyBGb3IgY2FjaGUgaW52YWxpZGF0aW9uIGJ5IHRhZ3NcclxufVxyXG5cclxuaW50ZXJmYWNlIENhY2hlU3RhdHMge1xyXG4gIGhpdHM6IG51bWJlcjtcclxuICBtaXNzZXM6IG51bWJlcjtcclxuICBldmljdGlvbnM6IG51bWJlcjtcclxuICBzZXRzOiBudW1iZXI7XHJcbiAgZGVsZXRlczogbnVtYmVyO1xyXG4gIHNpemU6IG51bWJlcjsgLy8gVG90YWwgY2FjaGUgc2l6ZSBpbiBieXRlc1xyXG4gIGl0ZW1Db3VudDogbnVtYmVyO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgQ2FjaGVDb25maWcge1xyXG4gIG1heFNpemU6IG51bWJlcjsgLy8gTWF4aW11bSBjYWNoZSBzaXplIGluIGJ5dGVzXHJcbiAgZGVmYXVsdFRUTDogbnVtYmVyOyAvLyBEZWZhdWx0IFRUTCBpbiBtaWxsaXNlY29uZHNcclxuICBlbmFibGVQZXJzaXN0ZW5jZTogYm9vbGVhbjtcclxuICBwZXJzaXN0ZW5jZUtleTogc3RyaW5nO1xyXG4gIGVuYWJsZUNvbXByZXNzaW9uOiBib29sZWFuO1xyXG4gIGxydUVuYWJsZWQ6IGJvb2xlYW47XHJcbn1cclxuXHJcbmNsYXNzIEFkdmFuY2VkQVBJQ2FjaGUge1xyXG4gIHByaXZhdGUgY2FjaGUgPSBuZXcgTWFwPHN0cmluZywgQ2FjaGVFbnRyeT4oKTtcclxuICBwcml2YXRlIHBlbmRpbmdSZXF1ZXN0cyA9IG5ldyBNYXA8c3RyaW5nLCBQcm9taXNlPHVua25vd24+PigpO1xyXG4gIHByaXZhdGUgc3RhdHM6IENhY2hlU3RhdHMgPSB7XHJcbiAgICBoaXRzOiAwLFxyXG4gICAgbWlzc2VzOiAwLFxyXG4gICAgZXZpY3Rpb25zOiAwLFxyXG4gICAgc2V0czogMCxcclxuICAgIGRlbGV0ZXM6IDAsXHJcbiAgICBzaXplOiAwLFxyXG4gICAgaXRlbUNvdW50OiAwXHJcbiAgfTtcclxuXHJcbiAgcHJpdmF0ZSBjb25maWc6IENhY2hlQ29uZmlnID0ge1xyXG4gICAgbWF4U2l6ZTogNTAgKiAxMDI0ICogMTAyNCwgLy8gNTBNQiBkZWZhdWx0XHJcbiAgICBkZWZhdWx0VFRMOiA1ICogNjAgKiAxMDAwLCAvLyA1IG1pbnV0ZXNcclxuICAgIGVuYWJsZVBlcnNpc3RlbmNlOiB0cnVlLFxyXG4gICAgcGVyc2lzdGVuY2VLZXk6ICdhcGktY2FjaGUtcGVyc2lzdGVuY2UnLFxyXG4gICAgZW5hYmxlQ29tcHJlc3Npb246IGZhbHNlLFxyXG4gICAgbHJ1RW5hYmxlZDogdHJ1ZVxyXG4gIH07XHJcblxyXG4gIGNvbnN0cnVjdG9yKGNvbmZpZz86IFBhcnRpYWw8Q2FjaGVDb25maWc+KSB7XHJcbiAgICBpZiAoY29uZmlnKSB7XHJcbiAgICAgIHRoaXMuY29uZmlnID0geyAuLi50aGlzLmNvbmZpZywgLi4uY29uZmlnIH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gTG9hZCBwZXJzaXN0ZWQgY2FjaGUgb24gaW5pdGlhbGl6YXRpb25cclxuICAgIGlmICh0aGlzLmNvbmZpZy5lbmFibGVQZXJzaXN0ZW5jZSAmJiB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICB0aGlzLmxvYWRQZXJzaXN0ZWRDYWNoZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFNldCB1cCBwZXJpb2RpYyBjbGVhbnVwIGFuZCBwZXJzaXN0ZW5jZVxyXG4gICAgaWYgKHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgIHNldEludGVydmFsKCgpID0+IHtcclxuICAgICAgICB0aGlzLmNsZWFudXAoKTtcclxuICAgICAgICBpZiAodGhpcy5jb25maWcuZW5hYmxlUGVyc2lzdGVuY2UpIHtcclxuICAgICAgICAgIHRoaXMucGVyc2lzdENhY2hlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LCA2MDAwMCk7IC8vIEV2ZXJ5IG1pbnV0ZVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gR2VuZXJhdGUgY2FjaGUga2V5IGZyb20gcmVxdWVzdCBwYXJhbWV0ZXJzIHdpdGggYWR2YW5jZWQgaGFzaGluZ1xyXG4gIGdlbmVyYXRlS2V5KHBhcmFtczogUmVjb3JkPHN0cmluZywgdW5rbm93bj4sIHByZWZpeCA9ICdhcGknKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IHNvcnRlZFBhcmFtcyA9IE9iamVjdC5rZXlzKHBhcmFtcylcclxuICAgICAgLnNvcnQoKVxyXG4gICAgICAucmVkdWNlKChyZXN1bHQsIGtleSkgPT4ge1xyXG4gICAgICAgIHJlc3VsdFtrZXldID0gcGFyYW1zW2tleV07XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgfSwge30gYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4pO1xyXG5cclxuICAgIGNvbnN0IHBhcmFtU3RyaW5nID0gSlNPTi5zdHJpbmdpZnkoc29ydGVkUGFyYW1zKTtcclxuICAgIHJldHVybiBgJHtwcmVmaXh9OiR7dGhpcy5zaW1wbGVIYXNoKHBhcmFtU3RyaW5nKX1gO1xyXG4gIH1cclxuXHJcbiAgLy8gU2ltcGxlIGhhc2ggZnVuY3Rpb24gZm9yIGNhY2hlIGtleXNcclxuICBwcml2YXRlIHNpbXBsZUhhc2goc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgbGV0IGhhc2ggPSAwO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgY29uc3QgY2hhciA9IHN0ci5jaGFyQ29kZUF0KGkpO1xyXG4gICAgICBoYXNoID0gKChoYXNoIDw8IDUpIC0gaGFzaCkgKyBjaGFyO1xyXG4gICAgICBoYXNoID0gaGFzaCAmIGhhc2g7IC8vIENvbnZlcnQgdG8gMzItYml0IGludGVnZXJcclxuICAgIH1cclxuICAgIHJldHVybiBNYXRoLmFicyhoYXNoKS50b1N0cmluZygzNik7XHJcbiAgfVxyXG5cclxuICAvLyBFc3RpbWF0ZSBzaXplIG9mIGRhdGEgaW4gYnl0ZXNcclxuICBwcml2YXRlIGVzdGltYXRlU2l6ZShkYXRhOiB1bmtub3duKTogbnVtYmVyIHtcclxuICAgIGNvbnN0IHN0ciA9IEpTT04uc3RyaW5naWZ5KGRhdGEpO1xyXG4gICAgcmV0dXJuIHN0ciA/IHN0ci5sZW5ndGggOiAwOyAvLyBSb3VnaCBlc3RpbWF0ZTogMSBieXRlIHBlciBjaGFyYWN0ZXJcclxuICB9XHJcblxyXG4gIC8vIEdldCBjYWNoZWQgZGF0YSB3aXRoIExSVSB0cmFja2luZ1xyXG4gIGdldDxUID0gdW5rbm93bj4oa2V5OiBzdHJpbmcpOiBUIHwgbnVsbCB7XHJcbiAgICBjb25zdCBlbnRyeSA9IHRoaXMuY2FjaGUuZ2V0KGtleSk7XHJcbiAgICBpZiAoIWVudHJ5KSB7XHJcbiAgICAgIHRoaXMuc3RhdHMubWlzc2VzKys7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcbiAgICBpZiAobm93IC0gZW50cnkudGltZXN0YW1wID49IGVudHJ5LnR0bCkge1xyXG4gICAgICB0aGlzLmNhY2hlLmRlbGV0ZShrZXkpO1xyXG4gICAgICB0aGlzLnN0YXRzLnNpemUgLT0gZW50cnkuc2l6ZTtcclxuICAgICAgdGhpcy5zdGF0cy5pdGVtQ291bnQtLTtcclxuICAgICAgdGhpcy5zdGF0cy5taXNzZXMrKztcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVXBkYXRlIExSVSB0cmFja2luZ1xyXG4gICAgZW50cnkuYWNjZXNzQ291bnQrKztcclxuICAgIGVudHJ5Lmxhc3RBY2Nlc3NlZCA9IG5vdztcclxuICAgIHRoaXMuc3RhdHMuaGl0cysrO1xyXG5cclxuICAgIHJldHVybiBlbnRyeS5kYXRhIGFzIFQ7XHJcbiAgfVxyXG5cclxuICAvLyBTZXQgY2FjaGUgZW50cnkgd2l0aCBhZHZhbmNlZCBmZWF0dXJlc1xyXG4gIHNldDxUID0gdW5rbm93bj4oXHJcbiAgICBrZXk6IHN0cmluZyxcclxuICAgIGRhdGE6IFQsXHJcbiAgICBvcHRpb25zOiB7XHJcbiAgICAgIHR0bD86IG51bWJlcjtcclxuICAgICAgdGFncz86IHN0cmluZ1tdO1xyXG4gICAgICBjb21wcmVzcz86IGJvb2xlYW47XHJcbiAgICB9ID0ge31cclxuICApOiB2b2lkIHtcclxuICAgIGNvbnN0IHR0bCA9IG9wdGlvbnMudHRsIHx8IHRoaXMuY29uZmlnLmRlZmF1bHRUVEw7XHJcbiAgICBjb25zdCBzaXplID0gdGhpcy5lc3RpbWF0ZVNpemUoZGF0YSk7XHJcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xyXG5cclxuICAgIC8vIENoZWNrIGlmIHdlIG5lZWQgdG8gZXZpY3QgZW50cmllcyB0byBtYWtlIHJvb21cclxuICAgIGlmICh0aGlzLnN0YXRzLnNpemUgKyBzaXplID4gdGhpcy5jb25maWcubWF4U2l6ZSkge1xyXG4gICAgICBjb25zdCByZXF1aXJlZFNwYWNlID0gdGhpcy5zdGF0cy5zaXplICsgc2l6ZSAtIHRoaXMuY29uZmlnLm1heFNpemU7XHJcbiAgICAgIHRoaXMuZXZpY3RMUlUocmVxdWlyZWRTcGFjZSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgZW50cnk6IENhY2hlRW50cnk8VD4gPSB7XHJcbiAgICAgIGRhdGEsXHJcbiAgICAgIHRpbWVzdGFtcDogbm93LFxyXG4gICAgICB0dGwsXHJcbiAgICAgIGFjY2Vzc0NvdW50OiAwLFxyXG4gICAgICBsYXN0QWNjZXNzZWQ6IG5vdyxcclxuICAgICAgc2l6ZSxcclxuICAgICAgdGFnczogb3B0aW9ucy50YWdzXHJcbiAgICB9O1xyXG5cclxuICAgIC8vIFJlbW92ZSBvbGQgZW50cnkgaWYgaXQgZXhpc3RzXHJcbiAgICBjb25zdCBvbGRFbnRyeSA9IHRoaXMuY2FjaGUuZ2V0KGtleSk7XHJcbiAgICBpZiAob2xkRW50cnkpIHtcclxuICAgICAgdGhpcy5zdGF0cy5zaXplIC09IG9sZEVudHJ5LnNpemU7XHJcbiAgICAgIHRoaXMuc3RhdHMuaXRlbUNvdW50LS07XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5jYWNoZS5zZXQoa2V5LCBlbnRyeSk7XHJcbiAgICB0aGlzLnN0YXRzLnNpemUgKz0gc2l6ZTtcclxuICAgIHRoaXMuc3RhdHMuaXRlbUNvdW50Kys7XHJcbiAgICB0aGlzLnN0YXRzLnNldHMrKztcclxuICB9XHJcblxyXG4gIC8vIExSVSBldmljdGlvblxyXG4gIHByaXZhdGUgZXZpY3RMUlUocmVxdWlyZWRTcGFjZTogbnVtYmVyKTogdm9pZCB7XHJcbiAgICBpZiAoIXRoaXMuY29uZmlnLmxydUVuYWJsZWQpIHJldHVybjtcclxuXHJcbiAgICBjb25zdCBlbnRyaWVzID0gQXJyYXkuZnJvbSh0aGlzLmNhY2hlLmVudHJpZXMoKSlcclxuICAgICAgLnNvcnQoKFssIGFdLCBbLCBiXSkgPT4ge1xyXG4gICAgICAgIC8vIFNvcnQgYnkgYWNjZXNzIGNvdW50LCB0aGVuIGJ5IGxhc3QgYWNjZXNzZWQgdGltZVxyXG4gICAgICAgIGlmIChhLmFjY2Vzc0NvdW50ICE9PSBiLmFjY2Vzc0NvdW50KSB7XHJcbiAgICAgICAgICByZXR1cm4gYS5hY2Nlc3NDb3VudCAtIGIuYWNjZXNzQ291bnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBhLmxhc3RBY2Nlc3NlZCAtIGIubGFzdEFjY2Vzc2VkO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICBsZXQgZnJlZWRTcGFjZSA9IDA7XHJcbiAgICBmb3IgKGNvbnN0IFtrZXksIGVudHJ5XSBvZiBlbnRyaWVzKSB7XHJcbiAgICAgIGlmIChmcmVlZFNwYWNlID49IHJlcXVpcmVkU3BhY2UpIGJyZWFrO1xyXG5cclxuICAgICAgdGhpcy5jYWNoZS5kZWxldGUoa2V5KTtcclxuICAgICAgdGhpcy5zdGF0cy5zaXplIC09IGVudHJ5LnNpemU7XHJcbiAgICAgIHRoaXMuc3RhdHMuaXRlbUNvdW50LS07XHJcbiAgICAgIHRoaXMuc3RhdHMuZXZpY3Rpb25zKys7XHJcbiAgICAgIGZyZWVkU3BhY2UgKz0gZW50cnkuc2l6ZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIERlbGV0ZSBjYWNoZSBlbnRyeVxyXG4gIGRlbGV0ZShrZXk6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gICAgY29uc3QgZW50cnkgPSB0aGlzLmNhY2hlLmdldChrZXkpO1xyXG4gICAgaWYgKGVudHJ5KSB7XHJcbiAgICAgIHRoaXMuY2FjaGUuZGVsZXRlKGtleSk7XHJcbiAgICAgIHRoaXMuc3RhdHMuc2l6ZSAtPSBlbnRyeS5zaXplO1xyXG4gICAgICB0aGlzLnN0YXRzLml0ZW1Db3VudC0tO1xyXG4gICAgICB0aGlzLnN0YXRzLmRlbGV0ZXMrKztcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG5cclxuICAvLyBDbGVhciBjYWNoZSBieSB0YWdzXHJcbiAgY2xlYXJCeVRhZ3ModGFnczogc3RyaW5nW10pOiBudW1iZXIge1xyXG4gICAgbGV0IGNsZWFyZWQgPSAwO1xyXG4gICAgZm9yIChjb25zdCBba2V5LCBlbnRyeV0gb2YgdGhpcy5jYWNoZS5lbnRyaWVzKCkpIHtcclxuICAgICAgaWYgKGVudHJ5LnRhZ3MgJiYgZW50cnkudGFncy5zb21lKHRhZyA9PiB0YWdzLmluY2x1ZGVzKHRhZykpKSB7XHJcbiAgICAgICAgdGhpcy5jYWNoZS5kZWxldGUoa2V5KTtcclxuICAgICAgICB0aGlzLnN0YXRzLnNpemUgLT0gZW50cnkuc2l6ZTtcclxuICAgICAgICB0aGlzLnN0YXRzLml0ZW1Db3VudC0tO1xyXG4gICAgICAgIHRoaXMuc3RhdHMuZGVsZXRlcysrO1xyXG4gICAgICAgIGNsZWFyZWQrKztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGNsZWFyZWQ7XHJcbiAgfVxyXG5cclxuICAvLyBDbGVhciBhbGwgY2FjaGVcclxuICBjbGVhcigpOiB2b2lkIHtcclxuICAgIHRoaXMuY2FjaGUuY2xlYXIoKTtcclxuICAgIHRoaXMuc3RhdHMuc2l6ZSA9IDA7XHJcbiAgICB0aGlzLnN0YXRzLml0ZW1Db3VudCA9IDA7XHJcbiAgICB0aGlzLnN0YXRzLmRlbGV0ZXMgKz0gdGhpcy5zdGF0cy5pdGVtQ291bnQ7XHJcbiAgfVxyXG5cclxuICAvLyBIYW5kbGUgcmVxdWVzdCBkZWR1cGxpY2F0aW9uIHdpdGggZW5oYW5jZWQgZXJyb3IgaGFuZGxpbmdcclxuICBhc3luYyBkZWR1cGU8VD4oXHJcbiAgICBrZXk6IHN0cmluZyxcclxuICAgIHJlcXVlc3RGbjogKCkgPT4gUHJvbWlzZTxUPixcclxuICAgIG9wdGlvbnM6IHtcclxuICAgICAgdHRsPzogbnVtYmVyO1xyXG4gICAgICB0YWdzPzogc3RyaW5nW107XHJcbiAgICAgIHVzZUNhY2hlPzogYm9vbGVhbjtcclxuICAgIH0gPSB7fVxyXG4gICk6IFByb21pc2U8VD4ge1xyXG4gICAgLy8gQ2hlY2sgY2FjaGUgZmlyc3QgaWYgZW5hYmxlZFxyXG4gICAgaWYgKG9wdGlvbnMudXNlQ2FjaGUgIT09IGZhbHNlKSB7XHJcbiAgICAgIGNvbnN0IGNhY2hlZCA9IHRoaXMuZ2V0PFQ+KGtleSk7XHJcbiAgICAgIGlmIChjYWNoZWQgIT09IG51bGwpIHtcclxuICAgICAgICByZXR1cm4gY2FjaGVkO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2hlY2sgaWYgcmVxdWVzdCBpcyBhbHJlYWR5IHBlbmRpbmdcclxuICAgIGNvbnN0IHBlbmRpbmcgPSB0aGlzLnBlbmRpbmdSZXF1ZXN0cy5nZXQoa2V5KTtcclxuICAgIGlmIChwZW5kaW5nKSB7XHJcbiAgICAgIHJldHVybiBwZW5kaW5nIGFzIFByb21pc2U8VD47XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRXhlY3V0ZSByZXF1ZXN0IGFuZCBjYWNoZSB0aGUgcHJvbWlzZVxyXG4gICAgY29uc3QgcHJvbWlzZSA9IHJlcXVlc3RGbigpXHJcbiAgICAgIC50aGVuKHJlc3VsdCA9PiB7XHJcbiAgICAgICAgLy8gQ2FjaGUgc3VjY2Vzc2Z1bCByZXN1bHRzXHJcbiAgICAgICAgaWYgKG9wdGlvbnMudXNlQ2FjaGUgIT09IGZhbHNlKSB7XHJcbiAgICAgICAgICB0aGlzLnNldChrZXksIHJlc3VsdCwge1xyXG4gICAgICAgICAgICB0dGw6IG9wdGlvbnMudHRsLFxyXG4gICAgICAgICAgICB0YWdzOiBvcHRpb25zLnRhZ3NcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICB9KVxyXG4gICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5wZW5kaW5nUmVxdWVzdHMuZGVsZXRlKGtleSk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIHRoaXMucGVuZGluZ1JlcXVlc3RzLnNldChrZXksIHByb21pc2UpO1xyXG4gICAgcmV0dXJuIHByb21pc2U7XHJcbiAgfVxyXG5cclxuICAvLyBHZXQgY2FjaGUgc3RhdGlzdGljc1xyXG4gIGdldFN0YXRzKCk6IENhY2hlU3RhdHMge1xyXG4gICAgcmV0dXJuIHsgLi4udGhpcy5zdGF0cyB9O1xyXG4gIH1cclxuXHJcbiAgLy8gR2V0IGNhY2hlIGhpdCByYXRlXHJcbiAgZ2V0SGl0UmF0ZSgpOiBudW1iZXIge1xyXG4gICAgY29uc3QgdG90YWwgPSB0aGlzLnN0YXRzLmhpdHMgKyB0aGlzLnN0YXRzLm1pc3NlcztcclxuICAgIHJldHVybiB0b3RhbCA+IDAgPyB0aGlzLnN0YXRzLmhpdHMgLyB0b3RhbCA6IDA7XHJcbiAgfVxyXG5cclxuICAvLyBDbGVhbnVwIGV4cGlyZWQgZW50cmllc1xyXG4gIGNsZWFudXAoKTogdm9pZCB7XHJcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xyXG4gICAgZm9yIChjb25zdCBba2V5LCBlbnRyeV0gb2YgdGhpcy5jYWNoZS5lbnRyaWVzKCkpIHtcclxuICAgICAgaWYgKG5vdyAtIGVudHJ5LnRpbWVzdGFtcCA+IGVudHJ5LnR0bCkge1xyXG4gICAgICAgIHRoaXMuY2FjaGUuZGVsZXRlKGtleSk7XHJcbiAgICAgICAgdGhpcy5zdGF0cy5zaXplIC09IGVudHJ5LnNpemU7XHJcbiAgICAgICAgdGhpcy5zdGF0cy5pdGVtQ291bnQtLTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gUGVyc2lzdCBjYWNoZSB0byBsb2NhbFN0b3JhZ2VcclxuICBwcml2YXRlIHBlcnNpc3RDYWNoZSgpOiB2b2lkIHtcclxuICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJyB8fCAhd2luZG93LmxvY2FsU3RvcmFnZSkgcmV0dXJuO1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHBlcnNpc3RhYmxlRGF0YSA9IEFycmF5LmZyb20odGhpcy5jYWNoZS5lbnRyaWVzKCkpXHJcbiAgICAgICAgLmZpbHRlcigoWywgZW50cnldKSA9PiB7XHJcbiAgICAgICAgICAvLyBPbmx5IHBlcnNpc3QgZW50cmllcyB0aGF0IGhhdmVuJ3QgZXhwaXJlZCBhbmQgYXJlbid0IHRvbyBsYXJnZVxyXG4gICAgICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcclxuICAgICAgICAgIHJldHVybiAobm93IC0gZW50cnkudGltZXN0YW1wIDwgZW50cnkudHRsKSAmJiBlbnRyeS5zaXplIDwgMTAyNCAqIDEwMjQ7IC8vIDwgMU1CXHJcbiAgICAgICAgfSlcclxuICAgICAgICAubWFwKChba2V5LCBlbnRyeV0pID0+IFtrZXksIHtcclxuICAgICAgICAgIGRhdGE6IGVudHJ5LmRhdGEsXHJcbiAgICAgICAgICB0aW1lc3RhbXA6IGVudHJ5LnRpbWVzdGFtcCxcclxuICAgICAgICAgIHR0bDogZW50cnkudHRsLFxyXG4gICAgICAgICAgYWNjZXNzQ291bnQ6IGVudHJ5LmFjY2Vzc0NvdW50LFxyXG4gICAgICAgICAgbGFzdEFjY2Vzc2VkOiBlbnRyeS5sYXN0QWNjZXNzZWQsXHJcbiAgICAgICAgICBzaXplOiBlbnRyeS5zaXplLFxyXG4gICAgICAgICAgdGFnczogZW50cnkudGFnc1xyXG4gICAgICAgIH1dKTtcclxuXHJcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKHRoaXMuY29uZmlnLnBlcnNpc3RlbmNlS2V5LCBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgZGF0YTogcGVyc2lzdGFibGVEYXRhLFxyXG4gICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKVxyXG4gICAgICB9KSk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBwZXJzaXN0IGNhY2hlOicsIGVycm9yKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIExvYWQgcGVyc2lzdGVkIGNhY2hlIGZyb20gbG9jYWxTdG9yYWdlXHJcbiAgcHJpdmF0ZSBsb2FkUGVyc2lzdGVkQ2FjaGUoKTogdm9pZCB7XHJcbiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcgfHwgIXdpbmRvdy5sb2NhbFN0b3JhZ2UpIHJldHVybjtcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBwZXJzaXN0ZWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSh0aGlzLmNvbmZpZy5wZXJzaXN0ZW5jZUtleSk7XHJcbiAgICAgIGlmICghcGVyc2lzdGVkKSByZXR1cm47XHJcblxyXG4gICAgICBjb25zdCB7IGRhdGEsIHRpbWVzdGFtcCB9ID0gSlNPTi5wYXJzZShwZXJzaXN0ZWQpO1xyXG4gICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xyXG5cclxuICAgICAgLy8gT25seSBsb2FkIGlmIHBlcnNpc3RlZCB3aXRoaW4gbGFzdCAyNCBob3Vyc1xyXG4gICAgICBpZiAobm93IC0gdGltZXN0YW1wID4gMjQgKiA2MCAqIDYwICogMTAwMCkge1xyXG4gICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKHRoaXMuY29uZmlnLnBlcnNpc3RlbmNlS2V5KTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZvciAoY29uc3QgW2tleSwgZW50cnldIG9mIGRhdGEpIHtcclxuICAgICAgICAvLyBDaGVjayBpZiBlbnRyeSBpcyBzdGlsbCB2YWxpZFxyXG4gICAgICAgIGlmIChub3cgLSBlbnRyeS50aW1lc3RhbXAgPCBlbnRyeS50dGwpIHtcclxuICAgICAgICAgIHRoaXMuY2FjaGUuc2V0KGtleSwgZW50cnkpO1xyXG4gICAgICAgICAgdGhpcy5zdGF0cy5zaXplICs9IGVudHJ5LnNpemU7XHJcbiAgICAgICAgICB0aGlzLnN0YXRzLml0ZW1Db3VudCsrO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc29sZS5sb2coYExvYWRlZCAke3RoaXMuc3RhdHMuaXRlbUNvdW50fSBwZXJzaXN0ZWQgY2FjaGUgZW50cmllc2ApO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gbG9hZCBwZXJzaXN0ZWQgY2FjaGU6JywgZXJyb3IpO1xyXG4gICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSh0aGlzLmNvbmZpZy5wZXJzaXN0ZW5jZUtleSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBXYXJtIHVwIGNhY2hlIHdpdGggZnJlcXVlbnRseSBhY2Nlc3NlZCBkYXRhXHJcbiAgYXN5bmMgd2FybXVwKGtleXM6IHN0cmluZ1tdKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICBjb25zdCB3YXJtdXBQcm9taXNlcyA9IGtleXMubWFwKGFzeW5jIChrZXkpID0+IHtcclxuICAgICAgLy8gVGhpcyB3b3VsZCB0eXBpY2FsbHkgZmV0Y2ggZnJvbSBhIGZhc3Qgc291cmNlIG9yIHByZS1jb21wdXRlZCBkYXRhXHJcbiAgICAgIC8vIEZvciBub3csIGp1c3QgZW5zdXJlIHRoZSBrZXkgZXhpc3RzIGluIGNhY2hlXHJcbiAgICAgIHJldHVybiB0aGlzLmNhY2hlLmhhcyhrZXkpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgYXdhaXQgUHJvbWlzZS5hbGwod2FybXVwUHJvbWlzZXMpO1xyXG4gIH1cclxufVxyXG5cclxuLy8gR2xvYmFsIGFkdmFuY2VkIGNhY2hlIGluc3RhbmNlIHdpdGggb3B0aW1pemVkIHNldHRpbmdzXHJcbmV4cG9ydCBjb25zdCBhZHZhbmNlZEFwaUNhY2hlID0gbmV3IEFkdmFuY2VkQVBJQ2FjaGUoe1xyXG4gIG1heFNpemU6IDEwMCAqIDEwMjQgKiAxMDI0LCAvLyAxMDBNQiBmb3IgYmV0dGVyIHBlcmZvcm1hbmNlXHJcbiAgZGVmYXVsdFRUTDogMTAgKiA2MCAqIDEwMDAsIC8vIDEwIG1pbnV0ZXMgZm9yIGJldHRlciBjYWNoZSBoaXQgcmF0ZXNcclxuICBlbmFibGVQZXJzaXN0ZW5jZTogdHJ1ZSxcclxuICBwZXJzaXN0ZW5jZUtleTogJ3BvaW50cy1jb21wYW5pb24tY2FjaGUtdjInLFxyXG4gIGVuYWJsZUNvbXByZXNzaW9uOiBmYWxzZSwgLy8gQ2FuIGJlIGVuYWJsZWQgbGF0ZXIgd2l0aCBjb21wcmVzc2lvbiBsaWJyYXJ5XHJcbiAgbHJ1RW5hYmxlZDogdHJ1ZVxyXG59KTtcclxuXHJcbi8vIExlZ2FjeSBjYWNoZSBpbnN0YW5jZSBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eVxyXG5leHBvcnQgY29uc3QgYXBpQ2FjaGUgPSBhZHZhbmNlZEFwaUNhY2hlO1xyXG5cclxuLy8gQ2FjaGUgd2FybWluZyB1dGlsaXR5XHJcbmV4cG9ydCBjb25zdCB3YXJtdXBDYWNoZSA9IGFzeW5jIChmcmVxdWVudGx5VXNlZEtleXM6IHN0cmluZ1tdKSA9PiB7XHJcbiAgYXdhaXQgYWR2YW5jZWRBcGlDYWNoZS53YXJtdXAoZnJlcXVlbnRseVVzZWRLZXlzKTtcclxufTtcclxuXHJcbi8vIENhY2hlIG1vbml0b3JpbmcgdXRpbGl0eVxyXG5leHBvcnQgY29uc3QgZ2V0Q2FjaGVNZXRyaWNzID0gKCkgPT4ge1xyXG4gIGNvbnN0IHN0YXRzID0gYWR2YW5jZWRBcGlDYWNoZS5nZXRTdGF0cygpO1xyXG4gIGNvbnN0IGhpdFJhdGUgPSBhZHZhbmNlZEFwaUNhY2hlLmdldEhpdFJhdGUoKTtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIC4uLnN0YXRzLFxyXG4gICAgaGl0UmF0ZTogYCR7KGhpdFJhdGUgKiAxMDApLnRvRml4ZWQoMil9JWAsXHJcbiAgICBzaXplRm9ybWF0dGVkOiBgJHsoc3RhdHMuc2l6ZSAvIDEwMjQgLyAxMDI0KS50b0ZpeGVkKDIpfU1CYCxcclxuICAgIGVmZmljaWVuY3k6IGhpdFJhdGUgPiAwLjggPyAnRXhjZWxsZW50JyA6IGhpdFJhdGUgPiAwLjYgPyAnR29vZCcgOiAnTmVlZHMgT3B0aW1pemF0aW9uJ1xyXG4gIH07XHJcbn07XHJcbiJdLCJtYXBwaW5ncyI6Ijs7OztBQUFBOztBQThCQSxNQUFNQSxnQkFBZ0IsQ0FBQztFQUNiQyxLQUFLLEdBQUcsSUFBSUMsR0FBRyxDQUFxQixDQUFDO0VBQ3JDQyxlQUFlLEdBQUcsSUFBSUQsR0FBRyxDQUEyQixDQUFDO0VBQ3JERSxLQUFLLEdBQWU7SUFDMUJDLElBQUksRUFBRSxDQUFDO0lBQ1BDLE1BQU0sRUFBRSxDQUFDO0lBQ1RDLFNBQVMsRUFBRSxDQUFDO0lBQ1pDLElBQUksRUFBRSxDQUFDO0lBQ1BDLE9BQU8sRUFBRSxDQUFDO0lBQ1ZDLElBQUksRUFBRSxDQUFDO0lBQ1BDLFNBQVMsRUFBRTtFQUNiLENBQUM7RUFFT0MsTUFBTSxHQUFnQjtJQUM1QkMsT0FBTyxFQUFFLEVBQUUsR0FBRyxJQUFJLEdBQUcsSUFBSTtJQUFFO0lBQzNCQyxVQUFVLEVBQUUsQ0FBQyxHQUFHLEVBQUUsR0FBRyxJQUFJO0lBQUU7SUFDM0JDLGlCQUFpQixFQUFFLElBQUk7SUFDdkJDLGNBQWMsRUFBRSx1QkFBdUI7SUFDdkNDLGlCQUFpQixFQUFFLEtBQUs7SUFDeEJDLFVBQVUsRUFBRTtFQUNkLENBQUM7RUFFREMsV0FBV0EsQ0FBQ1AsTUFBNkIsRUFBRTtJQUN6QyxJQUFJQSxNQUFNLEVBQUU7TUFDVixJQUFJLENBQUNBLE1BQU0sR0FBRztRQUFFLEdBQUcsSUFBSSxDQUFDQSxNQUFNO1FBQUUsR0FBR0E7TUFBTyxDQUFDO0lBQzdDOztJQUVBO0lBQ0EsSUFBSSxJQUFJLENBQUNBLE1BQU0sQ0FBQ0csaUJBQWlCLElBQUksT0FBT0ssTUFBTSxLQUFLLFdBQVcsRUFBRTtNQUNsRSxJQUFJLENBQUNDLGtCQUFrQixDQUFDLENBQUM7SUFDM0I7O0lBRUE7SUFDQSxJQUFJLE9BQU9DLE1BQU0sS0FBSyxXQUFXLEVBQUU7TUFDakNDLFdBQVcsQ0FBQyxNQUFNO1FBQ2hCLElBQUksQ0FBQ0MsT0FBTyxDQUFDLENBQUM7UUFDZCxJQUFJLElBQUksQ0FBQ1osTUFBTSxDQUFDRyxpQkFBaUIsRUFBRTtVQUNqQyxJQUFJLENBQUNVLFlBQVksQ0FBQyxDQUFDO1FBQ3JCO01BQ0YsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFDLENBQUM7SUFDYjtFQUNGOztFQUVBO0VBQ0FDLFdBQVdBLENBQUNDLE1BQStCLEVBQUVDLE1BQU0sR0FBRyxLQUFLLEVBQVU7SUFDbkUsTUFBTUMsWUFBWSxHQUFHQyxNQUFNLENBQUNDLElBQUksQ0FBQ0osTUFBTSxDQUFDLENBQ3JDSyxJQUFJLENBQUMsQ0FBQyxDQUNOQyxNQUFNLENBQUMsQ0FBQ0MsTUFBTSxFQUFFQyxHQUFHLEtBQUs7TUFDdkJELE1BQU0sQ0FBQ0MsR0FBRyxDQUFDLEdBQUdSLE1BQU0sQ0FBQ1EsR0FBRyxDQUFDO01BQ3pCLE9BQU9ELE1BQU07SUFDZixDQUFDLEVBQUUsQ0FBQyxDQUE0QixDQUFDO0lBRW5DLE1BQU1FLFdBQVcsR0FBR0MsSUFBSSxDQUFDQyxTQUFTLENBQUNULFlBQVksQ0FBQztJQUNoRCxPQUFPLEdBQUdELE1BQU0sSUFBSSxJQUFJLENBQUNXLFVBQVUsQ0FBQ0gsV0FBVyxDQUFDLEVBQUU7RUFDcEQ7O0VBRUE7RUFDUUcsVUFBVUEsQ0FBQ0MsR0FBVyxFQUFVO0lBQ3RDLElBQUlDLElBQUksR0FBRyxDQUFDO0lBQ1osS0FBSyxJQUFJQyxDQUFDLEdBQUcsQ0FBQyxFQUFFQSxDQUFDLEdBQUdGLEdBQUcsQ0FBQ0csTUFBTSxFQUFFRCxDQUFDLEVBQUUsRUFBRTtNQUNuQyxNQUFNRSxJQUFJLEdBQUdKLEdBQUcsQ0FBQ0ssVUFBVSxDQUFDSCxDQUFDLENBQUM7TUFDOUJELElBQUksR0FBSSxDQUFDQSxJQUFJLElBQUksQ0FBQyxJQUFJQSxJQUFJLEdBQUlHLElBQUk7TUFDbENILElBQUksR0FBR0EsSUFBSSxHQUFHQSxJQUFJLENBQUMsQ0FBQztJQUN0QjtJQUNBLE9BQU9LLElBQUksQ0FBQ0MsR0FBRyxDQUFDTixJQUFJLENBQUMsQ0FBQ08sUUFBUSxDQUFDLEVBQUUsQ0FBQztFQUNwQzs7RUFFQTtFQUNRQyxZQUFZQSxDQUFDQyxJQUFhLEVBQVU7SUFDMUMsTUFBTVYsR0FBRyxHQUFHSCxJQUFJLENBQUNDLFNBQVMsQ0FBQ1ksSUFBSSxDQUFDO0lBQ2hDLE9BQU9WLEdBQUcsR0FBR0EsR0FBRyxDQUFDRyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUM7RUFDL0I7O0VBRUE7RUFDQVEsR0FBR0EsQ0FBY2hCLEdBQVcsRUFBWTtJQUN0QyxNQUFNaUIsS0FBSyxHQUFHLElBQUksQ0FBQ25ELEtBQUssQ0FBQ2tELEdBQUcsQ0FBQ2hCLEdBQUcsQ0FBQztJQUNqQyxJQUFJLENBQUNpQixLQUFLLEVBQUU7TUFDVixJQUFJLENBQUNoRCxLQUFLLENBQUNFLE1BQU0sRUFBRTtNQUNuQixPQUFPLElBQUk7SUFDYjtJQUVBLE1BQU0rQyxHQUFHLEdBQUdDLElBQUksQ0FBQ0QsR0FBRyxDQUFDLENBQUM7SUFDdEIsSUFBSUEsR0FBRyxHQUFHRCxLQUFLLENBQUNHLFNBQVMsSUFBSUgsS0FBSyxDQUFDSSxHQUFHLEVBQUU7TUFDdEMsSUFBSSxDQUFDdkQsS0FBSyxDQUFDd0QsTUFBTSxDQUFDdEIsR0FBRyxDQUFDO01BQ3RCLElBQUksQ0FBQy9CLEtBQUssQ0FBQ00sSUFBSSxJQUFJMEMsS0FBSyxDQUFDMUMsSUFBSTtNQUM3QixJQUFJLENBQUNOLEtBQUssQ0FBQ08sU0FBUyxFQUFFO01BQ3RCLElBQUksQ0FBQ1AsS0FBSyxDQUFDRSxNQUFNLEVBQUU7TUFDbkIsT0FBTyxJQUFJO0lBQ2I7O0lBRUE7SUFDQThDLEtBQUssQ0FBQ00sV0FBVyxFQUFFO0lBQ25CTixLQUFLLENBQUNPLFlBQVksR0FBR04sR0FBRztJQUN4QixJQUFJLENBQUNqRCxLQUFLLENBQUNDLElBQUksRUFBRTtJQUVqQixPQUFPK0MsS0FBSyxDQUFDRixJQUFJO0VBQ25COztFQUVBO0VBQ0FVLEdBQUdBLENBQ0R6QixHQUFXLEVBQ1hlLElBQU8sRUFDUFcsT0FJQyxHQUFHLENBQUMsQ0FBQyxFQUNBO0lBQ04sTUFBTUwsR0FBRyxHQUFHSyxPQUFPLENBQUNMLEdBQUcsSUFBSSxJQUFJLENBQUM1QyxNQUFNLENBQUNFLFVBQVU7SUFDakQsTUFBTUosSUFBSSxHQUFHLElBQUksQ0FBQ3VDLFlBQVksQ0FBQ0MsSUFBSSxDQUFDO0lBQ3BDLE1BQU1HLEdBQUcsR0FBR0MsSUFBSSxDQUFDRCxHQUFHLENBQUMsQ0FBQzs7SUFFdEI7SUFDQSxJQUFJLElBQUksQ0FBQ2pELEtBQUssQ0FBQ00sSUFBSSxHQUFHQSxJQUFJLEdBQUcsSUFBSSxDQUFDRSxNQUFNLENBQUNDLE9BQU8sRUFBRTtNQUNoRCxNQUFNaUQsYUFBYSxHQUFHLElBQUksQ0FBQzFELEtBQUssQ0FBQ00sSUFBSSxHQUFHQSxJQUFJLEdBQUcsSUFBSSxDQUFDRSxNQUFNLENBQUNDLE9BQU87TUFDbEUsSUFBSSxDQUFDa0QsUUFBUSxDQUFDRCxhQUFhLENBQUM7SUFDOUI7SUFFQSxNQUFNVixLQUFvQixHQUFHO01BQzNCRixJQUFJO01BQ0pLLFNBQVMsRUFBRUYsR0FBRztNQUNkRyxHQUFHO01BQ0hFLFdBQVcsRUFBRSxDQUFDO01BQ2RDLFlBQVksRUFBRU4sR0FBRztNQUNqQjNDLElBQUk7TUFDSnNELElBQUksRUFBRUgsT0FBTyxDQUFDRztJQUNoQixDQUFDOztJQUVEO0lBQ0EsTUFBTUMsUUFBUSxHQUFHLElBQUksQ0FBQ2hFLEtBQUssQ0FBQ2tELEdBQUcsQ0FBQ2hCLEdBQUcsQ0FBQztJQUNwQyxJQUFJOEIsUUFBUSxFQUFFO01BQ1osSUFBSSxDQUFDN0QsS0FBSyxDQUFDTSxJQUFJLElBQUl1RCxRQUFRLENBQUN2RCxJQUFJO01BQ2hDLElBQUksQ0FBQ04sS0FBSyxDQUFDTyxTQUFTLEVBQUU7SUFDeEI7SUFFQSxJQUFJLENBQUNWLEtBQUssQ0FBQzJELEdBQUcsQ0FBQ3pCLEdBQUcsRUFBRWlCLEtBQUssQ0FBQztJQUMxQixJQUFJLENBQUNoRCxLQUFLLENBQUNNLElBQUksSUFBSUEsSUFBSTtJQUN2QixJQUFJLENBQUNOLEtBQUssQ0FBQ08sU0FBUyxFQUFFO0lBQ3RCLElBQUksQ0FBQ1AsS0FBSyxDQUFDSSxJQUFJLEVBQUU7RUFDbkI7O0VBRUE7RUFDUXVELFFBQVFBLENBQUNELGFBQXFCLEVBQVE7SUFDNUMsSUFBSSxDQUFDLElBQUksQ0FBQ2xELE1BQU0sQ0FBQ00sVUFBVSxFQUFFO0lBRTdCLE1BQU1nRCxPQUFPLEdBQUdDLEtBQUssQ0FBQ0MsSUFBSSxDQUFDLElBQUksQ0FBQ25FLEtBQUssQ0FBQ2lFLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FDN0NsQyxJQUFJLENBQUMsQ0FBQyxHQUFHcUMsQ0FBQyxDQUFDLEVBQUUsR0FBR0MsQ0FBQyxDQUFDLEtBQUs7TUFDdEI7TUFDQSxJQUFJRCxDQUFDLENBQUNYLFdBQVcsS0FBS1ksQ0FBQyxDQUFDWixXQUFXLEVBQUU7UUFDbkMsT0FBT1csQ0FBQyxDQUFDWCxXQUFXLEdBQUdZLENBQUMsQ0FBQ1osV0FBVztNQUN0QztNQUNBLE9BQU9XLENBQUMsQ0FBQ1YsWUFBWSxHQUFHVyxDQUFDLENBQUNYLFlBQVk7SUFDeEMsQ0FBQyxDQUFDO0lBRUosSUFBSVksVUFBVSxHQUFHLENBQUM7SUFDbEIsS0FBSyxNQUFNLENBQUNwQyxHQUFHLEVBQUVpQixLQUFLLENBQUMsSUFBSWMsT0FBTyxFQUFFO01BQ2xDLElBQUlLLFVBQVUsSUFBSVQsYUFBYSxFQUFFO01BRWpDLElBQUksQ0FBQzdELEtBQUssQ0FBQ3dELE1BQU0sQ0FBQ3RCLEdBQUcsQ0FBQztNQUN0QixJQUFJLENBQUMvQixLQUFLLENBQUNNLElBQUksSUFBSTBDLEtBQUssQ0FBQzFDLElBQUk7TUFDN0IsSUFBSSxDQUFDTixLQUFLLENBQUNPLFNBQVMsRUFBRTtNQUN0QixJQUFJLENBQUNQLEtBQUssQ0FBQ0csU0FBUyxFQUFFO01BQ3RCZ0UsVUFBVSxJQUFJbkIsS0FBSyxDQUFDMUMsSUFBSTtJQUMxQjtFQUNGOztFQUVBO0VBQ0ErQyxNQUFNQSxDQUFDdEIsR0FBVyxFQUFXO0lBQzNCLE1BQU1pQixLQUFLLEdBQUcsSUFBSSxDQUFDbkQsS0FBSyxDQUFDa0QsR0FBRyxDQUFDaEIsR0FBRyxDQUFDO0lBQ2pDLElBQUlpQixLQUFLLEVBQUU7TUFDVCxJQUFJLENBQUNuRCxLQUFLLENBQUN3RCxNQUFNLENBQUN0QixHQUFHLENBQUM7TUFDdEIsSUFBSSxDQUFDL0IsS0FBSyxDQUFDTSxJQUFJLElBQUkwQyxLQUFLLENBQUMxQyxJQUFJO01BQzdCLElBQUksQ0FBQ04sS0FBSyxDQUFDTyxTQUFTLEVBQUU7TUFDdEIsSUFBSSxDQUFDUCxLQUFLLENBQUNLLE9BQU8sRUFBRTtNQUNwQixPQUFPLElBQUk7SUFDYjtJQUNBLE9BQU8sS0FBSztFQUNkOztFQUVBO0VBQ0ErRCxXQUFXQSxDQUFDUixJQUFjLEVBQVU7SUFDbEMsSUFBSVMsT0FBTyxHQUFHLENBQUM7SUFDZixLQUFLLE1BQU0sQ0FBQ3RDLEdBQUcsRUFBRWlCLEtBQUssQ0FBQyxJQUFJLElBQUksQ0FBQ25ELEtBQUssQ0FBQ2lFLE9BQU8sQ0FBQyxDQUFDLEVBQUU7TUFDL0MsSUFBSWQsS0FBSyxDQUFDWSxJQUFJLElBQUlaLEtBQUssQ0FBQ1ksSUFBSSxDQUFDVSxJQUFJLENBQUNDLEdBQUcsSUFBSVgsSUFBSSxDQUFDWSxRQUFRLENBQUNELEdBQUcsQ0FBQyxDQUFDLEVBQUU7UUFDNUQsSUFBSSxDQUFDMUUsS0FBSyxDQUFDd0QsTUFBTSxDQUFDdEIsR0FBRyxDQUFDO1FBQ3RCLElBQUksQ0FBQy9CLEtBQUssQ0FBQ00sSUFBSSxJQUFJMEMsS0FBSyxDQUFDMUMsSUFBSTtRQUM3QixJQUFJLENBQUNOLEtBQUssQ0FBQ08sU0FBUyxFQUFFO1FBQ3RCLElBQUksQ0FBQ1AsS0FBSyxDQUFDSyxPQUFPLEVBQUU7UUFDcEJnRSxPQUFPLEVBQUU7TUFDWDtJQUNGO0lBQ0EsT0FBT0EsT0FBTztFQUNoQjs7RUFFQTtFQUNBSSxLQUFLQSxDQUFBLEVBQVM7SUFDWixJQUFJLENBQUM1RSxLQUFLLENBQUM0RSxLQUFLLENBQUMsQ0FBQztJQUNsQixJQUFJLENBQUN6RSxLQUFLLENBQUNNLElBQUksR0FBRyxDQUFDO0lBQ25CLElBQUksQ0FBQ04sS0FBSyxDQUFDTyxTQUFTLEdBQUcsQ0FBQztJQUN4QixJQUFJLENBQUNQLEtBQUssQ0FBQ0ssT0FBTyxJQUFJLElBQUksQ0FBQ0wsS0FBSyxDQUFDTyxTQUFTO0VBQzVDOztFQUVBO0VBQ0EsTUFBTW1FLE1BQU1BLENBQ1YzQyxHQUFXLEVBQ1g0QyxTQUEyQixFQUMzQmxCLE9BSUMsR0FBRyxDQUFDLENBQUMsRUFDTTtJQUNaO0lBQ0EsSUFBSUEsT0FBTyxDQUFDbUIsUUFBUSxLQUFLLEtBQUssRUFBRTtNQUM5QixNQUFNQyxNQUFNLEdBQUcsSUFBSSxDQUFDOUIsR0FBRyxDQUFJaEIsR0FBRyxDQUFDO01BQy9CLElBQUk4QyxNQUFNLEtBQUssSUFBSSxFQUFFO1FBQ25CLE9BQU9BLE1BQU07TUFDZjtJQUNGOztJQUVBO0lBQ0EsTUFBTUMsT0FBTyxHQUFHLElBQUksQ0FBQy9FLGVBQWUsQ0FBQ2dELEdBQUcsQ0FBQ2hCLEdBQUcsQ0FBQztJQUM3QyxJQUFJK0MsT0FBTyxFQUFFO01BQ1gsT0FBT0EsT0FBTztJQUNoQjs7SUFFQTtJQUNBLE1BQU1DLE9BQU8sR0FBR0osU0FBUyxDQUFDLENBQUMsQ0FDeEJLLElBQUksQ0FBQ2xELE1BQU0sSUFBSTtNQUNkO01BQ0EsSUFBSTJCLE9BQU8sQ0FBQ21CLFFBQVEsS0FBSyxLQUFLLEVBQUU7UUFDOUIsSUFBSSxDQUFDcEIsR0FBRyxDQUFDekIsR0FBRyxFQUFFRCxNQUFNLEVBQUU7VUFDcEJzQixHQUFHLEVBQUVLLE9BQU8sQ0FBQ0wsR0FBRztVQUNoQlEsSUFBSSxFQUFFSCxPQUFPLENBQUNHO1FBQ2hCLENBQUMsQ0FBQztNQUNKO01BQ0EsT0FBTzlCLE1BQU07SUFDZixDQUFDLENBQUMsQ0FDRG1ELE9BQU8sQ0FBQyxNQUFNO01BQ2IsSUFBSSxDQUFDbEYsZUFBZSxDQUFDc0QsTUFBTSxDQUFDdEIsR0FBRyxDQUFDO0lBQ2xDLENBQUMsQ0FBQztJQUVKLElBQUksQ0FBQ2hDLGVBQWUsQ0FBQ3lELEdBQUcsQ0FBQ3pCLEdBQUcsRUFBRWdELE9BQU8sQ0FBQztJQUN0QyxPQUFPQSxPQUFPO0VBQ2hCOztFQUVBO0VBQ0FHLFFBQVFBLENBQUEsRUFBZTtJQUNyQixPQUFPO01BQUUsR0FBRyxJQUFJLENBQUNsRjtJQUFNLENBQUM7RUFDMUI7O0VBRUE7RUFDQW1GLFVBQVVBLENBQUEsRUFBVztJQUNuQixNQUFNQyxLQUFLLEdBQUcsSUFBSSxDQUFDcEYsS0FBSyxDQUFDQyxJQUFJLEdBQUcsSUFBSSxDQUFDRCxLQUFLLENBQUNFLE1BQU07SUFDakQsT0FBT2tGLEtBQUssR0FBRyxDQUFDLEdBQUcsSUFBSSxDQUFDcEYsS0FBSyxDQUFDQyxJQUFJLEdBQUdtRixLQUFLLEdBQUcsQ0FBQztFQUNoRDs7RUFFQTtFQUNBaEUsT0FBT0EsQ0FBQSxFQUFTO0lBQ2QsTUFBTTZCLEdBQUcsR0FBR0MsSUFBSSxDQUFDRCxHQUFHLENBQUMsQ0FBQztJQUN0QixLQUFLLE1BQU0sQ0FBQ2xCLEdBQUcsRUFBRWlCLEtBQUssQ0FBQyxJQUFJLElBQUksQ0FBQ25ELEtBQUssQ0FBQ2lFLE9BQU8sQ0FBQyxDQUFDLEVBQUU7TUFDL0MsSUFBSWIsR0FBRyxHQUFHRCxLQUFLLENBQUNHLFNBQVMsR0FBR0gsS0FBSyxDQUFDSSxHQUFHLEVBQUU7UUFDckMsSUFBSSxDQUFDdkQsS0FBSyxDQUFDd0QsTUFBTSxDQUFDdEIsR0FBRyxDQUFDO1FBQ3RCLElBQUksQ0FBQy9CLEtBQUssQ0FBQ00sSUFBSSxJQUFJMEMsS0FBSyxDQUFDMUMsSUFBSTtRQUM3QixJQUFJLENBQUNOLEtBQUssQ0FBQ08sU0FBUyxFQUFFO01BQ3hCO0lBQ0Y7RUFDRjs7RUFFQTtFQUNRYyxZQUFZQSxDQUFBLEVBQVM7SUFDM0IsSUFBSSxPQUFPTCxNQUFNLEtBQUssV0FBVyxJQUFJLENBQUNBLE1BQU0sQ0FBQ3FFLFlBQVksRUFBRTtJQUUzRCxJQUFJO01BQ0YsTUFBTUMsZUFBZSxHQUFHdkIsS0FBSyxDQUFDQyxJQUFJLENBQUMsSUFBSSxDQUFDbkUsS0FBSyxDQUFDaUUsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUNyRHlCLE1BQU0sQ0FBQyxDQUFDLEdBQUd2QyxLQUFLLENBQUMsS0FBSztRQUNyQjtRQUNBLE1BQU1DLEdBQUcsR0FBR0MsSUFBSSxDQUFDRCxHQUFHLENBQUMsQ0FBQztRQUN0QixPQUFRQSxHQUFHLEdBQUdELEtBQUssQ0FBQ0csU0FBUyxHQUFHSCxLQUFLLENBQUNJLEdBQUcsSUFBS0osS0FBSyxDQUFDMUMsSUFBSSxHQUFHLElBQUksR0FBRyxJQUFJLENBQUMsQ0FBQztNQUMxRSxDQUFDLENBQUMsQ0FDRGtGLEdBQUcsQ0FBQyxDQUFDLENBQUN6RCxHQUFHLEVBQUVpQixLQUFLLENBQUMsS0FBSyxDQUFDakIsR0FBRyxFQUFFO1FBQzNCZSxJQUFJLEVBQUVFLEtBQUssQ0FBQ0YsSUFBSTtRQUNoQkssU0FBUyxFQUFFSCxLQUFLLENBQUNHLFNBQVM7UUFDMUJDLEdBQUcsRUFBRUosS0FBSyxDQUFDSSxHQUFHO1FBQ2RFLFdBQVcsRUFBRU4sS0FBSyxDQUFDTSxXQUFXO1FBQzlCQyxZQUFZLEVBQUVQLEtBQUssQ0FBQ08sWUFBWTtRQUNoQ2pELElBQUksRUFBRTBDLEtBQUssQ0FBQzFDLElBQUk7UUFDaEJzRCxJQUFJLEVBQUVaLEtBQUssQ0FBQ1k7TUFDZCxDQUFDLENBQUMsQ0FBQztNQUVMeUIsWUFBWSxDQUFDSSxPQUFPLENBQUMsSUFBSSxDQUFDakYsTUFBTSxDQUFDSSxjQUFjLEVBQUVxQixJQUFJLENBQUNDLFNBQVMsQ0FBQztRQUM5RFksSUFBSSxFQUFFd0MsZUFBZTtRQUNyQm5DLFNBQVMsRUFBRUQsSUFBSSxDQUFDRCxHQUFHLENBQUM7TUFDdEIsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsT0FBT3lDLEtBQUssRUFBRTtNQUNkQyxPQUFPLENBQUNDLElBQUksQ0FBQywwQkFBMEIsRUFBRUYsS0FBSyxDQUFDO0lBQ2pEO0VBQ0Y7O0VBRUE7RUFDUXpFLGtCQUFrQkEsQ0FBQSxFQUFTO0lBQ2pDLElBQUksT0FBT0QsTUFBTSxLQUFLLFdBQVcsSUFBSSxDQUFDQSxNQUFNLENBQUNxRSxZQUFZLEVBQUU7SUFFM0QsSUFBSTtNQUNGLE1BQU1RLFNBQVMsR0FBR1IsWUFBWSxDQUFDUyxPQUFPLENBQUMsSUFBSSxDQUFDdEYsTUFBTSxDQUFDSSxjQUFjLENBQUM7TUFDbEUsSUFBSSxDQUFDaUYsU0FBUyxFQUFFO01BRWhCLE1BQU07UUFBRS9DLElBQUk7UUFBRUs7TUFBVSxDQUFDLEdBQUdsQixJQUFJLENBQUM4RCxLQUFLLENBQUNGLFNBQVMsQ0FBQztNQUNqRCxNQUFNNUMsR0FBRyxHQUFHQyxJQUFJLENBQUNELEdBQUcsQ0FBQyxDQUFDOztNQUV0QjtNQUNBLElBQUlBLEdBQUcsR0FBR0UsU0FBUyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLElBQUksRUFBRTtRQUN6Q2tDLFlBQVksQ0FBQ1csVUFBVSxDQUFDLElBQUksQ0FBQ3hGLE1BQU0sQ0FBQ0ksY0FBYyxDQUFDO1FBQ25EO01BQ0Y7TUFFQSxLQUFLLE1BQU0sQ0FBQ21CLEdBQUcsRUFBRWlCLEtBQUssQ0FBQyxJQUFJRixJQUFJLEVBQUU7UUFDL0I7UUFDQSxJQUFJRyxHQUFHLEdBQUdELEtBQUssQ0FBQ0csU0FBUyxHQUFHSCxLQUFLLENBQUNJLEdBQUcsRUFBRTtVQUNyQyxJQUFJLENBQUN2RCxLQUFLLENBQUMyRCxHQUFHLENBQUN6QixHQUFHLEVBQUVpQixLQUFLLENBQUM7VUFDMUIsSUFBSSxDQUFDaEQsS0FBSyxDQUFDTSxJQUFJLElBQUkwQyxLQUFLLENBQUMxQyxJQUFJO1VBQzdCLElBQUksQ0FBQ04sS0FBSyxDQUFDTyxTQUFTLEVBQUU7UUFDeEI7TUFDRjtNQUVBb0YsT0FBTyxDQUFDTSxHQUFHLENBQUMsVUFBVSxJQUFJLENBQUNqRyxLQUFLLENBQUNPLFNBQVMsMEJBQTBCLENBQUM7SUFDdkUsQ0FBQyxDQUFDLE9BQU9tRixLQUFLLEVBQUU7TUFDZEMsT0FBTyxDQUFDQyxJQUFJLENBQUMsaUNBQWlDLEVBQUVGLEtBQUssQ0FBQztNQUN0REwsWUFBWSxDQUFDVyxVQUFVLENBQUMsSUFBSSxDQUFDeEYsTUFBTSxDQUFDSSxjQUFjLENBQUM7SUFDckQ7RUFDRjs7RUFFQTtFQUNBLE1BQU1zRixNQUFNQSxDQUFDdkUsSUFBYyxFQUFpQjtJQUMxQyxNQUFNd0UsY0FBYyxHQUFHeEUsSUFBSSxDQUFDNkQsR0FBRyxDQUFDLE1BQU96RCxHQUFHLElBQUs7TUFDN0M7TUFDQTtNQUNBLE9BQU8sSUFBSSxDQUFDbEMsS0FBSyxDQUFDdUcsR0FBRyxDQUFDckUsR0FBRyxDQUFDO0lBQzVCLENBQUMsQ0FBQztJQUVGLE1BQU1zRSxPQUFPLENBQUNDLEdBQUcsQ0FBQ0gsY0FBYyxDQUFDO0VBQ25DO0FBQ0Y7O0FBRUE7QUFDTyxNQUFNSSxnQkFBZ0IsR0FBQUMsT0FBQSxDQUFBRCxnQkFBQSxHQUFHLElBQUkzRyxnQkFBZ0IsQ0FBQztFQUNuRGEsT0FBTyxFQUFFLEdBQUcsR0FBRyxJQUFJLEdBQUcsSUFBSTtFQUFFO0VBQzVCQyxVQUFVLEVBQUUsRUFBRSxHQUFHLEVBQUUsR0FBRyxJQUFJO0VBQUU7RUFDNUJDLGlCQUFpQixFQUFFLElBQUk7RUFDdkJDLGNBQWMsRUFBRSwyQkFBMkI7RUFDM0NDLGlCQUFpQixFQUFFLEtBQUs7RUFBRTtFQUMxQkMsVUFBVSxFQUFFO0FBQ2QsQ0FBQyxDQUFDOztBQUVGO0FBQ08sTUFBTTJGLFFBQVEsR0FBQUQsT0FBQSxDQUFBQyxRQUFBLEdBQUdGLGdCQUFnQjs7QUFFeEM7QUFDTyxNQUFNRyxXQUFXLEdBQUcsTUFBT0Msa0JBQTRCLElBQUs7RUFDakUsTUFBTUosZ0JBQWdCLENBQUNMLE1BQU0sQ0FBQ1Msa0JBQWtCLENBQUM7QUFDbkQsQ0FBQzs7QUFFRDtBQUFBSCxPQUFBLENBQUFFLFdBQUEsR0FBQUEsV0FBQTtBQUNPLE1BQU1FLGVBQWUsR0FBR0EsQ0FBQSxLQUFNO0VBQ25DLE1BQU01RyxLQUFLLEdBQUd1RyxnQkFBZ0IsQ0FBQ3JCLFFBQVEsQ0FBQyxDQUFDO0VBQ3pDLE1BQU0yQixPQUFPLEdBQUdOLGdCQUFnQixDQUFDcEIsVUFBVSxDQUFDLENBQUM7RUFFN0MsT0FBTztJQUNMLEdBQUduRixLQUFLO0lBQ1I2RyxPQUFPLEVBQUUsR0FBRyxDQUFDQSxPQUFPLEdBQUcsR0FBRyxFQUFFQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEdBQUc7SUFDekNDLGFBQWEsRUFBRSxHQUFHLENBQUMvRyxLQUFLLENBQUNNLElBQUksR0FBRyxJQUFJLEdBQUcsSUFBSSxFQUFFd0csT0FBTyxDQUFDLENBQUMsQ0FBQyxJQUFJO0lBQzNERSxVQUFVLEVBQUVILE9BQU8sR0FBRyxHQUFHLEdBQUcsV0FBVyxHQUFHQSxPQUFPLEdBQUcsR0FBRyxHQUFHLE1BQU0sR0FBRztFQUNyRSxDQUFDO0FBQ0gsQ0FBQztBQUFDTCxPQUFBLENBQUFJLGVBQUEsR0FBQUEsZUFBQSIsImlnbm9yZUxpc3QiOltdfQ==